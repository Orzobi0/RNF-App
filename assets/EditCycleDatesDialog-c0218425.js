import{j as e,B as d,r}from"./index-b896ef43.js";import{u as M}from"./useCycleData-4dcbf14b.js";import{D,a as N,b as C,c as k,d as w,e as S}from"./dialog-2828cd6f.js";import{I as b}from"./input-2b285a94.js";const $=({isOpen:l,onCancel:t,onConfirm:c,conflictCycle:a})=>e.jsx(D,{open:l,onOpenChange:t,children:e.jsxs(N,{className:"bg-white border-pink-100 text-gray-800",children:[e.jsxs(C,{children:[e.jsx(k,{children:"Solapamiento detectado"}),e.jsx(w,{className:"text-gray-600",children:a?`La nueva fecha de inicio se solapa con el ciclo que comenzó el ${a.startDate} y terminó el ${a.endDate||"actualmente en curso"}. ¿Deseas ajustar las fechas y mover los registros al nuevo ciclo?`:"La nueva fecha de inicio se solapa con otro ciclo. ¿Deseas continuar?"})]}),e.jsxs(S,{className:"sm:justify-end",children:[e.jsx(d,{variant:"outline",onClick:t,className:"border-gray-300 text-gray-700 hover:bg-gray-100",children:"Cancelar"}),e.jsx(d,{variant:"destructive",onClick:c,className:"bg-pink-600 hover:bg-pink-700 text-white",children:"Confirmar"})]})]})}),R=({isOpen:l,onClose:t,onConfirm:c,initialStartDate:a,initialEndDate:g,includeEndDate:o=!0,title:F="Editar Fechas del Ciclo",description:O,cycleId:m,checkOverlap:u})=>{const[s,p]=r.useState(a||""),[n,y]=r.useState(g||""),[j,h]=r.useState(""),[E,L]=r.useState(null),[f,B]=r.useState(null),[P,x]=r.useState(!1);M(l,t),r.useEffect(()=>{p(a||""),y(g||"")},[a,g]);const I=async()=>{if(o&&!n){h("La fecha de fin es obligatoria");return}if(o&&s&&n&&n<s){h("La fecha de fin no puede ser anterior al inicio");return}const i=o?{startDate:s,endDate:n}:{startDate:s};if(u&&m&&s){const v=await u(m,s);if(v){L(v),B(i),x(!0);return}}c(i)};return e.jsxs(e.Fragment,{children:[e.jsx(D,{open:l,onOpenChange:t,children:e.jsxs(N,{className:"bg-white border-pink-100 text-gray-800",children:[e.jsxs(C,{children:[e.jsx(k,{children:F}),e.jsx(w,{className:"text-gray-600",children:O??(o?"Modifica la fecha de inicio y fin del ciclo.":"Modifica la fecha de inicio del ciclo.")})]}),e.jsxs("div",{className:"my-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"text-gray-700 text-sm",children:"Inicio del ciclo"}),e.jsx(b,{id:"startDate",type:"date",value:s,onChange:i=>p(i.target.value),className:"bg-gray-50 border-gray-200 text-gray-800"})]}),o&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"text-gray-700 text-sm",children:"Fin del ciclo"}),e.jsx(b,{id:"endDate",type:"date",value:n||"",onChange:i=>{y(i.target.value),h("")},className:"bg-gray-50 border-gray-200 text-gray-800"}),j&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:j})]})]}),e.jsxs(S,{className:"sm:justify-end",children:[e.jsx(d,{variant:"outline",onClick:t,className:"border-gray-300 text-gray-700 hover:bg-gray-100",children:"Cancelar"}),e.jsx(d,{variant:"primary",onClick:I,className:"bg-pink-600 hover:bg-pink-700 text-white",children:"Guardar"})]})]})}),e.jsx($,{isOpen:P,conflictCycle:E,onCancel:()=>x(!1),onConfirm:()=>{x(!1),f&&c({...f,force:!0})}})]})};export{R as E};
