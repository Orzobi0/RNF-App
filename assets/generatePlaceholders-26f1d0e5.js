import{c as ct,m as F,j as t,r as T}from"./index-1b0fe1a0.js";import{g as dt,i as ht}from"./DataEntryForm-8234e9d4.js";import{s as Q,p as lt,b as ft,f as ot,d as xt}from"./useCycleData-270ed225.js";import{C as pt}from"./ChartTooltip-2ac35f64.js";const Rt=ct("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),yt=({padding:e,chartWidth:r,chartHeight:p,tempMin:f,tempMax:M,tempRange:d,getY:h,getX:a,allDataPoints:b=[],responsiveFontSize:x,isFullScreen:B,showLeftLabels:w=!1,reduceMotion:l=!1})=>{const y={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},G=[];if(d>0){const u=d<=2.5?.1:.5;for(let E=f;E<=M+1e-9;E+=u)G.push(parseFloat(E.toFixed(1)))}else for(let u=35;u<=37.5+1e-9;u+=.5)G.push(parseFloat(u.toFixed(1)));const j=l?"g":F.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"bgGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(254, 242, 242, 0.95)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(255, 241, 242, 0.9)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(255, 245, 255, 0.95)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(254, 242, 242, 0.8)"})]}),t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("filter",{id:"chartGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("filter",{id:"textShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"rgba(255, 255, 255, 0.8)"})}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:[t.jsx("rect",{width:"6",height:"6",fill:"#f3f4f6"}),t.jsx("circle",{cx:"3",cy:"3",r:"1.5",fill:"rgba(239,68,68,0.7)"})]})]}),t.jsx("rect",{x:e.left,y:e.top,width:r-e.left-e.right,height:p-e.top-e.bottom,fill:"url(#bgGradientChart)",opacity:2,rx:12,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.1))"}}),G.map((u,E)=>{const C=h(u),L=u.toFixed(1).endsWith(".0")||u.toFixed(1).endsWith(".5"),_=L?u.toFixed(1):`.${u.toFixed(1).split(".")[1]}`;return t.jsxs(j,{...l?{}:{variants:y},children:[t.jsx("line",{x1:e.left,y1:C,x2:r-e.right,y2:C,stroke:L?"rgba(244, 114, 182, 0.3)":"rgba(244, 114, 182, 0.15)",strokeWidth:L?2:1,strokeDasharray:L?"0":"4,4",style:{filter:L?"drop-shadow(0 1px 3px rgba(244, 114, 182, 0.15))":"none",opacity:L?1:.7}}),w&&t.jsx("text",{x:e.left-x(1),y:C+x(.35),textAnchor:"end",fontSize:x(L?1.1:1),fontWeight:L?"700":"600",fill:L?"#E91E63":"#EC4899",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:_}),t.jsx("text",{x:r-e.right+x(1),y:C+x(.35),textAnchor:"start",fontSize:x(L?1.1:1),fontWeight:L?"700":"600",fill:L?"#E91E63":"#EC4899",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:_})]},`temp-tick-${E}`)}),b.map((u,E)=>{const C=a(E);return t.jsx("line",{x1:C,y1:e.top,x2:C,y2:p-e.bottom,stroke:"rgba(244, 114, 182, 0.08)",strokeWidth:2.8,style:{filter:"drop-shadow(0 0 1px rgba(244, 114, 182, 0.05))"}},`day-grid-${E}`)}),t.jsx("rect",{x:e.left,y:e.top,width:r-e.left-e.right,height:p-e.top-e.bottom,fill:"none",stroke:"rgba(244, 114, 182, 0.4)",strokeWidth:2,rx:12,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.15))",strokeDasharray:"0"}}),w&&t.jsx(j,{...l?{}:{variants:y},children:t.jsx("text",{x:e.left+x(1.2),y:e.top+x(1.5),textAnchor:"middle",fontSize:x(1.4),fontWeight:"800",fill:"#E91E63",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})})]})},ut=({data:e,allDataPoints:r,getX:p,getY:f,baselineY:M,temperatureField:d="temperature",reduceMotion:h=!1})=>{if(!e||e.length<2)return null;let a="",b=null;return r.forEach((x,B)=>{const w=e.find(l=>l.id===x.id);if(w&&w[d]!==null&&w[d]!==void 0&&!w.ignored){const l=p(B),y=f(w[d]);b!==null&&B===b+1?a+=` L ${l} ${y}`:a+=`${a?" ":""}M ${l} ${y}`,b=B}}),a.includes("L")?t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"30%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"70%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),t.jsxs("linearGradient",{id:"tempLineGradientChartGlow",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244, 114, 182, 0.6)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(236, 72, 153, 0.7)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(233, 30, 99, 0.8)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(194, 24, 91, 0.6)"})]}),t.jsxs("filter",{id:"lineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("filter",{id:"lineShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodColor:"rgba(244, 114, 182, 0.4)"})})]}),h?t.jsx("path",{d:a,fill:"none",stroke:"url(#tempLineGradientChartGlow)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:.4,style:{filter:"url(#lineGlow)"}}):t.jsx(F.path,{d:a,fill:"none",stroke:"url(#tempLineGradientChartGlow)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:.4,style:{filter:"url(#lineGlow)"},initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.4},transition:{duration:.8,ease:"easeInOut",delay:.2}}),h?t.jsx("path",{d:a,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#lineShadow)"}}):t.jsx(F.path,{d:a,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#lineShadow)"},initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:1,ease:"easeInOut",delay:.4}}),h?t.jsx("path",{d:a,fill:"none",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8}):t.jsx(F.path,{d:a,fill:"none",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8,initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.8},transition:{duration:1.2,ease:"easeInOut",delay:.6}})]}):null},st="#1565C0",rt="#2E7D32",nt="#6A1B9A",gt="#EFF6FF",mt="#EEF2FF",jt="#ECFDF5",wt="#F0FDFA",bt="#F5F3FF",Ct="#FAF5FF",Et=e=>{if(!e)return"";const[r,p]=e.split("/");return`${parseInt(r,10)}/${parseInt(p,10)}`},tt=(e="",r,p,f="–")=>{if(!e)return[f,""];if(e.length<=r)return[e,""];if(p)return[e.slice(0,r),""];const M=e.indexOf(" ",r);return M===-1?[e.slice(0,r),e.slice(r)]:[e.slice(0,M),e.slice(M+1)]},et=(e="",r,p="–")=>e?e.split(/\s+/).slice(0,r).join(" "):p,kt=({data:e,getX:r,getY:p,isFullScreen:f,orientation:M,responsiveFontSize:d,onPointInteraction:h,clearActivePoint:a,activePoint:b,padding:x,chartHeight:B,chartWidth:w,temperatureField:l="temperature_chart",textRowHeight:y,compact:G=!1,reduceMotion:j=!1})=>{const u={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},E={hidden:{opacity:0,scale:.3},visible:{opacity:1,scale:1,transition:{duration:.6,ease:[.34,1.56,.64,1],type:"spring",stiffness:120,damping:12}}},C=B-x.bottom,L=C+y*1,_=C+y*2,R=C+y*3,U=C+y*(f?5:4.5),N=C+y*(f?7:6),W=C+y*(f?9:7.5),X=w-x.left-x.right,P=y*(f?2:1.5),V=j?"g":F.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsx("filter",{id:"rowShadowChart",x:"-10%",y:"-10%",width:"120%",height:"120%",children:t.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"4",floodColor:"rgba(244, 114, 182, 0.2)"})}),t.jsxs("filter",{id:"pointGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("linearGradient",{id:"sensationGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:gt}),t.jsx("stop",{offset:"100%",stopColor:mt})]}),t.jsxs("linearGradient",{id:"appearanceGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:jt}),t.jsx("stop",{offset:"100%",stopColor:wt})]}),t.jsxs("linearGradient",{id:"observationGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:bt}),t.jsx("stop",{offset:"100%",stopColor:Ct})]}),t.jsxs("radialGradient",{id:"tempPointGradientChart",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#FCE7F3"}),t.jsx("stop",{offset:"40%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"80%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),t.jsxs("radialGradient",{id:"tempPointIgnoredGradient",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#FFFFFF"}),t.jsx("stop",{offset:"80%",stopColor:"#F8FAFC"}),t.jsx("stop",{offset:"100%",stopColor:"#E2E8F0"})]})]}),!G&&t.jsxs("g",{children:[t.jsx("rect",{x:x.left,y:U-P/2,width:X,height:P,fill:"url(#sensationGradientChart)",rx:4,style:{filter:"url(#rowShadowChart)"}}),t.jsx("rect",{x:x.left,y:N-P/2,width:X,height:P,fill:"url(#appearanceGradientChart)",rx:4,style:{filter:"url(#rowShadowChart)"}}),t.jsx("rect",{x:x.left,y:W-P/2,width:X,height:P,fill:"url(#observationGradientChart)",rx:4,style:{filter:"url(#rowShadowChart)"}})]}),f&&M!=="portrait"&&t.jsx(F.g,{variants:u,children:[{label:"Fecha",row:1,color:f?"#374151":"#6B7280"},{label:"Día",row:2,color:f?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:f?"#374151":"#6B7280"},{label:"Sens.",row:f?5:4.5,color:st},{label:"Apar.",row:f?7:6,color:rt},{label:"Observ.",row:f?9:7.5,color:nt}].map(({label:s,row:$,color:g})=>t.jsx("text",{x:x.left-d(.5),y:C+y*$,textAnchor:"end",fontSize:d(1.05),fontWeight:"700",fill:g,style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:s},s))}),e.map((s,$)=>{const g=r($),A=s[l]!=null?p(s[l]):C,D=f?"#374151":"#6B7280",I=s[l]!=null,q=I||s.mucus_sensation||s.mucus_appearance||s.fertility_symbol,z=String(s.id||"").startsWith("placeholder-"),J=!q||z?{}:{pointerEvents:"all",style:{cursor:"pointer"},onMouseEnter:O=>h(s,$,O),onClick:O=>h(s,$,O)},o=dt(s.fertility_symbol);let n="transparent";if(o!=null&&o.color){const O=o.color.replace(/^bg-/,"");O==="red-500"?n="#ef4444":O==="white"?n="#ffffff":O==="green-500"?n="#22c55e":O==="pink-300"&&(n="#f9a8d4")}const i=d(f?1.8:2),c=s.isoDate?ht(Q(lt(s.isoDate)),Q(new Date)):!1,m=f?4:9,k=2,[S,Y]=tt(f?et(s.mucus_sensation,k,c?"":"–"):s.mucus_sensation,m,!1,c?"":"–"),[v,H]=tt(f?et(s.mucus_appearance,k,c?"":"–"):s.mucus_appearance,m,!1,c?"":"–"),[K,Z]=tt(f?et(s.observations,k,""):s.observations,m,!1,"");return t.jsxs(V,{...j?{}:{variants:u},...J,children:[I&&t.jsxs(V,{...j?{}:{variants:E},children:[t.jsx("circle",{cx:g,cy:A,r:1.5,fill:"rgba(244, 114, 182, 0.2)",opacity:.8,style:{filter:"url(#pointGlow)"}}),t.jsx("circle",{cx:g,cy:A,r:3.5,fill:"none",stroke:s.ignored?"rgba(148, 163, 184, 0.4)":"rgba(244, 114, 182, 0.3)",strokeWidth:1.5,opacity:.6}),t.jsx("circle",{cx:g,cy:A,r:4,fill:s.ignored?"url(#tempPointIgnoredGradient)":"url(#tempPointGradientChart)",stroke:s.use_corrected?"#F59E0B":s.ignored?"#94A3B8":"#E91E63",strokeWidth:s.ignored?2:3,style:{filter:"drop-shadow(0 3px 6px rgba(244, 114, 182, 0.4))",cursor:"pointer"},pointerEvents:"all",onMouseEnter:O=>h(s,$,O),onTouchStart:O=>h(s,$,O),onClick:O=>h(s,$,O)}),!s.ignored&&t.jsx("circle",{cx:g,cy:A,r:1.5,fill:"rgba(255, 255, 255, 0.9)",style:{filter:"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.3))"}})]}),t.jsx("text",{x:g,y:L,textAnchor:"middle",fontSize:d(1.05),fontWeight:"900",fill:D,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:Et(s.date)}),t.jsx("text",{x:g,y:_,textAnchor:"middle",fontSize:d(1),fontWeight:"900",fill:D,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:s.cycleDay}),!z&&(o.value!=="none"?t.jsxs("g",{children:[t.jsx("rect",{x:g-i/2+1,y:R-i*.75+1,width:i,height:i,fill:"rgba(0, 0, 0, 0.1)",rx:i*.3,opacity:.5}),t.jsx("rect",{x:g-i/2-4,y:R-i*.75,width:i*1.4,height:i,fill:o.pattern==="spotting-pattern"?"url(#spotting-pattern-chart)":n,stroke:o.value==="white"?"#CBD5E1":"rgba(233, 30, 99, 0.4)",strokeWidth:o.value==="white"?2:1,rx:i*.2,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.25))"}})]}):t.jsx("text",{x:g,y:R,textAnchor:"middle",fontSize:d(1),fill:D,fontWeight:"500",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:"–"})),!G&&t.jsxs("text",{x:g,y:U,textAnchor:"middle",fontSize:d(.9),fontWeight:"700",fill:st,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:g,dy:0,children:S}),Y&&t.jsx("tspan",{x:g,dy:d(1.1),children:Y})]}),!G&&t.jsxs("text",{x:g,y:N,textAnchor:"middle",fontSize:d(.9),fontWeight:"700",fill:rt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:g,dy:0,children:v}),H&&t.jsx("tspan",{x:g,dy:d(1.1),children:H})]}),!G&&t.jsxs("text",{x:g,y:W,textAnchor:"middle",fontSize:d(.9),fontWeight:"700",fill:nt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:g,dy:0,children:K}),Z&&t.jsx("tspan",{x:g,dy:d(1.1),children:Z})]})]},`pt-${$}-${s.isoDate||s.timestamp}`)})]})},vt="#1565C0",Gt="#2E7D32",Lt="#6A1B9A",At=({padding:e,chartHeight:r,tempMin:p,tempMax:f,tempRange:M,getY:d,responsiveFontSize:h,textRowHeight:a,isFullScreen:b})=>{const x={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},B=[];if(M>0){const l=M<=2.5?.1:.5;for(let y=p;y<=f+1e-9;y+=l)B.push(parseFloat(y.toFixed(1)))}else for(let l=35;l<=37.5+1e-9;l+=.5)B.push(parseFloat(l.toFixed(1)));const w=r-e.bottom;return t.jsxs("svg",{width:e.left,height:r,className:"font-sans pointer-events-none",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"legendBgGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(255, 228, 230, 1)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(255, 229, 235, 1)  "}),t.jsx("stop",{offset:"70%",stopColor:"rgba(255, 241, 242, 1)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(255, 236, 240, 0.6)"})]}),t.jsxs("linearGradient",{id:"legendAccentGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsx("filter",{id:"legendShadowChart",x:"-20%",y:"-20%",width:"140%",height:"140%",children:t.jsx("feDropShadow",{dx:"0",dy:"3",stdDeviation:"4",floodColor:"rgba(244, 114, 182, 0.2)"})}),t.jsx("filter",{id:"textShadowLegend",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"rgba(255, 255, 255, 0.9)"})})]}),t.jsx("rect",{x:0,y:w+a*.5,width:e.left,height:a*(b?9.5:8),fill:"url(#legendBgGradientChart)",rx:12,style:{filter:"url(#legendShadowChart)"}}),B.map((l,y)=>{const G=d(l),j=l.toFixed(1).endsWith(".0")||l.toFixed(1).endsWith(".5"),u=j?l.toFixed(1):`.${l.toFixed(1).split(".")[1]}`;return t.jsx(F.g,{variants:x,children:t.jsx("text",{x:e.left-h(1.2),y:G+h(.35),textAnchor:"end",fontSize:h(j?1.15:1),fontWeight:j?"800":"700",fill:j?"#E91E63":"#EC4899",style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:u})},`temp-tick-fixed-${y}`)}),t.jsx(F.g,{variants:x,children:[{label:"Fecha",row:1,color:"#374151",icon:null},{label:"Día",row:2,color:"#374151",icon:null},{label:"Símbolo",row:3,color:"#374151",icon:null},{label:"Sens.",row:b?5:4.5,color:vt,icon:"◊"},{label:"Apar.",row:b?7:6,color:Gt,icon:"○"},{label:"Observ.",row:b?9:7.5,color:Lt,icon:"✦"}].map(({label:l,row:y,color:G,icon:j})=>t.jsxs("g",{children:[j&&t.jsx("text",{x:e.left-h(2.8),y:w+a*y,textAnchor:"middle",fontSize:h(.8),fontWeight:"600",fill:G,opacity:.7,style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:j}),t.jsx("text",{x:e.left-h(.8),y:w+a*y,textAnchor:"end",fontSize:h(1.05),fontWeight:"800",fill:G,style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:l})]},l))})]})},it=35.5,at=37.5,Mt=(e,r,p,f,M,d=5,h=!1)=>{const a=T.useRef(null),b=T.useRef(null),[x,B]=T.useState({width:0,height:0}),[w,l]=T.useState(null),[y,G]=T.useState({x:0,y:0}),j=T.useMemo(()=>e.map(o=>({...o,displayTemperature:o.temperature_chart})),[e]);T.useLayoutEffect(()=>{const o=()=>{if(!a.current)return;const i=a.current.parentElement||a.current;let c=i.clientWidth||600,m=i.clientHeight||400,k=a.current.clientWidth>0?a.current.clientWidth:c,S,Y;if(r){let v=window.innerWidth,H=window.innerHeight;if(h&&H>v&&([v,H]=[H,v]),k=v,p==="portrait"&&!h){const K=Math.max(30,v*.05);S=(v-K)/d*e.length}else S=v/d*e.length;Y=H}else S=k/d*e.length,Y=m;B({width:S,height:Y})};o(),window.addEventListener("resize",o);let n;if(a.current){const i=a.current.parentElement||a.current;n=new ResizeObserver(o),n.observe(i)}return()=>{window.removeEventListener("resize",o),n&&n.disconnect()}},[r,e.length,d,p,h]);const u=T.useMemo(()=>j.filter(o=>o&&o.isoDate&&!o.ignored&&o.displayTemperature!==null&&o.displayTemperature!==void 0),[j]),E=T.useMemo(()=>j.filter(o=>o&&o.isoDate),[j]),{baselineTemp:C,baselineStartIndex:L}=T.useMemo(()=>{const o=n=>n&&n.displayTemperature!=null&&!n.ignored;for(let n=0;n<j.length;n++){const i=j[n];if(!o(i))continue;const c=[];for(let m=n-1;m>=0&&c.length<6;m--){const k=j[m];o(k)&&c.unshift({index:m,temp:k.displayTemperature})}if(!(c.length<6)&&c.every(m=>m.temp<i.displayTemperature)){const m=Math.max(...c.map(S=>S.temp)),k=c.find(S=>S.temp===m).index;return{baselineTemp:m,baselineStartIndex:k}}}return{baselineTemp:null,baselineStartIndex:null}},[j]),{tempMin:_,tempMax:R}=T.useMemo(()=>{const o=u.map(c=>c.displayTemperature).filter(c=>c!=null);if(o.length===0)return{tempMin:it,tempMax:at};let n=Math.min(...o,it),i=Math.max(...o,at);if(n=Math.floor(n*2)/2,i=Math.ceil(i*2)/2,i-n<2){const c=(n+i)/2;n=c-1,i=c+1}return{tempMin:n,tempMax:i}},[u]),U=R-_,N=x.width,W=x.height,X=9,P=(o=1)=>{if(!r)return X*o;const n=Math.min(N,W);return Math.max(8,Math.min(X*o,n/(E.length>0?40/o:40)))},V=P(r?1.6:2.5),s=h||p==="landscape",g=V*(s?9:5),A={top:r?Math.max(s?6:12,W*(s?.015:.03)):12,right:r?Math.max(s?35:30,N*(s?.02:.05)):50,bottom:(r?Math.max(s?0:40,W*(s?0:.11)):60)+g+25,left:r?Math.max(s?45:20,N*(s?.02:.05)):50},D=o=>{if(o==null||U===0)return W-A.bottom;const n=W-A.top-A.bottom;return n<=0?W-A.bottom:W-A.bottom-(o-_)/U*n},I=o=>{const n=r&&!(h||p==="landscape")?5:10,i=r&&!(h||p==="landscape")?25:0,c=N-A.left-A.right-n-i*(E.length-1);if(c<=0)return A.left+n+i*o;const m=E.length>1?E.length-1:1;return m===0||E.length===0?A.left+n+i*o:A.left+n+o*(c/(E.length===1?1:m))+i*o},q=(o,n,i)=>{if(!o||String(o.id).startsWith("placeholder-")){z();return}const c=a.current.getBoundingClientRect();let m,k;if(i.type.startsWith("touch")){const v=i.changedTouches[0];m=v.clientX,k=v.clientY}else m=i.clientX,k=i.clientY;const S=I(n),Y=D(o.displayTemperature);G({svgX:S,svgY:Y,clientX:m-c.left+a.current.scrollLeft,clientY:k-c.top+a.current.scrollTop}),l(o)};T.useEffect(()=>{const o=n=>{var i;if(b.current&&!b.current.contains(n.target)){const c=(i=a.current)==null?void 0:i.querySelectorAll("circle, text, rect");let m=!1;if(c){for(let k of c)if(k.contains(n.target)){m=!0;break}}m||l(null)}};return w&&(document.addEventListener("mousedown",o),document.addEventListener("touchstart",o)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("touchstart",o)}},[w]);const z=()=>{l(null)};return{chartRef:a,tooltipRef:b,dimensions:x,activePoint:w,tooltipPosition:y,processedData:j,validDataForLine:u,allDataPoints:E,tempMin:_,tempMax:R,tempRange:U,padding:A,textRowHeight:V,setActivePoint:l,getY:D,getX:I,handlePointInteraction:q,clearActivePoint:z,handleToggleIgnore:o=>{f&&o&&(f(M,o),l(null))},responsiveFontSize:P,baselineTemp:C,baselineStartIndex:L}},St=({data:e,isFullScreen:r,orientation:p,onToggleIgnore:f,onEdit:M,cycleId:d,initialScrollIndex:h=0,visibleDays:a=5,showInterpretation:b=!1,reduceMotion:x=!1,forceLandscape:B=!1})=>{const{chartRef:w,tooltipRef:l,dimensions:y,activePoint:G,tooltipPosition:j,allDataPoints:u,validDataForLine:E,tempMin:C,tempMax:L,tempRange:_,padding:R,textRowHeight:U,getY:N,getX:W,handlePointInteraction:X,handleToggleIgnore:P,responsiveFontSize:V,clearActivePoint:s,setActivePoint:$,baselineTemp:g,baselineStartIndex:A}=Mt(e,r,p,f,d,a,B);if(!u||u.length===0)return t.jsxs("div",{className:"text-center p-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-pink-100 to-rose-100 rounded-full mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("p",{className:"text-slate-400 font-medium",children:"No hay datos para mostrar en el gráfico"})]});const D=y.width,I=y.height,q=g!=null?N(g):null,z=g!=null?W(A):null,J=D===0,[o,n]=T.useState({w:typeof window<"u"?window.innerWidth:0,h:typeof window<"u"?window.innerHeight:0}),i=o.w<o.h;T.useEffect(()=>{const v=()=>n({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",v),window.addEventListener("orientationchange",v),()=>{window.removeEventListener("resize",v),window.removeEventListener("orientationchange",v)}},[]),T.useEffect(()=>{if(!w.current)return;const v=w.current.clientWidth/a;w.current.scrollLeft=Math.max(0,v*h)},[h,a,y.width,p]);const c=B&&i,m=c,k="w-full h-full bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100",S=r?`${k} min-h-full ${m?"flex items-stretch justify-start overflow-y-auto overflow-x-hidden":"flex items-center justify-start overflow-x-auto overflow-y-hidden"}`:`${k} overflow-x-auto overflow-y-hidden border border-pink-100/50`,Y=!r||p==="portrait";return t.jsxs(F.div,{className:"relative w-full h-full",initial:!1,children:[Y&&t.jsx("div",{className:"absolute left-0 top-0 h-full bg-transparent pointer-events-none z-10",style:{width:R.left},children:t.jsx(At,{padding:R,chartHeight:I,tempMin:C,tempMax:L,tempRange:_,getY:N,responsiveFontSize:V,textRowHeight:U,isFullScreen:r})}),t.jsxs(F.div,{ref:w,className:`relative p-0 ${r?"":"rounded-2xl"} ${S}`,style:{boxShadow:r?"inset 0 1px 3px rgba(244, 114, 182, 0.1)":"0 8px 32px rgba(244, 114, 182, 0.12), 0 2px 8px rgba(244, 114, 182, 0.08)",...c?{position:"absolute",top:0,left:0,width:`${o.h}px`,height:`${o.w}px`,transform:"rotate(90deg) translateY(-100%)",transformOrigin:"top left"}:{}},initial:!1,children:[J&&t.jsx("div",{className:"flex items-center justify-center w-full h-full text-slate-400",children:"Cargando..."}),t.jsxs(F.svg,{width:D,height:I,className:"font-sans flex-shrink-0",viewBox:`0 0 ${D} ${I}`,preserveAspectRatio:"xMidYMid meet",initial:!1,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("linearGradient",{id:"tempAreaGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244,114,182,0.25)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(236,72,153,0.15)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(233,30,99,0.05)"})]}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:[t.jsx("rect",{width:"6",height:"6",fill:"#f3f4f6"}),t.jsx("circle",{cx:"3",cy:"3",r:"1.5",fill:"rgba(239,68,68,0.7)"})]}),t.jsxs("filter",{id:"chartShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("filter",{id:"baselineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1.5",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx("rect",{width:"100%",height:"100%",fill:"transparent"}),t.jsx(yt,{padding:R,chartWidth:D,chartHeight:I,tempMin:C,tempMax:L,tempRange:_,getY:N,getX:W,allDataPoints:u,responsiveFontSize:V,isFullScreen:r,showLeftLabels:!Y,reduceMotion:x}),t.jsx(ut,{data:E,allDataPoints:u,getX:W,getY:N,baselineY:I-R.bottom,temperatureField:"displayTemperature",reduceMotion:x}),b&&g!=null&&(x?t.jsx("line",{x1:z,y1:q,x2:D-R.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"}}):t.jsx(F.line,{x1:z,y1:q,x2:D-R.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"},initial:{opacity:0,pathLength:0},animate:{opacity:1,pathLength:1},transition:{duration:1,ease:"easeInOut"}})),t.jsx(kt,{data:u,getX:W,getY:N,isFullScreen:r,orientation:p,responsiveFontSize:V,onPointInteraction:X,clearActivePoint:s,activePoint:G,padding:R,chartHeight:I,chartWidth:D,temperatureField:"displayTemperature",textRowHeight:U,compact:!1,reduceMotion:x})]}),G&&t.jsx(F.div,{ref:l,initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},transition:{duration:.2,ease:"easeOut"},children:t.jsx(pt,{point:G,position:j,chartWidth:D,chartHeight:I,onToggleIgnore:P,onEdit:M,onClose:s})})]})]})};function Ot(e,r){if(!e||!r)return[];const p=typeof e=="string"?lt(e):e;return[...Array(r)].map((f,M)=>{const d=ft(p,M),h=ot(d,"yyyy-MM-dd"),a=ot(d,"dd/MM"),b=xt(Q(d),Q(p))+1;return{date:a,isoDate:h,cycleDay:b,temperature:null,mucusSensation:null,mucusAppearance:null,id:`placeholder-${h}`,ignored:!1}})}export{St as F,Rt as R,Ot as g};
