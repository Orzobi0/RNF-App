import{b as v,r as c,j as e}from"./index-5c8ff718.js";import{R as E,D as N}from"./DeletionDialog-7310b015.js";import{P as S,D as C}from"./DataEntryForm-1b130c4f.js";import{u as R,f as b,p as P}from"./useCycleData-d25ac977.js";import{B as k}from"./button-cd48e5a1.js";import{D as B,a as O}from"./dialog-995f36a3.js";import{u as F}from"./useBackClose-d5b49bbd.js";import"./fertilitySymbols-5c7dd69c.js";import"./select-a5d88587.js";import"./pen-line-81c7c7fb.js";import"./trash-2-74686a24.js";import"./input-1d10c911.js";import"./label-607c7139.js";const V=()=>{const{currentCycle:a,addOrUpdateDataPoint:f,deleteRecord:x,isLoading:h}=R(),{toast:m}=v(),[u,s]=c.useState(!1),[i,r]=c.useState(null),[o,d]=c.useState(null),[n,l]=c.useState(!1);F(u||!!i,()=>{s(!1),r(null)});const g=t=>{r(t),s(!0)},D=t=>{const p=a.data.find(j=>j.id===t);d(p)},y=async t=>{l(!0);try{await f(t,i),s(!1),r(null)}catch{m({title:"Error",description:"No se pudo guardar el registro",variant:"destructive"})}finally{l(!1)}},w=async()=>{if(o){l(!0);try{await x(o.id),d(null)}catch{m({title:"Error",description:"No se pudo eliminar el registro",variant:"destructive"})}finally{l(!1)}}};return h?e.jsx("p",{className:"text-center text-gray-500",children:"Cargando..."}):a!=null&&a.id?e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx("div",{className:"my-4",children:e.jsxs(k,{onClick:()=>{r(null),s(!0)},className:"w-full sm:w-auto bg-gradient-to-r from-pink-500 to-fuchsia-600 hover:from-pink-600 hover:to-fuchsia-700 text-white",disabled:n,children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," AÃ±adir registro"]})}),e.jsx(E,{records:a.data,onEdit:g,onDelete:D,isProcessing:n}),e.jsx(B,{open:u,onOpenChange:t=>{s(t),t||r(null)},children:e.jsx(O,{hideClose:!0,className:"bg-white border-pink-100 text-gray-800 w-[90vw] sm:w-auto max-w-md sm:max-w-lg md:max-w-xl max-h-[85vh] overflow-y-auto p-4 sm:p-6 rounded-2xl",children:e.jsx(C,{onSubmit:y,onCancel:()=>{s(!1),r(null)},initialData:i,cycleStartDate:a.startDate,cycleEndDate:a.endDate,isProcessing:n,isEditing:!!i})})}),e.jsx(N,{isOpen:!!o,onClose:()=>d(null),onConfirm:w,recordDate:o?b(P(o.isoDate),"dd/MM/yyyy"):"",isProcessing:n})]}):e.jsx("p",{className:"text-center text-gray-500",children:"No hay ciclo activo."})};export{V as default};
