import{c as he,m as B,j as e,B as ee,r as R}from"./index-71f9831f.js";import{g as xe,i as fe,X as me,T as ge,D as pe}from"./fertilitySymbols-d4cb4f69.js";import{s as z,p as oe,f as re,e as ue,a as ye,d as be}from"./useCycleData-a0f29ea7.js";import{P as je}from"./pen-line-e19a7d86.js";import{E as we}from"./eye-e05aaaa7.js";import{E as ve}from"./eye-off-0d1eb0d4.js";const ae=he("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Se=he("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),ke=({padding:t,chartWidth:r,chartHeight:g,tempMin:f,tempMax:M,tempRange:d,getY:i,getX:c,allDataPoints:j=[],responsiveFontSize:l,isFullScreen:W,showLeftLabels:w=!0,reduceMotion:a=!1})=>{const x={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},k=[];if(d>0){const p=d<=2.5?.1:.5;for(let N=f;N<=M+1e-9;N+=p)k.push(parseFloat(N.toFixed(1)))}else for(let p=35;p<=37.5+1e-9;p+=.5)k.push(parseFloat(p.toFixed(1)));const u=a?"g":B.g;return e.jsxs(e.Fragment,{children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"bgGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(252, 231, 243, 0.3)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(255, 255, 255, 0.8)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(252, 231, 243, 0.2)"})]}),e.jsxs("filter",{id:"softGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"1",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("rect",{x:t.left,y:t.top,width:r-t.left-t.right,height:g-t.top-t.bottom,fill:"url(#bgGradient)",opacity:.4}),k.map((p,N)=>{const y=i(p),E=p.toFixed(1).endsWith(".0")||p.toFixed(1).endsWith(".5"),Y=E?p.toFixed(1):`.${p.toFixed(1).split(".")[1]}`;return e.jsxs(u,{...a?{}:{variants:x},children:[e.jsx("line",{x1:t.left,y1:y,x2:r-t.right,y2:y,stroke:E?"rgba(244, 114, 182, 0.25)":"rgba(244, 114, 182, 0.15)",strokeWidth:E?1.5:1,strokeDasharray:E?"0":"3,3",style:{filter:E?"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.1))":"none"}}),w&&e.jsx("text",{x:t.left-l(1),y:y+l(.35),textAnchor:"end",fontSize:l(E?1:.9),fontWeight:E?"600":"500",fill:E?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Y}),e.jsx("text",{x:r-t.right+l(1),y:y+l(.35),textAnchor:"start",fontSize:l(E?1:.9),fontWeight:E?"600":"500",fill:E?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Y})]},`temp-tick-${N}`)}),j.map((p,N)=>{const y=c(N);return e.jsx("line",{x1:y,y1:t.top,x2:y,y2:g-t.bottom,stroke:"rgba(244, 114, 182, 0.12)",strokeWidth:.8,style:{filter:"drop-shadow(0 0 1px rgba(244, 114, 182, 0.1))"}},`day-grid-${N}`)}),w&&e.jsxs(u,{...a?{}:{variants:x},children:[e.jsx("rect",{x:t.left-l(.2),y:t.top-l(.2),width:l(2.8),height:l(2),rx:l(.3),fill:"rgba(244, 114, 182, 0.1)",stroke:"rgba(244, 114, 182, 0.2)",strokeWidth:.5}),e.jsx("text",{x:t.left+l(1.2),y:t.top+l(1.1),textAnchor:"middle",fontSize:l(1.3),fontWeight:"700",fill:"#E91E63",style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),e.jsx("rect",{x:t.left,y:t.top,width:r-t.left-t.right,height:g-t.top-t.bottom,fill:"none",stroke:"rgba(244, 114, 182, 0.2)",strokeWidth:1.5,rx:8,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.1))"}})]})},Ne=({data:t,allDataPoints:r,getX:g,getY:f,baselineY:M,temperatureField:d="temperature",reduceMotion:i=!1})=>{if(!t||t.length<2)return null;let c="",j=null;return r.forEach((l,W)=>{const w=t.find(a=>a.id===l.id);if(w&&w[d]!==null&&w[d]!==void 0&&!w.ignored){const a=g(W),x=f(w[d]);j!==null&&W===j+1?c+=` L ${a} ${x}`:c+=`${c?" ":""}M ${a} ${x}`,j=W}}),c.includes("L")?e.jsx(e.Fragment,{children:i?e.jsx("path",{d:c,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}):e.jsx(B.path,{d:c,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:.2,ease:"easeInOut"}})}):null},ie="#1E40AF",le="#059669",ne="#BE185D",Ee="rgba(30, 64, 175, 0.08)",Ce="rgba(5, 150, 105, 0.08)",Me="rgba(190, 24, 93, 0.08)",We=t=>{if(!t)return"";const[r,g]=t.split("/");return`${parseInt(r,10)}/${parseInt(g,10)}`},te=(t="",r,g,f="–")=>{if(!t)return[f,""];if(t.length<=r)return[t,""];if(g)return[t.slice(0,r),""];const M=t.indexOf(" ",r);return M===-1?[t.slice(0,r),t.slice(r)]:[t.slice(0,M),t.slice(M+1)]},se=(t="",r,g="–")=>t?t.split(/\s+/).slice(0,r).join(" "):g,Be=({data:t,getX:r,getY:g,isFullScreen:f,orientation:M,responsiveFontSize:d,onPointInteraction:i,clearActivePoint:c,activePoint:j,padding:l,chartHeight:W,chartWidth:w,temperatureField:a="temperature_chart",textRowHeight:x,compact:k=!1,reduceMotion:u=!1})=>{const p={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},N={hidden:{opacity:0,scale:.5},visible:{opacity:1,scale:1,transition:{duration:.5,ease:"easeOut",type:"spring",stiffness:100}}},y=W-l.bottom,E=y+x*1,Y=y+x*2,$=y+x*3,V=y+x*(f?5:4.5),I=y+x*(f?7:6),T=y+x*(f?9:7.5),H=w-l.left-l.right,S=x*(f?2:1.5),X=u?"g":B.g;return e.jsxs(e.Fragment,{children:[e.jsxs("defs",{children:[e.jsx("filter",{id:"rowShadow",x:"-10%",y:"-10%",width:"120%",height:"120%",children:e.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodColor:"rgba(244, 114, 182, 0.15)"})}),e.jsxs("linearGradient",{id:"sensationGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:Ee}),e.jsx("stop",{offset:"100%",stopColor:"rgba(30, 64, 175, 0.02)"})]}),e.jsxs("linearGradient",{id:"appearanceGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:Ce}),e.jsx("stop",{offset:"100%",stopColor:"rgba(5, 150, 105, 0.02)"})]}),e.jsxs("linearGradient",{id:"observationGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:Me}),e.jsx("stop",{offset:"100%",stopColor:"rgba(190, 24, 93, 0.02)"})]})]}),!k&&e.jsxs("g",{children:[e.jsx("rect",{x:l.left,y:V-S/2,width:H,height:S,fill:"url(#sensationGradient)",rx:6,style:{filter:"url(#rowShadow)"}}),e.jsx("rect",{x:l.left,y:I-S/2,width:H,height:S,fill:"url(#appearanceGradient)",rx:6,style:{filter:"url(#rowShadow)"}}),e.jsx("rect",{x:l.left,y:T-S/2,width:H,height:S,fill:"url(#observationGradient)",rx:6,style:{filter:"url(#rowShadow)"}})]}),(!f||M!=="portrait")&&e.jsx(B.g,{variants:p,children:[{label:"Fecha",row:1,color:f?"#374151":"#6B7280"},{label:"Día",row:2,color:f?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:f?"#374151":"#6B7280"},{label:"Sens.",row:f?5:4.5,color:ie},{label:"Apar.",row:f?7:6,color:le},{label:"Observ.",row:f?9:7.5,color:ne}].map(({label:o,row:U,color:v})=>e.jsx("text",{x:l.left-d(1.5),y:y+x*U,textAnchor:"end",fontSize:d(.95),fontWeight:"600",fill:v,style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o},o))}),t.map((o,U)=>{const v=r(U),A=o[a]!=null?g(o[a]):y,L=f?"#374151":"#6B7280",P=o[a]!=null,q=P||o.mucus_sensation||o.mucus_appearance||o.fertility_symbol,J=String(o.id||"").startsWith("placeholder-"),Q=!q||J?{}:{pointerEvents:"all",style:{cursor:"pointer"},onMouseEnter:G=>i(o,U,G),onClick:G=>i(o,U,G)},s=xe(o.fertility_symbol);let n="transparent";if(s!=null&&s.color){const G=s.color.replace(/^bg-/,"");G==="red-500"?n="#ef4444":G==="white"?n="#ffffff":G==="green-500"?n="#22c55e":G==="pink-300"&&(n="#f9a8d4")}const h=d(f?1.4:1.6),m=o.isoDate?fe(z(oe(o.isoDate)),z(new Date)):!1,b=f?4:9,C=2,[O,D]=te(f?se(o.mucus_sensation,C,m?"":"–"):o.mucus_sensation,b,!1,m?"":"–"),[_,K]=te(f?se(o.mucus_appearance,C,m?"":"–"):o.mucus_appearance,b,!1,m?"":"–"),[Z,F]=te(f?se(o.observations,C,""):o.observations,b,!1,"");return e.jsxs(X,{...u?{}:{variants:p},...Q,children:[P&&e.jsxs(X,{...u?{}:{variants:N},children:[e.jsx("circle",{cx:v,cy:A,r:8,fill:"rgba(244, 114, 182, 0.15)",opacity:.6}),e.jsx("circle",{cx:v,cy:A,r:5,fill:o.ignored?"white":"url(#tempPointGradient)",stroke:o.use_corrected?"#F59E0B":"#E91E63",strokeWidth:o.ignored?2:2.5,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.3))",cursor:"pointer"},pointerEvents:"all",onMouseEnter:G=>i(o,U,G),onTouchStart:G=>i(o,U,G),onClick:G=>i(o,U,G)}),!o.ignored&&e.jsx("circle",{cx:v,cy:A,r:2,fill:"rgba(255, 255, 255, 0.8)"})]}),e.jsx("defs",{children:e.jsxs("radialGradient",{id:"tempPointGradient",cx:"30%",cy:"30%",children:[e.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),e.jsx("stop",{offset:"70%",stopColor:"#E91E63"}),e.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]})}),e.jsx("text",{x:v,y:E,textAnchor:"middle",fontSize:d(.95),fontWeight:"600",fill:L,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:We(o.date)}),e.jsx("text",{x:v,y:Y,textAnchor:"middle",fontSize:d(.9),fontWeight:"500",fill:L,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.cycleDay}),!J&&(s.value!=="none"?e.jsx("rect",{x:v-h/2,y:$-h*.75,width:h,height:h,fill:s.pattern==="spotting-pattern"?"url(#spotting-pattern-chart)":n,stroke:s.value==="white"?"#b4c0cf":"rgba(233, 30, 99, 0.3)",strokeWidth:(s.value==="white",1),rx:h*.25,style:{filter:"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.2))"}}):e.jsx("text",{x:v,y:$,textAnchor:"middle",fontSize:d(.9),fill:L,fontWeight:"400",children:"–"})),!k&&e.jsxs("text",{x:v,y:V,textAnchor:"middle",fontSize:d(.85),fontWeight:"600",fill:ie,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[e.jsx("tspan",{x:v,dy:0,children:O}),D&&e.jsx("tspan",{x:v,dy:d(1),children:D})]}),!k&&e.jsxs("text",{x:v,y:I,textAnchor:"middle",fontSize:d(.85),fontWeight:"600",fill:le,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[e.jsx("tspan",{x:v,dy:0,children:_}),K&&e.jsx("tspan",{x:v,dy:d(1),children:K})]}),!k&&e.jsxs("text",{x:v,y:T,textAnchor:"middle",fontSize:d(.85),fontWeight:"600",fill:ne,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[e.jsx("tspan",{x:v,dy:0,children:Z}),F&&e.jsx("tspan",{x:v,dy:d(1),children:F})]})]},`pt-${U}-${o.isoDate||o.timestamp}`)})]})},Ae=({point:t,position:r,chartWidth:g,chartHeight:f,onToggleIgnore:M,onEdit:d,onClose:i})=>{if(!t)return null;const c=.6,j=200,l=120,W=j*c,w=l*c;let a=r.clientX+15,x=r.clientY+10;a+W>g&&(a=r.clientX-W-10),x+w>f&&(x=r.clientY-w-10),a<10&&(a=10),x<10&&(x=10);const k=t.temperature_chart,u=xe(t.fertility_symbol),p=t.timestamp||t.isoDate,y=(E=>{switch(E){case"red":return{bg:"bg-red-500",light:"bg-red-50",border:"border-red-200",text:"text-red-700",glow:"shadow-red-200/50"};case"white":return{bg:"bg-slate-100 border-2 border-slate-300",light:"bg-slate-50",border:"border-slate-200",text:"text-slate-700",glow:"shadow-slate-200/50"};case"green":return{bg:"bg-green-500",light:"bg-green-50",border:"border-green-200",text:"text-green-700",glow:"shadow-green-200/50"};case"spot":return{bg:"bg-pink-500",light:"bg-pink-50",border:"border-pink-200",text:"text-pink-700",glow:"shadow-pink-200/50"};default:return{bg:"bg-gray-400",light:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",glow:"shadow-gray-200/50"}}})(t.fertility_symbol);return e.jsxs(B.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},transition:{duration:.25,ease:[.16,1,.3,1]},className:"absolute z-50",style:{top:x,left:a,width:W},children:[e.jsx("div",{className:"origin-top-left",style:{transform:`scale(${c})`,width:j,minHeight:l},children:e.jsxs("div",{className:"relative bg-gradient-to-br from-white/95 to-white/85 backdrop-blur-xl rounded-2xl border border-white/60 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-pink-400 via-rose-400 to-pink-500"}),e.jsx(ee,{variant:"ghost",size:"icon",onClick:i,className:"absolute top-2 right-2 text-gray-400 hover:text-pink-600 hover:bg-pink-50/80 rounded-full w-6 h-6 transition-all duration-200",children:e.jsx(me,{size:20})}),e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-pink-500 to-rose-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(ae,{className:"w-2 h-2 text-white",fill:"currentColor"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:p?re(oe(p),"EEEE d",{locale:ue}):"Fecha"}),e.jsxs("p",{className:"text-sm text-pink-600 font-medium",children:["Día ",t.cycleDay||"N/A"," del ciclo"]})]})]})}),e.jsxs("div",{className:"space-y-1",children:[k!=null&&e.jsx(B.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-1 border border-blue-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(ge,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-md font-bold text-gray-800",children:parseFloat(k).toFixed(2)}),e.jsx("span",{className:"text-md text-gray-600",children:"°C"}),t.use_corrected&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full shadow-sm",title:"Temperatura corregida"})]})})]})}),u&&u.value!=="none"&&e.jsx(B.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.15},className:`${y.light} rounded-xl p-1 ${y.border} border`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-6 h-6 ${y.bg} rounded-lg flex items-center justify-center shadow-lg ${y.glow} shadow-lg`,children:e.jsx("div",{className:"w-2 h-2 bg-white/90 rounded-full shadow-sm"})}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:`text-md font-semibold ${y.text}`,children:u.label})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(B.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-1 border border-emerald-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(pe,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:t.mucus_sensation||"-"})})]})}),e.jsx(B.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.25},className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-1 border border-amber-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-amber-500 to-orange-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(ae,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:t.mucus_appearance||"-"})})]})})]}),t.id&&!String(t.id).startsWith("placeholder-")&&e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex justify-center gap-3 pt-1 border-t border-gray-100",children:[e.jsxs(ee,{onClick:()=>{d&&d(t),i&&i()},variant:"outline",size:"sm",className:"flex items-center gap-2 px-2 py-2 bg-white/80 hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 border-gray-200 hover:border-blue-300 text-gray-700 hover:text-blue-700 rounded-xl transition-all duration-200 shadow-sm hover:shadow-md",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Editar"})]}),e.jsx(ee,{onClick:()=>M(t.id),variant:"outline",size:"sm",className:`flex items-center gap-2 px-2 py-2 rounded-xl transition-all duration-200 shadow-sm hover:shadow-md ${t.ignored?"bg-green-50 hover:bg-green-100 border-green-200 hover:border-green-300 text-green-700":"bg-red-50 hover:bg-red-100 border-red-200 hover:border-red-300 text-red-700"}`,children:t.ignored?e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Mostrar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Ocultar"})]})})]})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-pink-200 to-transparent"})]})}),e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-br from-pink-200/20 to-rose-300/20 rounded-2xl blur-xl -z-10"})]})},Te="#1E40AF",Le="#059669",De="#BE185D",Re=({padding:t,chartHeight:r,tempMin:g,tempMax:f,tempRange:M,getY:d,responsiveFontSize:i,textRowHeight:c,isFullScreen:j})=>{const l={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},W=[];if(M>0){const a=M<=2.5?.1:.5;for(let x=g;x<=f+1e-9;x+=a)W.push(parseFloat(x.toFixed(1)))}else for(let a=35;a<=37.5+1e-9;a+=.5)W.push(parseFloat(a.toFixed(1)));const w=r-t.bottom;return e.jsxs("svg",{width:t.left,height:r,className:"font-sans pointer-events-none",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"legendBgGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(255, 255, 255, 0.95)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(252, 231, 243, 0.8)"})]}),e.jsx("filter",{id:"legendShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:e.jsx("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodColor:"rgba(244, 114, 182, 0.15)"})})]}),e.jsx("rect",{x:0,y:w+c*.5,width:t.left,height:c*(j?9.5:8),fill:"url(#legendBgGradient)",rx:8,style:{filter:"url(#legendShadow)"}}),W.map((a,x)=>{const k=d(a),u=a.toFixed(1).endsWith(".0")||a.toFixed(1).endsWith(".5"),p=u?a.toFixed(1):`.${a.toFixed(1).split(".")[1]}`;return e.jsx(B.text,{variants:l,x:t.left-i(1),y:k+i(.35),textAnchor:"end",fontSize:i(u?1:.9),fontWeight:u?"600":"500",fill:u?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:p},`temp-tick-fixed-${x}`)}),e.jsxs(B.g,{variants:l,children:[e.jsx("rect",{x:t.left-i(.3),y:t.top-i(.3),width:i(3),height:i(2.2),rx:i(.4),fill:"rgba(244, 114, 182, 0.12)",stroke:"rgba(244, 114, 182, 0.25)",strokeWidth:1,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.1))"}}),e.jsx("text",{x:t.left+i(1.2),y:t.top+i(1.2),textAnchor:"middle",fontSize:i(1.4),fontWeight:"700",fill:"#E91E63",style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),e.jsx(B.g,{variants:l,children:[{label:"Fecha",row:1,color:j?"#374151":"#6B7280"},{label:"Día",row:2,color:j?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:j?"#374151":"#6B7280"},{label:"Sens.",row:j?5:4.5,color:Te},{label:"Apar.",row:j?7:6,color:Le},{label:"Observ.",row:j?9:7.5,color:De}].map(({label:a,row:x,color:k})=>e.jsx("text",{x:t.left-i(1.5),y:w+c*x,textAnchor:"end",fontSize:i(.95),fontWeight:"600",fill:k,style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:a},a))})]})},ce=35.5,de=37.5,Oe=(t,r,g,f,M,d=5,i=!1)=>{const c=R.useRef(null),j=R.useRef(null),[l,W]=R.useState({width:0,height:0}),[w,a]=R.useState(null),[x,k]=R.useState({x:0,y:0}),u=R.useMemo(()=>t.map(s=>({...s,displayTemperature:s.temperature_chart})),[t]);R.useLayoutEffect(()=>{const s=()=>{if(!c.current)return;const h=c.current.parentElement||c.current;let m=h.clientWidth||600,b=h.clientHeight||400,C=c.current.clientWidth>0?c.current.clientWidth:m,O,D;if(r){let _=window.innerWidth,K=window.innerHeight;if(i&&K>_&&([_,K]=[K,_]),C=_,g==="portrait"&&!i){const Z=Math.max(30,_*.05);O=(_-Z)/d*t.length}else O=_/d*t.length;D=K}else O=C/d*t.length,D=b;W({width:O,height:D})};s(),window.addEventListener("resize",s);let n;if(c.current){const h=c.current.parentElement||c.current;n=new ResizeObserver(s),n.observe(h)}return()=>{window.removeEventListener("resize",s),n&&n.disconnect()}},[r,t.length,d,g,i]);const p=R.useMemo(()=>u.filter(s=>s&&s.isoDate&&!s.ignored&&s.displayTemperature!==null&&s.displayTemperature!==void 0),[u]),N=R.useMemo(()=>u.filter(s=>s&&s.isoDate),[u]),{baselineTemp:y,baselineStartIndex:E}=R.useMemo(()=>{const s=n=>n&&n.displayTemperature!=null&&!n.ignored;for(let n=0;n<u.length;n++){const h=u[n];if(!s(h))continue;const m=[];for(let b=n-1;b>=0&&m.length<6;b--){const C=u[b];s(C)&&m.unshift({index:b,temp:C.displayTemperature})}if(!(m.length<6)&&m.every(b=>b.temp<h.displayTemperature)){const b=Math.max(...m.map(O=>O.temp)),C=m.find(O=>O.temp===b).index;return{baselineTemp:b,baselineStartIndex:C}}}return{baselineTemp:null,baselineStartIndex:null}},[u]),{tempMin:Y,tempMax:$}=R.useMemo(()=>{const s=p.map(m=>m.displayTemperature).filter(m=>m!=null);if(s.length===0)return{tempMin:ce,tempMax:de};let n=Math.min(...s,ce),h=Math.max(...s,de);if(n=Math.floor(n*2)/2,h=Math.ceil(h*2)/2,h-n<2){const m=(n+h)/2;n=m-1,h=m+1}return{tempMin:n,tempMax:h}},[p]),V=$-Y,I=l.width,T=l.height,H=9,S=(s=1)=>{if(!r)return H*s;const n=Math.min(I,T);return Math.max(8,Math.min(H*s,n/(N.length>0?40/s:40)))},X=S(r?1.6:2.5),o=i||g==="landscape",v=X*(o?9:5),A={top:r?Math.max(o?6:12,T*(o?.015:.03)):12,right:r?Math.max(o?12:30,I*(o?.02:.05)):50,bottom:(r?Math.max(o?24:40,T*(o?.05:.11)):60)+v+25,left:r?Math.max(o?45:30,I*(o?.02:.05)):50},L=s=>{if(s==null||V===0)return T-A.bottom;const n=T-A.top-A.bottom;return n<=0?T-A.bottom:T-A.bottom-(s-Y)/V*n},P=s=>{const h=r&&!(i||g==="landscape")?25:0,m=I-A.left-A.right-10-h*(N.length-1);if(m<=0)return A.left+10+h*s;const b=N.length>1?N.length-1:1;return b===0||N.length===0?A.left+10+h*s:A.left+10+s*(m/(N.length===1?1:b))+h*s},q=(s,n,h)=>{if(!s||String(s.id).startsWith("placeholder-")){J();return}const m=c.current.getBoundingClientRect();let b,C;if(h.type.startsWith("touch")){const _=h.changedTouches[0];b=_.clientX,C=_.clientY}else b=h.clientX,C=h.clientY;const O=P(n),D=L(s.displayTemperature);k({svgX:O,svgY:D,clientX:b-m.left+c.current.scrollLeft,clientY:C-m.top+c.current.scrollTop}),a(s)};R.useEffect(()=>{const s=n=>{var h;if(j.current&&!j.current.contains(n.target)){const m=(h=c.current)==null?void 0:h.querySelectorAll("circle, text, rect");let b=!1;if(m){for(let C of m)if(C.contains(n.target)){b=!0;break}}b||a(null)}};return w&&(document.addEventListener("mousedown",s),document.addEventListener("touchstart",s)),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[w]);const J=()=>{a(null)};return{chartRef:c,tooltipRef:j,dimensions:l,activePoint:w,tooltipPosition:x,processedData:u,validDataForLine:p,allDataPoints:N,tempMin:Y,tempMax:$,tempRange:V,padding:A,textRowHeight:X,setActivePoint:a,getY:L,getX:P,handlePointInteraction:q,clearActivePoint:J,handleToggleIgnore:s=>{f&&s&&(f(M,s),a(null))},responsiveFontSize:S,baselineTemp:y,baselineStartIndex:E}},Ue=({data:t,isFullScreen:r,orientation:g,onToggleIgnore:f,onEdit:M,cycleId:d,initialScrollIndex:i=0,visibleDays:c=5,showInterpretation:j=!1,reduceMotion:l=!1,forceLandscape:W=!1})=>{const{chartRef:w,tooltipRef:a,dimensions:x,activePoint:k,tooltipPosition:u,allDataPoints:p,validDataForLine:N,tempMin:y,tempMax:E,tempRange:Y,padding:$,textRowHeight:V,getY:I,getX:T,handlePointInteraction:H,handleToggleIgnore:S,responsiveFontSize:X,clearActivePoint:o,setActivePoint:U,baselineTemp:v,baselineStartIndex:A}=Oe(t,r,g,f,d,c,W);if(!p||p.length===0)return e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-pink-100 to-rose-100 rounded-full mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-slate-400 font-medium",children:"No hay datos para mostrar en el gráfico"})]});const L=x.width,P=x.height,q=v!=null?I(v):null,J=v!=null?T(A):null,Q=L===0,[s,n]=R.useState({w:typeof window<"u"?window.innerWidth:0,h:typeof window<"u"?window.innerHeight:0}),h=s.w<s.h;R.useEffect(()=>{const D=()=>n({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",D),window.addEventListener("orientationchange",D),()=>{window.removeEventListener("resize",D),window.removeEventListener("orientationchange",D)}},[]),R.useEffect(()=>{if(!w.current)return;const D=w.current.clientWidth/c;w.current.scrollLeft=Math.max(0,D*i)},[i,c,x.width,g]);const m=W&&h,b=m,C="w-full h-full bg-gradient-to-br from-white via-pink-50/30 to-rose-50/20",O=r?`${C} min-h-full ${b?"flex items-stretch justify-start overflow-y-auto overflow-x-hidden":"flex items-center justify-start overflow-x-auto overflow-y-hidden"}`:`${C} overflow-x-auto overflow-y-hidden border border-pink-100/50`;return e.jsxs(B.div,{className:"relative w-full h-full",initial:!1,children:[(!r||g==="portrait")&&e.jsx("div",{className:"absolute left-0 top-0 h-full bg-transparent pointer-events-none z-10",style:{width:$.left},children:e.jsx(Re,{padding:$,chartHeight:P,tempMin:y,tempMax:E,tempRange:Y,getY:I,responsiveFontSize:X,textRowHeight:V,isFullScreen:r})}),e.jsxs(B.div,{ref:w,className:`relative p-0 ${r?"":"rounded-2xl"} ${O}`,style:{boxShadow:r?"inset 0 1px 3px rgba(244, 114, 182, 0.1)":"0 8px 32px rgba(244, 114, 182, 0.12), 0 2px 8px rgba(244, 114, 182, 0.08)",...m?{position:"absolute",top:0,left:0,width:`${s.h}px`,height:`${s.w}px`,transform:"rotate(90deg) translateY(-100%)",transformOrigin:"top left"}:{}},initial:!1,children:[Q&&e.jsx("div",{className:"flex items-center justify-center w-full h-full text-slate-400",children:"Cargando..."}),e.jsxs(B.svg,{width:L,height:P,className:"font-sans flex-shrink-0",viewBox:`0 0 ${L} ${P}`,preserveAspectRatio:"xMidYMid meet",initial:!1,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),e.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),e.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),e.jsxs("linearGradient",{id:"tempAreaGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(244,114,182,0.25)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(236,72,153,0.15)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(233,30,99,0.05)"})]}),e.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"8",height:"8",children:[e.jsx("circle",{cx:"2",cy:"2",r:"1.5",fill:"rgba(239,68,68,0.8)"}),e.jsx("circle",{cx:"6",cy:"6",r:"1.5",fill:"rgba(239,68,68,0.6)"})]}),e.jsxs("filter",{id:"chartShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),e.jsxs("filter",{id:"baselineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"1.5",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("rect",{width:"100%",height:"100%",fill:"transparent"}),e.jsx(ke,{padding:$,chartWidth:L,chartHeight:P,tempMin:y,tempMax:E,tempRange:Y,getY:I,getX:T,allDataPoints:p,responsiveFontSize:X,isFullScreen:r,showLeftLabels:r&&g==="landscape",reduceMotion:l}),e.jsx(Ne,{data:N,allDataPoints:p,getX:T,getY:I,baselineY:P-$.bottom,temperatureField:"displayTemperature",reduceMotion:l}),j&&v!=null&&(l?e.jsx("line",{x1:J,y1:q,x2:L-$.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"}}):e.jsx(B.line,{x1:J,y1:q,x2:L-$.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"},initial:{opacity:0,pathLength:0},animate:{opacity:1,pathLength:1},transition:{duration:1,ease:"easeInOut"}})),e.jsx(Be,{data:p,getX:T,getY:I,isFullScreen:r,orientation:g,responsiveFontSize:X,onPointInteraction:H,clearActivePoint:o,activePoint:k,padding:$,chartHeight:P,chartWidth:L,temperatureField:"displayTemperature",textRowHeight:V,compact:!1,reduceMotion:l})]}),k&&e.jsx(B.div,{ref:a,initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},transition:{duration:.2,ease:"easeOut"},children:e.jsx(Ae,{point:k,position:u,chartWidth:L,chartHeight:P,onToggleIgnore:S,onEdit:M,onClose:o})})]})]})};function Ve(t,r){if(!t||!r)return[];const g=typeof t=="string"?oe(t):t;return[...Array(r)].map((f,M)=>{const d=ye(g,M),i=re(d,"yyyy-MM-dd"),c=re(d,"dd/MM"),j=be(z(d),z(g))+1;return{date:c,isoDate:i,cycleDay:j,temperature:null,mucusSensation:null,mucusAppearance:null,id:`placeholder-${i}`,ignored:!1}})}export{Ue as F,Se as R,Ve as g};
