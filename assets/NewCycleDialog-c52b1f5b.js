import{c as f,j as e,B as x,r as H,g as m}from"./index-2f41c8cd.js";import{O}from"./OverlapWarningDialog-038e0dd4.js";import{u as z}from"./badge-4c7d2230.js";import{D as G,a as R,b as V,c as A,d as P,e as W}from"./useCycleData-9f76d19f.js";import{I as Y}from"./input-c95d25ec.js";const _=f("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ee=f("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Z=f("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),v=a=>{if(!a)return"";const t=new Date(a);if(Number.isNaN(t.getTime()))return a;const n=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getFullYear());return`${n}/${s}/${i}`},ae=({cycle:a,startDate:t,endDate:n,onStartDateChange:s,onEndDateChange:i,onSave:o,onCancel:r,isProcessing:c=!1,dateError:h="",includeEndDate:d=!0,showOverlapDialog:l=!1,overlapCycle:N=null,onConfirmOverlap:w,onCancelOverlap:D,title:M="Editar fechas del ciclo",description:k="Actualiza las fechas de inicio y fin del ciclo. Guarda los cambios cuando termines.",saveLabel:$="Guardar",cancelLabel:C="Cancelar",onClearError:p,className:F="mb-6 mx-auto w-full max-w-xl",onDeleteCycle:g,deleteTitle:L="Eliminar ciclo",deleteDescription:b="Esta acción no se puede deshacer. Se eliminarán todos los registros asociados.",deleteLabel:I="Eliminar ciclo",isDeletingCycle:T=!1})=>{const y=a!=null&&a.startDate?v(a.startDate):null,q=a!=null&&a.endDate?v(a.endDate):"En curso",j=y?`Fecha actual: ${y}${d?` — ${q}`:""}`:null,S=u=>{p&&p(),s==null||s(u.target.value)},B=u=>{p&&p(),i==null||i(u.target.value)},E=u=>{u.preventDefault(),o==null||o()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${F} rounded-3xl border border-rose-100 bg-white/90 p-5 shadow-md`,children:e.jsx("form",{onSubmit:E,className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-titulo mb-1",children:M}),e.jsx("p",{className:"text-sm text-slate-600",children:k}),j&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:j}),e.jsxs("div",{className:`grid ${d?"grid-cols-2 gap-4":"grid-cols-1 gap-4"}`,children:[e.jsxs("label",{className:"flex h-full flex-col text-sm text-slate-700",children:["Inicio del ciclo",e.jsx("input",{type:"date",value:t||"",onChange:S,className:"mt-1 w-full rounded-lg border border-fertiliapp-suave bg-white px-3 py-2 text-slate-800 focus:border-fertiliapp-suave focus:outline-none focus:ring-2 focus:ring-fertiliapp-suave"})]}),d&&e.jsxs("label",{className:"flex h-full flex-col text-sm text-slate-700",children:["Fin del ciclo",e.jsx("input",{type:"date",value:n||"",onChange:B,className:"mt-1 w-full rounded-lg border border-fertiliapp-suave bg-white px-3 py-2 text-slate-800 focus:border-fertiliapp-suave focus:outline-none focus:ring-2 focus:ring-fertiliapp-suave"})]})]}),h&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:h}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 justify-center",children:[e.jsx(x,{type:"button",variant:"outline",onClick:r,className:"border-fertiliapp-suave text-titulo hover:brightness-95",disabled:c,children:C}),e.jsx(x,{type:"submit",className:"bg-fertiliapp-fuerte text-white shadow hover:brightness-95",disabled:c,children:$})]}),g&&e.jsxs("div",{className:"mt-6 rounded-3xl bg-alerta-2-suave p-4 text-left",children:[e.jsx("h3",{className:"font-semibold text-slate-800 mb-2",children:L}),b&&e.jsx("p",{className:"text-sm text-slate-800 mb-3",children:b}),e.jsxs(x,{type:"button",onClick:g,disabled:c||T,className:"w-full sm:w-auto bg-alerta-2 hover:brightness-95 text-white shadow-md",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),I]})]})]})})}),e.jsx(O,{isOpen:l,conflictCycle:N,onCancel:D,onConfirm:w})]})},te=({isOpen:a,onClose:t,onConfirm:n,currentCycleStartDate:s})=>{const[i,o]=H.useState(m(new Date,"yyyy-MM-dd"));z(a,t);const r=!s,c=()=>{n(i)},h=r?"":m(new Date(s),"dd/MM/yyyy"),d=(()=>{if(r)return"";const l=new Date(i);return l.setDate(l.getDate()-1),m(l,"dd/MM/yyyy")})();return e.jsx(G,{open:a,onOpenChange:t,children:e.jsxs(R,{className:"bg-white border-pink-100 text-gray-800 rounded-3xl",children:[e.jsxs(V,{children:[e.jsx(A,{children:"Iniciar nuevo ciclo"}),e.jsx(P,{className:"text-gray-600",children:r?"Este será tu primer ciclo. Selecciona la fecha de inicio.":`¿Estás seguro de que quieres iniciar un nuevo ciclo? Los datos del ciclo actual (${h} - ${d}) serán archivados.`})]}),e.jsxs("div",{className:"my-4 space-y-2",children:[e.jsx("label",{htmlFor:"startDate",className:"text-gray-700 text-sm",children:"Fecha de inicio del nuevo ciclo"}),e.jsx(Y,{id:"startDate",type:"date",value:i,onChange:l=>o(l.target.value),max:m(new Date,"yyyy-MM-dd"),min:r?void 0:m(new Date(s),"yyyy-MM-dd"),className:"bg-gray-50 border-gray-200 text-gray-800"})]}),e.jsxs(W,{className:"sm:justify-end",children:[e.jsx(x,{variant:"outline",onClick:t,className:"border-gray-300 text-subtitulo hover:brightness-95",children:"Cancelar"}),e.jsx(x,{variant:"primary",onClick:c,className:"bg-fertiliapp-fuerte hover:brightness-95 text-white",children:r?"Iniciar ciclo":"Confirmar nuevo ciclo"})]})]})})};export{ae as C,_ as L,te as N,ee as P,Z as T};
