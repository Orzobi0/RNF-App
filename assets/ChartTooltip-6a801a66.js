import{r as u,j as e,m as r,B as p}from"./index-b896ef43.js";import{g as F,X as S,C as w,T as H,a as X,P as k}from"./DataEntryForm-99bdedea.js";import{f as D,e as T,p as M}from"./useCycleData-4dcbf14b.js";import{E as O}from"./eye-153cd699.js";import{E as R}from"./eye-off-b1122abf.js";const W=({point:t,position:s,chartWidth:o,chartHeight:n,onToggleIgnore:c,onEdit:m,onClose:x})=>{if(!t)return null;const g=.6,j=200,y=120,d=j*g,C=y*g,h=u.useRef(null),[b,E]=u.useState(C);u.useEffect(()=>{h.current&&E(h.current.offsetHeight)},[t]);const _=s.clientX>o*.66,z=s.clientY+b>n;let a=_?s.clientX-d-10:s.clientX+10,l=z?s.clientY:s.clientY+10;a+d>o&&(a=o-d-10),l+b>n&&(l=n-b-10),a<10&&(a=10),l<10&&(l=10);const v=t.temperature_chart,f=F(t.fertility_symbol),N=t.timestamp||t.isoDate,i=($=>{switch($){case"red":return{bg:"bg-red-500",light:"bg-red-50",border:"border-red-200",text:"text-red-700",glow:"shadow-red-200/50"};case"white":return{bg:"bg-slate-100 border-2 border-slate-300",light:"bg-slate-50",border:"border-slate-200",text:"text-slate-700",glow:"shadow-slate-200/50"};case"green":return{bg:"bg-green-500",light:"bg-green-50",border:"border-green-200",text:"text-green-700",glow:"shadow-green-200/50"};case"spot":return{bg:"bg-red-50 pattern-bg",light:"bg-red-50",border:"border-red-200",text:"text-red-700",glow:"shadow-red-200/50"};default:return{bg:"bg-gray-400",light:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",glow:"shadow-gray-200/50"}}})(t.fertility_symbol);return e.jsxs(r.div,{ref:h,initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},transition:{duration:.25,ease:[.16,1,.3,1]},className:"absolute z-50",style:{top:l,left:a,width:d},children:[e.jsx("div",{className:"origin-top-left",style:{transform:`scale(${g})`,width:j,minHeight:y},children:e.jsxs("div",{className:"relative bg-gradient-to-br from-white/98 to-rose-50/95 backdrop-blur-xl rounded-3xl border border-pink-100 shadow-2xl overflow-hidden",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:x,className:"absolute top-2 right-2 text-gray-400 hover:text-pink-600 hover:bg-pink-50/80 rounded-full w-6 h-6 transition-all duration-200",children:e.jsx(S,{size:20})}),e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-pink-500 to-rose-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(w,{className:"w-2 h-2 text-white",fill:"currentColor"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-center text-lg text-gray-800",children:N?D(M(N),"EEEE d",{locale:T}):"Fecha"}),e.jsxs("p",{className:"text-sm text-pink-600 font-medium",children:["Día ",t.cycleDay||"N/A"," del ciclo"]})]})]})}),e.jsxs("div",{className:"space-y-1",children:[v!=null&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-1 border border-amber-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-amber-500 to-orange-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(H,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-md font-bold text-gray-800",children:parseFloat(v).toFixed(2)}),e.jsx("span",{className:"text-md text-gray-600",children:"°C"}),t.use_corrected&&e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full shadow-[0_0_4px_rgba(245,158,11,0.65)]",title:"Temperatura corregida"})]})})]})}),f&&f.value!=="none"&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.15},className:`${i.light} rounded-xl p-1 ${i.border} border`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-6 h-6 ${i.bg} rounded-lg flex items-center justify-center shadow-lg ${i.glow} shadow-lg`,children:e.jsx("div",{className:"w-2 h-2 bg-white/90 rounded-full shadow-sm"})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("span",{className:`text-md font-semibold ${i.text}`,children:f.label})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-1 border border-blue-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(X,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("span",{className:"text-md font-semibold text-blue-800",children:t.mucus_sensation||"-"})})]})}),e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.25},className:"bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-1 border border-emerald-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(w,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("span",{className:"text-md font-semibold text-green-800",children:t.mucus_appearance||"-"})})]})}),t.observations&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-gradient-to-r from-violet-50 to-purple-50 rounded-xl p-1 border border-violet-100/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-violet-500 to-purple-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(k,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("span",{className:"text-sm font-semibold text-violet-800",children:t.observations})})]})})]}),t.id&&!String(t.id).startsWith("placeholder-")&&(m||c)&&e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex justify-center gap-3 pt-1 border-t border-gray-100",children:[m&&e.jsxs(p,{onClick:()=>{m(t),x&&x()},variant:"outline",size:"sm",className:"flex items-center gap-2 px-2 py-2 bg-white/80 hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 border-gray-200 hover:border-blue-300 text-gray-700 hover:text-blue-700 rounded-xl transition-all duration-200 shadow-sm hover:shadow-md",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Editar"})]}),c&&e.jsx(p,{onClick:()=>c(t.id),variant:"outline",size:"sm",className:`flex items-center gap-2 px-2 py-2 rounded-xl transition-all duration-200 shadow-sm hover:shadow-md ${t.ignored?"bg-green-50 hover:bg-green-100 border-green-200 hover:border-green-300 text-green-700":"bg-red-50 hover:bg-red-100 border-red-200 hover:border-red-300 text-red-700"}`,children:t.ignored?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Mostrar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Ocultar"})]})})]})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pink-200/60 to-transparent"}),e.jsx("div",{className:"absolute top-4 left-4 w-2 h-2 bg-gradient-to-br from-pink-400/40 to-rose-500/40 rounded-full"})]})}),e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-br from-pink-200/25 to-rose-300/25 rounded-3xl blur-2xl -z-10"})]})};export{W as C};
