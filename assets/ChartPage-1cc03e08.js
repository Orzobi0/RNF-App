import{r as d,j as r,M as R}from"./index-f990749f.js";import{g as j,R as M,F as N}from"./generatePlaceholders-53615b77.js";import{u as L,p as x,s as u,d as v}from"./useCycleData-758a573b.js";import"./fertilitySymbols-c96635e4.js";import"./ChartTooltip-c53a692f.js";import"./eye-8fe6b589.js";import"./eye-off-a2721236.js";const Y=()=>{const{currentCycle:t,isLoading:g}=L(),[s,f]=d.useState(typeof window<"u"&&window.innerWidth>window.innerHeight?"landscape":"portrait"),[a,m]=d.useState(!1);if(d.useLayoutEffect(()=>{window.dispatchEvent(new Event("resize"))},[s,a]),g)return r.jsx("p",{className:"text-center text-gray-500",children:"Cargando…"});if(!(t!=null&&t.id))return r.jsx("p",{className:"text-center text-pink-600",children:"No hay ciclo activo."});const S=28,D=10,i=x(t.startDate),h=t.data.reduce((e,n)=>{const o=x(n.isoDate);return o>e?o:e},i),p=u(new Date),C=h>p?h:p,F=v(u(C),i),c=Math.max(S,F+1),I=j(i,c).map(e=>{const n=t.data.find(o=>o.isoDate===e.isoDate);return n?{...n,date:e.date}:e}),l=s==="portrait"?D:c;let y=0;if(s!=="landscape"){const e=v(new Date,u(i)),n=Math.min(Math.max(e,0),c-1);let o=Math.min(c,n+1);n<l-1&&(o=Math.min(c,l)),y=Math.max(0,o-l)}const w={background:"linear-gradient(135deg, #FFFAFC 0%, #f7eaef 100%)"},b=a?w:{...w,height:s==="landscape"?"calc(max(100dvw) - var(--bottom-nav-safe))":"calc(100dvh - var(--bottom-nav-safe))",paddingBottom:"env(safe-area-inset-bottom)"},E=async()=>{if(a){try{await screen.orientation.unlock()}catch(e){console.error(e)}try{document.fullscreenElement&&await document.exitFullscreen()}catch(e){console.error(e)}f("portrait"),m(!1)}else try{await document.documentElement.requestFullscreen(),await screen.orientation.lock("landscape"),f("landscape"),m(!0)}catch(e){console.error(e)}};return r.jsx(R,{hideBottomNav:a,children:r.jsxs("div",{className:a?"fixed inset-0 z-50 h-[100dvh] w-[100dvw] overflow-x-auto overflow-y-auto":"relative w-full overflow-x-auto overflow-y-auto",style:b,children:[r.jsx("button",{onClick:E,className:"absolute top-4 right-4 z-10 bg-white/80 hover:bg-white text-gray-700 p-2 rounded-full shadow","aria-label":a?"Salir de pantalla completa":"Rotar gráfico",children:r.jsx(M,{className:"w-5 h-5"})}),r.jsx(N,{data:I,isFullScreen:a,orientation:s,cycleId:t.id,initialScrollIndex:y,visibleDays:l,reduceMotion:!0,forceLandscape:s==="landscape"})]})})};export{Y as default};
