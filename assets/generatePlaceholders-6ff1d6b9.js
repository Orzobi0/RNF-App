import{c as St,m as Y,j as t,s as ft,p as Mt,r as v,h as Tt,f as bt,d as It}from"./index-091bc822.js";import{g as Bt,i as vt}from"./DataEntryForm-8a2d2643.js";import{C as Wt}from"./ChartTooltip-fb88c83e.js";const re=St("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Rt=({padding:e,chartWidth:l,chartHeight:w,tempMin:p,tempMax:k,tempRange:y,getY:d,getX:f,allDataPoints:C=[],responsiveFontSize:m,isFullScreen:W,showLeftLabels:M=!1,reduceMotion:o=!1})=>{const c={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},x=[];if(y>0){const a=y<=2.5?.1:.5;for(let g=p;g<=k+1e-9;g+=a)x.push(parseFloat(g.toFixed(1)))}else for(let a=35;a<=37.5+1e-9;a+=.5)x.push(parseFloat(a.toFixed(1)));const n=o?"g":Y.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"bgGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(254, 242, 242, 0.95)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(255, 241, 242, 0.9)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(255, 245, 255, 0.95)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(254, 242, 242, 0.8)"})]}),t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("filter",{id:"chartGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("filter",{id:"textShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"rgba(255, 255, 255, 0.8)"})}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:[t.jsx("rect",{width:"6",height:"6",fill:"#f3f4f6"}),t.jsx("circle",{cx:"3",cy:"3",r:"1.5",fill:"rgba(239,68,68,0.7)"})]})]}),t.jsx("rect",{x:e.left,y:e.top,width:l-e.left-e.right,height:w-e.top-e.bottom,fill:"url(#bgGradientChart)",opacity:2,rx:12,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.1))"}}),x.map((a,g)=>{const R=d(a),T=a.toFixed(1).endsWith(".0")||a.toFixed(1).endsWith(".5"),O=T?a.toFixed(1):`.${a.toFixed(1).split(".")[1]}`;return t.jsxs(n,{...o?{}:{variants:c},children:[t.jsx("line",{x1:e.left,y1:R,x2:l-e.right,y2:R,stroke:T?"rgba(244, 114, 182, 0.3)":"rgba(244, 114, 182, 0.15)",strokeWidth:T?2:1,strokeDasharray:T?"0":"4,4",style:{filter:T?"drop-shadow(0 1px 3px rgba(244, 114, 182, 0.15))":"none",opacity:T?1:.7}}),M&&t.jsx("text",{x:e.left-m(1),y:R+m(.35),textAnchor:"end",fontSize:m(T?1.1:1),fontWeight:T?"700":"600",fill:T?"#E91E63":"#EC4899",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:O}),t.jsx("text",{x:l-e.right+m(1),y:R+m(.35),textAnchor:"start",fontSize:m(T?1.1:1),fontWeight:T?"700":"600",fill:T?"#E91E63":"#EC4899",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:O})]},`temp-tick-${g}`)}),C.map((a,g)=>{const R=f(g);return t.jsx("line",{x1:R,y1:e.top,x2:R,y2:w-e.bottom,stroke:"rgba(244, 114, 182, 0.08)",strokeWidth:2.8,style:{filter:"drop-shadow(0 0 1px rgba(244, 114, 182, 0.05))"}},`day-grid-${g}`)}),t.jsx("rect",{x:e.left,y:e.top,width:l-e.left-e.right,height:w-e.top-e.bottom,fill:"none",stroke:"rgba(244, 114, 182, 0.4)",strokeWidth:2,rx:12,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.15))",strokeDasharray:"0"}}),M&&t.jsx(n,{...o?{}:{variants:c},children:t.jsx("text",{x:e.left+m(1.2),y:e.top+m(1.5),textAnchor:"middle",fontSize:m(1.4),fontWeight:"800",fill:"#E91E63",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})})]})},Ot=({data:e,allDataPoints:l,getX:w,getY:p,baselineY:k,temperatureField:y="temperature",reduceMotion:d=!1})=>{if(!e||e.length<2)return null;let f="",C=null;const m=[];if(l.forEach((o,c)=>{const x=e.find(n=>n.id===o.id);if(x&&x[y]!==null&&x[y]!==void 0&&!x.ignored){const n=w(c),a=p(x[y]);m.push({x:n,y:a}),C!==null&&c===C+1?f+=` L ${n} ${a}`:f+=`${f?" ":""}M ${n} ${a}`,C=c}}),m.length<2)return null;const W=f.includes("L"),M=m.length>1?m.map(({x:o,y:c},x)=>`${x===0?"M":"L"} ${o} ${c}`).join(" "):"";return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"30%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"70%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),t.jsxs("linearGradient",{id:"tempLineGradientChartGlow",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244, 114, 182, 0.6)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(236, 72, 153, 0.7)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(233, 30, 99, 0.8)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(194, 24, 91, 0.6)"})]}),t.jsxs("filter",{id:"lineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("filter",{id:"lineShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodColor:"rgba(244, 114, 182, 0.4)"})})]}),W&&(d?t.jsx("path",{d:f,fill:"none",stroke:"url(#tempLineGradientChartGlow)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:.4,style:{filter:"url(#lineGlow)"}}):t.jsx(Y.path,{d:f,fill:"none",stroke:"url(#tempLineGradientChartGlow)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:.4,style:{filter:"url(#lineGlow)"},initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.4},transition:{duration:.8,ease:"easeInOut",delay:.2}})),M&&(d?t.jsx("path",{d:M,fill:"none",stroke:"#d587b1",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.65}):t.jsx(Y.path,{d:M,fill:"none",stroke:"#d587b1",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.65,initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.65},transition:{duration:.8,ease:"easeInOut"}})),W&&(d?t.jsx("path",{d:f,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#lineShadow)"}}):t.jsx(Y.path,{d:f,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#lineShadow)"},initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:1,ease:"easeInOut",delay:.4}})),W&&(d?t.jsx("path",{d:f,fill:"none",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8}):t.jsx(Y.path,{d:f,fill:"none",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8,initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.8},transition:{duration:1.2,ease:"easeInOut",delay:.6}}))]})},wt="#1565C0",Ct="#2E7D32",kt="#6A1B9A",Nt="#EFF6FF",_t="#EEF2FF",Pt="#ECFDF5",Ft="#F0FDFA",$t="#F5F3FF",Dt="#FAF5FF",Yt="rgba(148, 163, 184, 0.35)",Ut="rgba(226, 232, 240, 0.6)",Vt="rgba(148, 163, 184, 0.5)",Xt=e=>{if(!e)return"";const[l,w]=e.split("/");return`${parseInt(l,10)}/${parseInt(w,10)}`},yt=(e="",l,w,p="–")=>{if(!e)return[p,""];if(e.length<=l)return[e,""];if(w)return[e.slice(0,l),""];const k=e.indexOf(" ",l);return k===-1?[e.slice(0,l),e.slice(l)]:[e.slice(0,k),e.slice(k+1)]},mt=(e="",l,w="–")=>e?e.split(/\s+/).slice(0,l).join(" "):w,zt=({data:e,getX:l,getY:w,isFullScreen:p,orientation:k,responsiveFontSize:y,onPointInteraction:d,clearActivePoint:f,activePoint:C,padding:m,chartHeight:W,chartWidth:M,temperatureField:o="temperature_chart",textRowHeight:c,compact:x=!1,reduceMotion:n=!1,showInterpretation:a=!1,ovulationDetails:g=null})=>{const R={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},T={hidden:{opacity:0,scale:.3},visible:{opacity:1,scale:1,transition:{duration:.6,ease:[.34,1.56,.64,1],type:"spring",stiffness:120,damping:12}}},O=W-m.bottom,z=O+c*1,J=O+c*2,_=O+c*3,P=O+c*(p?5:4.5),Z=O+c*(p?7:6),U=O+c*(p?9:7.5),q=M-m.left-m.right,V=c*(p?2:1.5),rt=n?"g":Y.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsx("filter",{id:"rowShadowChart",x:"-10%",y:"-10%",width:"120%",height:"120%",children:t.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"4",floodColor:"rgba(244, 114, 182, 0.2)"})}),t.jsxs("filter",{id:"pointGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("linearGradient",{id:"sensationGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:Nt}),t.jsx("stop",{offset:"100%",stopColor:_t})]}),t.jsxs("linearGradient",{id:"appearanceGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:Pt}),t.jsx("stop",{offset:"100%",stopColor:Ft})]}),t.jsxs("linearGradient",{id:"observationGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:$t}),t.jsx("stop",{offset:"100%",stopColor:Dt})]}),t.jsxs("radialGradient",{id:"tempPointGradientChart",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#FCE7F3"}),t.jsx("stop",{offset:"40%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"80%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),t.jsxs("radialGradient",{id:"tempPointIgnoredGradient",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#FFFFFF"}),t.jsx("stop",{offset:"80%",stopColor:"#F8FAFC"}),t.jsx("stop",{offset:"100%",stopColor:"#E2E8F0"})]}),t.jsxs("radialGradient",{id:"ovulationPointGradient",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#bfdbfe"}),t.jsx("stop",{offset:"45%",stopColor:"#60a5fa"}),t.jsx("stop",{offset:"85%",stopColor:"#2563eb"}),t.jsx("stop",{offset:"100%",stopColor:"#1d4ed8"})]})]}),!x&&t.jsxs("g",{children:[t.jsx("rect",{x:m.left,y:P-V/2,width:q,height:V,fill:"url(#sensationGradientChart)",rx:4,style:{filter:"url(#rowShadowChart)"}}),t.jsx("rect",{x:m.left,y:Z-V/2,width:q,height:V,fill:"url(#appearanceGradientChart)",rx:4,style:{filter:"url(#rowShadowChart)"}}),t.jsx("rect",{x:m.left,y:U-V/2,width:q,height:V,fill:"url(#observationGradientChart)",rx:4,style:{filter:"url(#rowShadowChart)"}})]}),p&&k!=="portrait"&&t.jsx(Y.g,{variants:R,children:[{label:"Fecha",row:1,color:p?"#374151":"#6B7280"},{label:"Día",row:2,color:p?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:p?"#374151":"#6B7280"},{label:"Sens.",row:p?5:4.5,color:wt},{label:"Apar.",row:p?7:6,color:Ct},{label:"Observ.",row:p?9:7.5,color:kt}].map(({label:i,row:X,color:E})=>t.jsx("text",{x:m.left-y(.5),y:O+c*X,textAnchor:"end",fontSize:y(1.05),fontWeight:"700",fill:E,style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:i},i))}),e.map((i,X)=>{const E=l(X),u=i[o]!=null?w(i[o]):O,F=i.temperature_raw,$=i.temperature_corrected,K=i.use_corrected&&F!=null&&$!=null&&Math.abs($-F)>.01,H=K?w(F):null,st=p?"#374151":"#6B7280",s=i[o]!=null,j=s||i.mucus_sensation||i.mucus_appearance||i.fertility_symbol,r=String(i.id||"").startsWith("placeholder-"),b=g==null?void 0:g.ovulationIndex,h=a&&(g==null?void 0:g.confirmed)&&b!=null&&!i.ignored&&s&&X===b,I=!j||r?{}:{pointerEvents:"all",style:{cursor:"pointer"},onMouseEnter:N=>d(i,X,N),onClick:N=>d(i,X,N)},S=Bt(i.fertility_symbol);let A="transparent";if(S!=null&&S.color){const N=S.color.replace(/^bg-/,"");N==="red-500"?A="#ef4444":N==="white"?A="#ffffff":N==="green-500"?A="#22c55e":N==="pink-300"&&(A="#f9a8d4")}const L=y(p?1.8:2),D=i.isoDate?vt(ft(Mt(i.isoDate)),ft(new Date)):!1,Q=p?4:7,nt=2,[it,dt]=yt(p?mt(i.mucus_sensation,nt,D?"":"–"):i.mucus_sensation,Q,!1,D?"":"–"),[ht,at]=yt(p?mt(i.mucus_appearance,nt,D?"":"–"):i.mucus_appearance,Q,!1,D?"":"–"),[xt,ct]=yt(p?mt(i.observations,nt,""):i.observations,Q,!1,"");return t.jsxs(rt,{...n?{}:{variants:R},...I,children:[s&&t.jsxs(rt,{...n?{}:{variants:T},children:[K&&H!==null&&t.jsxs("g",{pointerEvents:"none",children:[t.jsx("line",{x1:E,y1:H,x2:E,y2:u,stroke:Yt,strokeWidth:1,strokeDasharray:"4 4"}),t.jsx("circle",{cx:E,cy:H,r:3.5,fill:Ut,stroke:Vt,strokeWidth:1}),t.jsx("circle",{cx:E,cy:H,r:1.2,fill:"rgba(255, 255, 255, 0.6)"})]}),t.jsx("circle",{cx:E,cy:u,r:h?2:1.5,fill:h?"rgba(59, 130, 246, 0.28)":"rgba(244, 114, 182, 0.2)",opacity:.85,style:{filter:"url(#pointGlow)"}}),t.jsx("circle",{cx:E,cy:u,r:h?4.2:3.5,fill:"none",stroke:i.ignored?"rgba(148, 163, 184, 0.4)":h?"rgba(37, 99, 235, 0.55)":"rgba(244, 114, 182, 0.3)",strokeWidth:h?2:1.5,opacity:h?.9:.6}),t.jsx("circle",{cx:E,cy:u,r:h?4.6:4,fill:i.ignored?"url(#tempPointIgnoredGradient)":h?"url(#ovulationPointGradient)":"url(#tempPointGradientChart)",stroke:i.use_corrected?"#F59E0B":i.ignored?"#94A3B8":h?"#1d4ed8":"#E91E63",strokeWidth:i.ignored?2:h?3.2:3,style:{filter:h?"drop-shadow(0 3px 8px rgba(37, 99, 235, 0.45))":"drop-shadow(0 3px 6px rgba(244, 114, 182, 0.4))",cursor:"pointer"},pointerEvents:"all",onMouseEnter:N=>d(i,X,N),onTouchStart:N=>d(i,X,N),onClick:N=>d(i,X,N)}),!i.ignored&&t.jsx("circle",{cx:E,cy:u,r:h?1.8:1.5,fill:h?"rgba(239, 246, 255, 0.95)":"rgba(255, 255, 255, 0.9)",style:{filter:h?"drop-shadow(0 1px 3px rgba(37, 99, 235, 0.45))":"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.3))"}}),h&&t.jsx("circle",{cx:E,cy:u,r:6.5,fill:"none",stroke:"rgba(37, 99, 235, 0.35)",strokeWidth:1.2,strokeDasharray:"4 3"})]}),t.jsx("text",{x:E,y:z,textAnchor:"middle",fontSize:y(1.05),fontWeight:"900",fill:st,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:Xt(i.date)}),t.jsx("text",{x:E,y:J,textAnchor:"middle",fontSize:y(1),fontWeight:"900",fill:st,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:i.cycleDay}),!r&&(S.value!=="none"?t.jsxs("g",{children:[t.jsx("rect",{x:E-L/2+1,y:_-L*.75+1,width:L,height:L,fill:"rgba(0, 0, 0, 0.1)",rx:L*.3,opacity:.5}),t.jsx("rect",{x:E-L/2-4,y:_-L*.75,width:L*1.4,height:L,fill:S.pattern==="spotting-pattern"?"url(#spotting-pattern-chart)":A,stroke:S.value==="white"?"#CBD5E1":"rgba(233, 30, 99, 0.4)",strokeWidth:S.value==="white"?2:1,rx:L*.2,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.25))"}})]}):t.jsx("text",{x:E,y:_,textAnchor:"middle",fontSize:y(1),fill:st,fontWeight:"500",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:"–"})),!x&&t.jsxs("text",{x:E,y:P,textAnchor:"middle",fontSize:y(.9),fontWeight:"700",fill:wt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:E,dy:0,children:it}),dt&&t.jsx("tspan",{x:E,dy:y(1.1),children:dt})]}),!x&&t.jsxs("text",{x:E,y:Z,textAnchor:"middle",fontSize:y(.9),fontWeight:"700",fill:Ct,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:E,dy:0,children:ht}),at&&t.jsx("tspan",{x:E,dy:y(1.1),children:at})]}),!x&&t.jsxs("text",{x:E,y:U,textAnchor:"middle",fontSize:y(.9),fontWeight:"700",fill:kt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:E,dy:0,children:xt}),ct&&t.jsx("tspan",{x:E,dy:y(1.1),children:ct})]})]},`pt-${X}-${i.isoDate||i.timestamp}`)})]})},Ht="#1565C0",qt="#2E7D32",Kt="#6A1B9A",Zt=({padding:e,chartHeight:l,tempMin:w,tempMax:p,tempRange:k,getY:y,responsiveFontSize:d,textRowHeight:f,isFullScreen:C})=>{const m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},W=[];if(k>0){const o=k<=2.5?.1:.5;for(let c=w;c<=p+1e-9;c+=o)W.push(parseFloat(c.toFixed(1)))}else for(let o=35;o<=37.5+1e-9;o+=.5)W.push(parseFloat(o.toFixed(1)));const M=l-e.bottom;return t.jsxs("svg",{width:e.left,height:l,className:"font-sans pointer-events-none",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"legendBgGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(255, 228, 230, 1)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(255, 229, 235, 1)  "}),t.jsx("stop",{offset:"70%",stopColor:"rgba(255, 241, 242, 1)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(255, 236, 240, 0.6)"})]}),t.jsxs("linearGradient",{id:"legendAccentGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsx("filter",{id:"legendShadowChart",x:"-20%",y:"-20%",width:"140%",height:"140%",children:t.jsx("feDropShadow",{dx:"0",dy:"3",stdDeviation:"4",floodColor:"rgba(244, 114, 182, 0.2)"})}),t.jsx("filter",{id:"textShadowLegend",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"rgba(255, 255, 255, 0.9)"})})]}),t.jsx("rect",{x:0,y:M+f*.5,width:e.left,height:f*(C?9.5:8),fill:"url(#legendBgGradientChart)",rx:12,style:{filter:"url(#legendShadowChart)"}}),W.map((o,c)=>{const x=y(o),n=o.toFixed(1).endsWith(".0")||o.toFixed(1).endsWith(".5"),a=n?o.toFixed(1):`.${o.toFixed(1).split(".")[1]}`;return t.jsx(Y.g,{variants:m,children:t.jsx("text",{x:e.left-d(1.2),y:x+d(.35),textAnchor:"end",fontSize:d(n?1.15:1),fontWeight:n?"800":"700",fill:n?"#E91E63":"#EC4899",style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:a})},`temp-tick-fixed-${c}`)}),t.jsx(Y.g,{variants:m,children:[{label:"Fecha",row:1,color:"#374151",icon:null},{label:"Día",row:2,color:"#374151",icon:null},{label:"Símbolo",row:3,color:"#374151",icon:null},{label:"Sens.",row:C?5:4.5,color:Ht,icon:"◊"},{label:"Apar.",row:C?7:6,color:qt,icon:"○"},{label:"Observ.",row:C?9:7.5,color:Kt,icon:"✦"}].map(({label:o,row:c,color:x,icon:n})=>t.jsxs("g",{children:[n&&t.jsx("text",{x:e.left-d(2.8),y:M+f*c,textAnchor:"middle",fontSize:d(.8),fontWeight:"600",fill:x,opacity:.7,style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:n}),t.jsx("text",{x:e.left-d(.8),y:M+f*c,textAnchor:"end",fontSize:d(1.05),fontWeight:"800",fill:x,style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o})]},o))})]})},Et=35.5,Lt=37.5,Jt=(e=[])=>{var M;const l=o=>o&&o.displayTemperature!=null&&!o.ignored,p=[];let k=null,y=null,d=null;const f=o=>{if(!o||o.length!==6)return null;const c=o.map(n=>n.temp);return c.some(n=>!Number.isFinite(n))?null:{baselineTemp:c.reduce((n,a)=>a>n?a:n,c[0]),baselineStartIndex:o[0].index}};for(let o=0;o<e.length;o++){const c=e[o];if(!l(c))continue;const x=c.displayTemperature;if(Number.isFinite(x)){if(p.length===6){const n=f(p);if(n&&(k=n.baselineTemp,y=n.baselineStartIndex,x>k)){d=o;break}}p.push({index:o,temp:x}),p.length>6&&p.shift()}}if(k==null&&p.length===6){const o=f(p);o&&(k=o.baselineTemp,y=o.baselineStartIndex)}const C={confirmed:!1,confirmationIndex:null,infertileStartIndex:null,rule:null,highSequenceIndices:[],ovulationIndex:null};if(k==null||d==null)return{baselineTemp:k,baselineStartIndex:y,firstHighIndex:d,ovulationDetails:C};const m=o=>{if(!o||o.length<3)return null;const c=k+.2,x=o.slice(0,3);if(x.length<3)return null;const n=x[2];if(n.temp>=c)return{confirmationIndex:n.index,usedIndices:x.map(a=>a.index),rule:"3-high"};if(o.length>=5){const a=o[3],g=o[4];if(a&&g&&a.temp>k&&g.temp>=c)return{confirmationIndex:g.index,usedIndices:o.slice(0,5).map(R=>R.index),rule:"5-high"}}return null};let W=C;for(let o=d;o<e.length;o++){const c=e[o];if(!l(c)||c.displayTemperature<=k)continue;const x=[];for(let a=o;a<e.length&&x.length<5;a++){const g=e[a];if(!l(g)||g.displayTemperature<=k)break;x.push({index:a,temp:g.displayTemperature})}const n=m(x);if(n){W={confirmed:!0,confirmationIndex:n.confirmationIndex,infertileStartIndex:n.confirmationIndex,rule:n.rule,highSequenceIndices:n.usedIndices,ovulationIndex:d??((M=n.usedIndices)!=null&&M.length?n.usedIndices[0]:null)};break}}return{baselineTemp:k,baselineStartIndex:y,firstHighIndex:d,ovulationDetails:W}},Qt=(e,l,w,p,k,y=5,d=!1)=>{const f=v.useRef(null),C=v.useRef(null),[m,W]=v.useState({width:0,height:0}),[M,o]=v.useState(null),[c,x]=v.useState({x:0,y:0}),n=v.useMemo(()=>{const s=r=>{if(r==null||r==="")return null;const b=parseFloat(String(r).replace(",","."));return Number.isFinite(b)?b:null},j=r=>{if(!r)return null;const b=s(r.temperature),h=s(r.temperature_corrected);return r.use_corrected&&h!==null?h:b!==null?b:h!==null?h:null};return e.map(r=>{const b=[r==null?void 0:r.temperature_chart,r==null?void 0:r.temperature_raw,r==null?void 0:r.temperature_corrected];let h=null;for(const I of b)if(I!=null&&I!==""){h=I;break}if(h==null&&Array.isArray(r==null?void 0:r.measurements)){const S=r.measurements.find(A=>A&&A.selected&&j(A)!==null)||r.measurements.find(A=>j(A)!==null);S&&(h=j(S))}return{...r,displayTemperature:s(h)}})},[e]);v.useLayoutEffect(()=>{const s=()=>{if(!f.current)return;const r=f.current.parentElement||f.current;let b=r.clientWidth||600,h=r.clientHeight||400,I=f.current.clientWidth>0?f.current.clientWidth:b,S,A;if(l){let L=window.innerWidth,D=window.innerHeight;if(d&&D>L&&([L,D]=[D,L]),I=L,w==="portrait"&&!d){const Q=Math.max(30,L*.05);S=(L-Q)/y*e.length}else S=L/y*e.length;A=D}else S=I/y*e.length,A=h;W({width:S,height:A})};s(),window.addEventListener("resize",s);let j;if(f.current){const r=f.current.parentElement||f.current;j=new ResizeObserver(s),j.observe(r)}return()=>{window.removeEventListener("resize",s),j&&j.disconnect()}},[l,e.length,y,w,d]);const a=v.useMemo(()=>n.filter(s=>s&&s.isoDate&&!s.ignored&&s.displayTemperature!==null&&s.displayTemperature!==void 0),[n]),g=v.useMemo(()=>n.filter(s=>s&&s.isoDate),[n]),{baselineTemp:R,baselineStartIndex:T,firstHighIndex:O,ovulationDetails:z}=v.useMemo(()=>Jt(n),[n]),{tempMin:J,tempMax:_}=v.useMemo(()=>{const s=a.map(b=>b.displayTemperature).filter(b=>b!=null);if(s.length===0)return{tempMin:Et,tempMax:Lt};let j=Math.min(...s,Et),r=Math.max(...s,Lt);if(j=Math.floor(j*2)/2,r=Math.ceil(r*2)/2,r-j<2){const b=(j+r)/2;j=b-1,r=b+1}return{tempMin:j,tempMax:r}},[a]),P=_-J,Z=m.width,U=m.height,q=9,V=(s=1)=>{if(!l)return q*s;const j=Math.min(Z,U);return Math.max(8,Math.min(q*s,j/(g.length>0?40/s:40)))},rt=V(l?1.6:2.5),i=d||w==="landscape",E=rt*(i?9:5),u={top:l?Math.max(i?6:12,U*(i?.015:.03)):12,right:l?Math.max(i?35:30,Z*(i?.02:.05)):50,bottom:(l?Math.max(i?0:40,U*(i?0:.11)):60)+E+25,left:l?Math.max(i?45:20,Z*(i?.02:.05)):50},F=s=>{if(s==null||P===0)return U-u.bottom;const j=U-u.top-u.bottom;return j<=0?U-u.bottom:U-u.bottom-(s-J)/P*j},$=s=>{const j=l&&!(d||w==="landscape")?5:10,r=l&&!(d||w==="landscape")?25:0,b=Z-u.left-u.right-j-r*(g.length-1);if(b<=0)return u.left+j+r*s;const h=g.length>1?g.length-1:1;return h===0||g.length===0?u.left+j+r*s:u.left+j+s*(b/(g.length===1?1:h))+r*s},K=(s,j,r)=>{if(!s||String(s.id).startsWith("placeholder-")){H();return}const b=f.current.getBoundingClientRect();let h,I;if(r.type.startsWith("touch")){const L=r.changedTouches[0];h=L.clientX,I=L.clientY}else h=r.clientX,I=r.clientY;const S=$(j),A=F(s.displayTemperature);x({svgX:S,svgY:A,clientX:h-b.left+f.current.scrollLeft,clientY:I-b.top+f.current.scrollTop}),o(s)};v.useEffect(()=>{const s=j=>{var r;if(C.current&&!C.current.contains(j.target)){const b=(r=f.current)==null?void 0:r.querySelectorAll("circle, text, rect");let h=!1;if(b){for(let I of b)if(I.contains(j.target)){h=!0;break}}h||o(null)}};return M&&(document.addEventListener("mousedown",s),document.addEventListener("touchstart",s)),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[M]);const H=()=>{o(null)};return{chartRef:f,tooltipRef:C,dimensions:m,activePoint:M,tooltipPosition:c,processedData:n,validDataForLine:a,allDataPoints:g,tempMin:J,tempMax:_,tempRange:P,padding:u,textRowHeight:rt,setActivePoint:o,getY:F,getX:$,handlePointInteraction:K,clearActivePoint:H,handleToggleIgnore:s=>{p&&s&&(p(k,s),o(null))},responsiveFontSize:V,baselineTemp:R,baselineStartIndex:T,firstHighIndex:O,ovulationDetails:z}},se=({data:e,isFullScreen:l,orientation:w,onToggleIgnore:p,onEdit:k,cycleId:y,initialScrollIndex:d=0,visibleDays:f=5,showInterpretation:C=!1,reduceMotion:m=!1,forceLandscape:W=!1})=>{const{chartRef:M,tooltipRef:o,dimensions:c,activePoint:x,tooltipPosition:n,allDataPoints:a,validDataForLine:g,tempMin:R,tempMax:T,tempRange:O,padding:z,textRowHeight:J,getY:_,getX:P,handlePointInteraction:Z,handleToggleIgnore:U,responsiveFontSize:q,clearActivePoint:V,setActivePoint:rt,baselineTemp:i,baselineStartIndex:X,firstHighIndex:E,ovulationDetails:u}=Qt(e,l,w,p,y,f,W);if(!a||a.length===0)return t.jsxs("div",{className:"text-center p-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-pink-100 to-rose-100 rounded-full mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("p",{className:"text-slate-400 font-medium",children:"No hay datos para mostrar en el gráfico"})]});const F=c.width,$=c.height,K=i!=null?_(i):null,H=!!(u!=null&&u.confirmed),st=i!=null,s=P(0),j=a.length>0?P(a.length-1):F-z.right,r=H?"#F59E0B":"#94A3B8",b=H?"6 4":"4 4",h=H?1:.7,I=3,S=F===0,A=$-z.bottom,L=v.useMemo(()=>{const B=new Map;return g.forEach(G=>{G&&G.id!=null&&B.set(G.id,G)}),B},[g]),D=v.useMemo(()=>{const B=G=>{if(!G||G.length<2)return null;let lt=`M ${G[0].x} ${A} L ${G[0].x} ${G[0].y}`;for(let et=1;et<G.length;et++){const ot=G[et];lt+=` L ${ot.x} ${ot.y}`}return lt+=` L ${G[G.length-1].x} ${A} Z`,lt};return G=>{if(typeof G!="function")return[];const lt=[];let et=[],ot=!1;const jt=()=>{const tt=B(et);tt&&lt.push(tt),et=[]};for(let tt=0;tt<a.length;tt++){if(!G(tt)){ot&&(jt(),ot=!1);continue}ot=!0;const pt=a[tt],ut=L.get(pt==null?void 0:pt.id);if(!ut||!Number.isFinite(ut.displayTemperature))continue;const At=P(tt),Gt=_(ut.displayTemperature);et.push({x:At,y:Gt})}return ot&&jt(),lt}},[a,L,P,_,A]),Q=v.useMemo(()=>!C||!(u!=null&&u.confirmed)?[]:Number.isFinite(u.confirmationIndex)?D(B=>B<=u.confirmationIndex):[],[C,u,D]),nt=v.useMemo(()=>!C||!(u!=null&&u.confirmed)?[]:Number.isFinite(u.infertileStartIndex)?D(B=>B>=u.infertileStartIndex):[],[C,u,D]),[it,dt]=v.useState({w:typeof window<"u"?window.innerWidth:0,h:typeof window<"u"?window.innerHeight:0}),ht=it.w<it.h;v.useEffect(()=>{const B=()=>dt({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",B),window.addEventListener("orientationchange",B),()=>{window.removeEventListener("resize",B),window.removeEventListener("orientationchange",B)}},[]),v.useEffect(()=>{if(!M.current)return;const B=M.current.clientWidth/f;M.current.scrollLeft=Math.max(0,B*d)},[d,f,c.width,w]);const at=W&&ht,xt=at,ct="w-full h-full bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100",N=l?`${ct} min-h-full ${xt?"flex items-stretch justify-start overflow-y-auto overflow-x-hidden":"flex items-center justify-start overflow-x-auto overflow-y-hidden"}`:`${ct} overflow-x-auto overflow-y-hidden border border-pink-100/50`,gt=!l||w==="portrait";return t.jsxs(Y.div,{className:"relative w-full h-full",initial:!1,children:[gt&&t.jsx("div",{className:"absolute left-0 top-0 h-full bg-transparent pointer-events-none z-10",style:{width:z.left},children:t.jsx(Zt,{padding:z,chartHeight:$,tempMin:R,tempMax:T,tempRange:O,getY:_,responsiveFontSize:q,textRowHeight:J,isFullScreen:l})}),t.jsxs(Y.div,{ref:M,className:`relative p-0 ${l?"":"rounded-2xl"} ${N}`,style:{boxShadow:l?"inset 0 1px 3px rgba(244, 114, 182, 0.1)":"0 8px 32px rgba(244, 114, 182, 0.12), 0 2px 8px rgba(244, 114, 182, 0.08)",...at?{position:"absolute",top:0,left:0,width:`${it.h}px`,height:`${it.w}px`,transform:"rotate(90deg) translateY(-100%)",transformOrigin:"top left"}:{}},initial:!1,children:[S&&t.jsx("div",{className:"flex items-center justify-center w-full h-full text-slate-400",children:"Cargando..."}),t.jsxs(Y.svg,{width:F,height:$,className:"font-sans flex-shrink-0",viewBox:`0 0 ${F} ${$}`,preserveAspectRatio:"xMidYMid meet",initial:!1,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("linearGradient",{id:"tempAreaGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244,114,182,0.25)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(236,72,153,0.15)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(233,30,99,0.05)"})]}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:[t.jsx("rect",{width:"6",height:"6",fill:"#f3f4f6"}),t.jsx("circle",{cx:"3",cy:"3",r:"1.5",fill:"rgba(239,68,68,0.7)"})]}),t.jsxs("filter",{id:"chartShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("filter",{id:"baselineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1.5",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("linearGradient",{id:"fertileAreaGradient",x1:"0%",y1:"100%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(253, 224, 255, 0.9)"}),t.jsx("stop",{offset:"65%",stopColor:"rgba(249, 168, 212, 0.6)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(236, 72, 153, 0.28)"})]}),t.jsxs("linearGradient",{id:"infertileAreaGradient",x1:"0%",y1:"100%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(109, 189, 245, 0.48)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(111, 168, 220, 0.48)"}),t.jsx("stop",{offset:"80%",stopColor:"rgba(120, 143, 207, 0.48)"})]})]}),t.jsx("rect",{width:"100%",height:"100%",fill:"transparent"}),t.jsx(Rt,{padding:z,chartWidth:F,chartHeight:$,tempMin:R,tempMax:T,tempRange:O,getY:_,getX:P,allDataPoints:a,responsiveFontSize:q,isFullScreen:l,showLeftLabels:!gt,reduceMotion:m}),C&&(u==null?void 0:u.confirmed)&&t.jsxs(t.Fragment,{children:[Q.map((B,G)=>t.jsx("path",{d:B,fill:"url(#fertileAreaGradient)",opacity:.65,pointerEvents:"none"},`fertile-area-${G}`)),nt.map((B,G)=>t.jsx("path",{d:B,fill:"url(#infertileAreaGradient)",opacity:.6,pointerEvents:"none"},`infertile-area-${G}`))]}),C&&st&&K!==null&&(m?t.jsx("line",{x1:s,y1:K,x2:j,y2:K,stroke:r,strokeWidth:I,strokeDasharray:b,opacity:h}):t.jsx(Y.path,{d:`M ${s} ${K} L ${j} ${K}`,stroke:r,strokeWidth:I,strokeDasharray:b,opacity:h,initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:h},transition:{duration:4,ease:"easeInOut",delay:.5}})),t.jsx(Ot,{data:g,allDataPoints:a,getX:P,getY:_,baselineY:$-z.bottom,temperatureField:"displayTemperature",reduceMotion:m}),t.jsx(zt,{data:a,getX:P,getY:_,isFullScreen:l,orientation:w,responsiveFontSize:q,onPointInteraction:Z,clearActivePoint:V,activePoint:x,padding:z,chartHeight:$,chartWidth:F,temperatureField:"displayTemperature",textRowHeight:J,compact:!1,reduceMotion:m,showInterpretation:C,ovulationDetails:u})]}),x&&t.jsx(Y.div,{ref:o,initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},transition:{duration:.2,ease:"easeOut"},children:t.jsx(Wt,{point:x,position:n,chartWidth:F,chartHeight:$,onToggleIgnore:U,onEdit:k,onClose:V})})]})]})};function ne(e,l){if(!e||!l)return[];const w=typeof e=="string"?Mt(e):e;return[...Array(l)].map((p,k)=>{const y=Tt(w,k),d=bt(y,"yyyy-MM-dd"),f=bt(y,"dd/MM"),C=It(ft(y),ft(w))+1;return{date:f,isoDate:d,cycleDay:C,temperature:null,mucusSensation:null,mucusAppearance:null,id:`placeholder-${d}`,ignored:!1}})}export{se as F,re as R,ne as g};
