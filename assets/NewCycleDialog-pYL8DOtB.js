import{c as f,j as e,B as m,r as H,g as u}from"./index-C041RoKp.js";import{O}from"./OverlapWarningDialog-CRNazV6l.js";import{u as z}from"./badge-BbO7fxzd.js";import{D as G,a as R,b as V,c as A,d as P,e as W}from"./useCycleData-fUMApAkg.js";import{I as Y}from"./input-D9upNPQ0.js";const _=f("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ee=f("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Z=f("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),j=a=>{if(!a)return"";const t=new Date(a);if(Number.isNaN(t.getTime()))return a;const n=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getFullYear());return`${n}/${s}/${l}`},ae=({cycle:a,startDate:t,endDate:n,onStartDateChange:s,onEndDateChange:l,onSave:p,onCancel:r,isProcessing:o=!1,dateError:x="",includeEndDate:c=!0,showOverlapDialog:i=!1,overlapCycle:N=null,onConfirmOverlap:D,onCancelOverlap:w,title:M="Editar fechas del ciclo",description:C="Actualiza las fechas de inicio y fin del ciclo. Guarda los cambios cuando termines.",saveLabel:k="Guardar",cancelLabel:S="Cancelar",onClearError:h,className:$="mb-6 mx-auto w-full max-w-xl",onDeleteCycle:g,deleteTitle:F="Eliminar ciclo",deleteDescription:y="Esta acción no se puede deshacer. Se eliminarán todos los registros asociados.",deleteLabel:E="Eliminar ciclo",isDeletingCycle:L=!1})=>{const b=a?.startDate?j(a.startDate):null,I=a?.endDate?j(a.endDate):"En curso",v=b?`Fecha actual: ${b}${c?` — ${I}`:""}`:null,T=d=>{h&&h(),s?.(d.target.value)},q=d=>{h&&h(),l?.(d.target.value)},B=d=>{d.preventDefault(),p?.()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${$} rounded-3xl border border-rose-100 bg-white/90 p-5 shadow-md`,children:e.jsx("form",{onSubmit:B,className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-titulo mb-1",children:M}),e.jsx("p",{className:"text-sm text-slate-600",children:C}),v&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:v}),e.jsxs("div",{className:`grid ${c?"grid-cols-2 gap-4":"grid-cols-1 gap-4"}`,children:[e.jsxs("label",{className:"flex h-full flex-col text-sm text-slate-700",children:["Inicio del ciclo",e.jsx("input",{type:"date",value:t||"",onChange:T,className:"mt-1 w-full rounded-lg border border-fertiliapp-suave bg-white px-3 py-2 text-slate-800 focus:border-fertiliapp-suave focus:outline-none focus:ring-2 focus:ring-fertiliapp-suave"})]}),c&&e.jsxs("label",{className:"flex h-full flex-col text-sm text-slate-700",children:["Fin del ciclo",e.jsx("input",{type:"date",value:n||"",onChange:q,className:"mt-1 w-full rounded-lg border border-fertiliapp-suave bg-white px-3 py-2 text-slate-800 focus:border-fertiliapp-suave focus:outline-none focus:ring-2 focus:ring-fertiliapp-suave"})]})]}),x&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:x}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 justify-center",children:[e.jsx(m,{type:"button",variant:"outline",onClick:r,className:"border-fertiliapp-suave text-titulo hover:brightness-95",disabled:o,children:S}),e.jsx(m,{type:"submit",className:"bg-fertiliapp-fuerte text-white shadow hover:brightness-95",disabled:o,children:k})]}),g&&e.jsxs("div",{className:"mt-6 rounded-3xl bg-alerta-2-suave p-4 text-left",children:[e.jsx("h3",{className:"font-semibold text-slate-800 mb-2",children:F}),y&&e.jsx("p",{className:"text-sm text-slate-800 mb-3",children:y}),e.jsxs(m,{type:"button",onClick:g,disabled:o||L,className:"w-full sm:w-auto bg-alerta-2 hover:brightness-95 text-white shadow-md",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),E]})]})]})})}),e.jsx(O,{isOpen:i,conflictCycle:N,onCancel:w,onConfirm:D})]})},te=({isOpen:a,onClose:t,onConfirm:n,currentCycleStartDate:s})=>{const[l,p]=H.useState(u(new Date,"yyyy-MM-dd"));z(a,t);const r=!s,o=()=>{n(l)},x=r?"":u(new Date(s),"dd/MM/yyyy"),c=(()=>{if(r)return"";const i=new Date(l);return i.setDate(i.getDate()-1),u(i,"dd/MM/yyyy")})();return e.jsx(G,{open:a,onOpenChange:t,children:e.jsxs(R,{className:"bg-white border-pink-100 text-gray-800 rounded-3xl",children:[e.jsxs(V,{children:[e.jsx(A,{children:"Iniciar nuevo ciclo"}),e.jsx(P,{className:"text-gray-600",children:r?"Este será tu primer ciclo. Selecciona la fecha de inicio.":`¿Estás seguro de que quieres iniciar un nuevo ciclo? Los datos del ciclo actual (${x} - ${c}) serán archivados.`})]}),e.jsxs("div",{className:"my-4 space-y-2",children:[e.jsx("label",{htmlFor:"startDate",className:"text-gray-700 text-sm",children:"Fecha de inicio del nuevo ciclo"}),e.jsx(Y,{id:"startDate",type:"date",value:l,onChange:i=>p(i.target.value),max:u(new Date,"yyyy-MM-dd"),min:r?void 0:u(new Date(s),"yyyy-MM-dd"),className:"bg-gray-50 border-gray-200 text-gray-800"})]}),e.jsxs(W,{className:"sm:justify-end",children:[e.jsx(m,{variant:"outline",onClick:t,className:"border-gray-300 text-subtitulo hover:brightness-95",children:"Cancelar"}),e.jsx(m,{variant:"primary",onClick:o,className:"bg-fertiliapp-fuerte hover:brightness-95 text-white",children:r?"Iniciar ciclo":"Confirmar nuevo ciclo"})]})]})})};export{ae as C,_ as L,te as N,ee as P,Z as T};
