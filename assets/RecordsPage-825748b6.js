import{c as N,b as S,r as s,j as e,m as g,B as E,f as R,p as C}from"./index-52f58b78.js";import{R as F,D as P}from"./DeletionDialog-67eaf41a.js";import{D as T}from"./computePeakStatuses-d276643a.js";import{u as L,D as M,a as O}from"./useCycleData-de3e222e.js";import{P as z}from"./badge-9df465b8.js";import"./eye-038575bd.js";import"./trash-2-f191a093.js";import"./input-e93faeb5.js";import"./label-73ddbd29.js";import"./select-02b6d54e.js";import"./eye-off-d66a2167.js";const I=N("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),X=()=>{const{currentCycle:t,addOrUpdateDataPoint:y,deleteRecord:h,isLoading:f}=L(),{toast:x}=S(),[b,r]=s.useState(!1),[d,i]=s.useState(null),[o,c]=s.useState(null),[n,l]=s.useState(!1),p=s.useCallback(()=>{r(!1),i(null)},[]),v=a=>{i(a),r(!0)},j=a=>{const m=t.data.find(u=>u.id===a);c(m)},D=s.useCallback(a=>{i(a)},[]),w=async(a,{keepFormOpen:m=!1}={})=>{l(!0);try{await y(a,d),m||(r(!1),i(null))}catch{x({title:"Error",description:"No se pudo guardar el registro",variant:"destructive"})}finally{l(!1)}},k=async()=>{if(o){l(!0);try{await h(o.id),c(null)}catch{x({title:"Error",description:"No se pudo eliminar el registro",variant:"destructive"})}finally{l(!1)}}};return f&&!(t!=null&&t.id)?e.jsxs("div",{className:"min-h-[100dvh] bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100 flex items-center justify-center",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:"radial-gradient(65% 55% at 50% 32%, rgba(244,114,182,0.18) 0%, rgba(244,114,182,0.12) 35%, rgba(244,114,182,0.06) 60%, rgba(244,114,182,0) 100%)"}}),e.jsx("p",{className:"text-center text-slate-600 text-lg",children:"Cargando..."})]}):t!=null&&t.id?e.jsxs("div",{className:"min-h-[100dvh] bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100 relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:"radial-gradient(65% 55% at 50% 32%, rgba(244,114,182,0.18) 0%, rgba(244,114,182,0.12) 35%, rgba(244,114,182,0.06) 60%, rgba(244,114,182,0) 100%)"}}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 relative z-10",children:[e.jsxs(g.div,{className:"flex flex-col sm:flex-row justify-between items-center mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-700 mb-4 sm:mb-0 flex items-center",children:[e.jsx(I,{className:"mr-3 h-8 w-8 text-pink-500"}),"Mis Registros"]}),e.jsxs(E,{type:"button",onClick:()=>{i(null),r(!0)},className:"bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 text-white shadow-lg",disabled:n,style:{filter:"drop-shadow(0 6px 12px rgba(236, 72, 153, 0.3))"},children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"AÃ±adir registro"]})]}),e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:e.jsx(F,{records:t.data,onEdit:v,onDelete:j,isProcessing:n})})]}),e.jsx(M,{open:b,onOpenChange:a=>{a?r(!0):p()},children:e.jsx(O,{hideClose:!0,className:"bg-white border-pink-100 text-gray-800 w-[90vw] sm:w-auto max-w-md sm:max-w-lg md:max-w-xl max-h-[85vh] overflow-y-auto p-4 sm:p-6 rounded-2xl",children:e.jsx(T,{onSubmit:w,onCancel:p,initialData:d,cycleStartDate:t.startDate,cycleEndDate:t.endDate,isProcessing:n,isEditing:!!d,cycleData:t.data,onDateSelect:D})})}),e.jsx(P,{isOpen:!!o,onClose:()=>c(null),onConfirm:k,recordDate:o?R(C(o.isoDate),"dd/MM/yyyy"):"",isProcessing:n})]}):e.jsxs("div",{className:"min-h-[100dvh] bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100 flex items-center justify-center",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:"radial-gradient(65% 55% at 50% 32%, rgba(244,114,182,0.18) 0%, rgba(244,114,182,0.12) 35%, rgba(244,114,182,0.06) 60%, rgba(244,114,182,0) 100%)"}}),e.jsx("p",{className:"text-center text-slate-600 text-lg",children:"No hay ciclo activo."})]})};export{X as default};
