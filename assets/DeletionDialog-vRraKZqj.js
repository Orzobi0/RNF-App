import{j as e,B as h,k as w,f as B,R as I,K as O}from"./index-BrkKcvYr.js";import{D as v,a as N,b as $,c as k,d as C,e as E}from"./useCycleData-NykkPLt1.js";import{u as L}from"./useBackClose-C07k0QgV.js";const z=({isOpen:d,onCancel:o,onConfirm:p,conflictCycle:t,message:x,title:f="Solapamiento detectado",description:g,confirmLabel:j="Confirmar",affectedCycles:a=[],impactSummary:r,adjustedCyclesPreview:l=[]})=>{const i=s=>{if(!s)return null;try{return w(B(s),"dd-MM-yyyy")}catch(n){return console.error("Failed to format conflict cycle date",n),s}},c=r?.trimmedCycles??r?.trims??0,b=r?.deletedCycles??r?.deletions??0,D=r?.movedEntries??0,y=t?.startDate?i(t.startDate):null,q=t?.endDate?i(t.endDate):"actualmente en curso";return e.jsx(v,{open:d,onOpenChange:o,children:e.jsxs(N,{className:"bg-slate-50 border-slate-200 text-gray-800",children:[e.jsxs($,{children:[e.jsx(k,{children:f}),e.jsx(C,{className:"text-gray-600",children:g??x??(t?`La nueva fecha se solapa con el ciclo que comenzó el ${y??"sin inicio registrado"} y terminó el ${q}. ¿Deseas ajustar las fechas y mover los registros al nuevo ciclo?`:"La nueva fecha de inicio se solapa con otro ciclo. ¿Deseas continuar?")})]}),a.length>0&&e.jsxs("div",{className:"bg-slate-50 px-3 py-2 text-sm text-slate-700",children:[e.jsx("p",{className:"font-semibold",children:"Este nuevo cambio afecta a los ciclos:"}),e.jsx("ul",{className:"mt-2 space-y-1 list-disc pl-4",children:a.map((s,n)=>{if(typeof s=="string")return e.jsx("li",{children:s},`${s}-${n}`);const m=i(s?.startDate)??"sin inicio",u=s?.endDate?i(s.endDate):"en curso";return e.jsxs("li",{children:[m," - ",u]},`${s?.cycleId||s?.id||n}`)})})]}),r&&e.jsx("div",{className:"bg-slate-50 px-3 py-2 text-sm font-semibold text-slate-800",children:e.jsxs("p",{children:["Esto implica ",[c>0?`${c} recortes`:null,b>0?`${b} eliminaciones`:null,D>0?`${D} registros movidos`:null].filter(Boolean).join(" y ")||"sin recortes, eliminaciones ni movimientos de registros","."]})}),l.length>0&&e.jsxs("div",{className:"bg-slate-50 px-3 py-2 text-sm text-slate-700",children:[e.jsx("p",{className:"font-semibold",children:"Los ciclos afectados quedarán así:"}),e.jsx("ul",{className:"mt-2 list-disc space-y-1 pl-4",children:l.map((s,n)=>{const m=i(s.startDate)??"sin inicio",u=s.endDate?i(s.endDate):"en curso";return s.type==="delete"||s.deleted?e.jsxs("li",{children:[m," - ",u," (eliminado)"]},`${s.cycleId}-delete-${n}`):e.jsxs("li",{children:[m," - ",u]},`${s.cycleId}-${s.startDate}-${n}`)})})]}),e.jsxs(E,{className:"sm:justify-end",children:[e.jsx(h,{variant:"outline",onClick:o,className:"border-gray-300 text-titulo hover:bg-gray-100",children:"Cancelar"}),e.jsx(h,{variant:"destructive",onClick:p,className:"bg-fertiliapp-fuerte hover:bg-pink-700 text-white",children:j})]})]})})},H=({isOpen:d,onClose:o,onConfirm:p,recordDate:t,title:x="Confirmar eliminación",description:f,confirmLabel:g="Eliminar",cancelLabel:j="Cancelar",isProcessing:a=!1,confirmButtonClassName:r})=>{const l=I.useCallback(()=>{a||o()},[a,o]);L(d,l);const i=f??(t?`¿Estás seguro de que quieres eliminar el registro del ${t}? Esta acción no se puede deshacer.`:"Esta acción no se puede deshacer.");return e.jsx(v,{open:d,onOpenChange:c=>{c||l()},children:e.jsxs(N,{className:"bg-white/95 backdrop-blur border border-fertiliapp-fuerte text-slate-700",children:[e.jsxs($,{children:[e.jsx(k,{className:"text-lg font-semibold text-fertiliapp-fuerte",children:x}),e.jsx(C,{className:"text-slate-600",children:i})]}),e.jsxs(E,{className:"sm:justify-end gap-3",children:[e.jsx(h,{type:"button",variant:"outline",onClick:l,disabled:a,className:"border-pink-200 text-fertiliapp-fuerte hover:bg-pink-50 hover:text-fertiliapp-fuerte",children:j}),e.jsx(h,{type:"button",onClick:p,disabled:a,className:O("bg-fertiliapp-fuerte hover:brightness-95 text-white shadow-lg",a&&"opacity-80 cursor-not-allowed",r),children:g})]})]})})};export{H as D,z as O};
