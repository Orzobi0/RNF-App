import{c as ht,m as $,j as t,r as T}from"./index-515ab6fa.js";import{g as dt,i as ft,X as xt,E as mt}from"./fertilitySymbols-a1da4b8d.js";import{s as Z,p as ot,f as rt,e as pt,E as ut,a as yt,d as gt}from"./useCycleData-84338cda.js";import{B as tt}from"./button-2e71b65a.js";import{P as bt}from"./pen-line-ec9e56a0.js";const Pt=ht("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),jt=({padding:e,chartWidth:r,chartHeight:x,tempMin:h,tempMax:C,tempRange:c,getY:l,getX:d,allDataPoints:g=[],responsiveFontSize:a,isFullScreen:E,showLeftLabels:b=!0,reduceMotion:n=!1})=>{const p={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},B=[];if(c>0){const y=c<=2.5?.1:.5;for(let k=h;k<=C+1e-9;k+=y)B.push(parseFloat(k.toFixed(1)))}else for(let y=35;y<=37.5+1e-9;y+=.5)B.push(parseFloat(y.toFixed(1)));const w=n?"g":$.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"bgGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(252, 231, 243, 0.3)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(255, 255, 255, 0.8)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(252, 231, 243, 0.2)"})]}),t.jsxs("filter",{id:"softGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx("rect",{x:e.left,y:e.top,width:r-e.left-e.right,height:x-e.top-e.bottom,fill:"url(#bgGradient)",opacity:.4}),B.map((y,k)=>{const v=l(y),W=y.toFixed(1).endsWith(".0")||y.toFixed(1).endsWith(".5"),Y=W?y.toFixed(1):`.${y.toFixed(1).split(".")[1]}`;return t.jsxs(w,{...n?{}:{variants:p},children:[t.jsx("line",{x1:e.left,y1:v,x2:r-e.right,y2:v,stroke:W?"rgba(244, 114, 182, 0.25)":"rgba(244, 114, 182, 0.15)",strokeWidth:W?1.5:1,strokeDasharray:W?"0":"3,3",style:{filter:W?"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.1))":"none"}}),b&&t.jsx("text",{x:e.left-a(1),y:v+a(.35),textAnchor:"end",fontSize:a(W?1:.9),fontWeight:W?"600":"500",fill:W?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Y}),t.jsx("text",{x:r-e.right+a(1),y:v+a(.35),textAnchor:"start",fontSize:a(W?1:.9),fontWeight:W?"600":"500",fill:W?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Y})]},`temp-tick-${k}`)}),g.map((y,k)=>{const v=d(k);return t.jsx("line",{x1:v,y1:e.top,x2:v,y2:x-e.bottom,stroke:"rgba(244, 114, 182, 0.12)",strokeWidth:.8,style:{filter:"drop-shadow(0 0 1px rgba(244, 114, 182, 0.1))"}},`day-grid-${k}`)}),b&&t.jsxs(w,{...n?{}:{variants:p},children:[t.jsx("rect",{x:e.left-a(.2),y:e.top-a(.2),width:a(2.8),height:a(2),rx:a(.3),fill:"rgba(244, 114, 182, 0.1)",stroke:"rgba(244, 114, 182, 0.2)",strokeWidth:.5}),t.jsx("text",{x:e.left+a(1.2),y:e.top+a(1.1),textAnchor:"middle",fontSize:a(1.3),fontWeight:"700",fill:"#E91E63",style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),t.jsx("rect",{x:e.left,y:e.top,width:r-e.left-e.right,height:x-e.top-e.bottom,fill:"none",stroke:"rgba(244, 114, 182, 0.2)",strokeWidth:1.5,rx:8,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.1))"}})]})},wt=({data:e,allDataPoints:r,getX:x,getY:h,baselineY:C,temperatureField:c="temperature",reduceMotion:l=!1})=>{if(!e||e.length<2)return null;let d="",g=null;return r.forEach((a,E)=>{const b=e.find(n=>n.id===a.id);if(b&&b[c]!==null&&b[c]!==void 0&&!b.ignored){const n=x(E),p=h(b[c]);g!==null&&E===g+1?d+=` L ${n} ${p}`:d+=`${d?" ":""}M ${n} ${p}`,g=E}}),d.includes("L")?t.jsx(t.Fragment,{children:l?t.jsx("path",{d,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}):t.jsx($.path,{d,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:.2,ease:"easeInOut"}})}):null},at="#1E40AF",nt="#059669",it="#BE185D",Et="rgba(30, 64, 175, 0.08)",vt="rgba(5, 150, 105, 0.08)",kt="rgba(190, 24, 93, 0.08)",Mt=e=>{if(!e)return"";const[r,x]=e.split("/");return`${parseInt(r,10)}/${parseInt(x,10)}`},et=(e="",r,x,h="–")=>{if(!e)return[h,""];if(e.length<=r)return[e,""];if(x)return[e.slice(0,r),""];const C=e.indexOf(" ",r);return C===-1?[e.slice(0,r),e.slice(r)]:[e.slice(0,C),e.slice(C+1)]},st=(e="",r,x="–")=>e?e.split(/\s+/).slice(0,r).join(" "):x,Ct=({data:e,getX:r,getY:x,isFullScreen:h,orientation:C,responsiveFontSize:c,onPointInteraction:l,clearActivePoint:d,activePoint:g,padding:a,chartHeight:E,chartWidth:b,temperatureField:n="temperature_chart",textRowHeight:p,compact:B=!1,reduceMotion:w=!1})=>{const y={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},k={hidden:{opacity:0,scale:.5},visible:{opacity:1,scale:1,transition:{duration:.5,ease:"easeOut",type:"spring",stiffness:100}}},v=E-a.bottom,W=v+p*1,Y=v+p*2,I=v+p*3,X=v+p*(h?5:4.5),P=v+p*(h?7:6),D=v+p*(h?9:7.5),H=b-a.left-a.right,U=p*(h?2:1.5),F=w?"g":$.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsx("filter",{id:"rowShadow",x:"-10%",y:"-10%",width:"120%",height:"120%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodColor:"rgba(244, 114, 182, 0.15)"})}),t.jsxs("linearGradient",{id:"sensationGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:Et}),t.jsx("stop",{offset:"100%",stopColor:"rgba(30, 64, 175, 0.02)"})]}),t.jsxs("linearGradient",{id:"appearanceGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:vt}),t.jsx("stop",{offset:"100%",stopColor:"rgba(5, 150, 105, 0.02)"})]}),t.jsxs("linearGradient",{id:"observationGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:kt}),t.jsx("stop",{offset:"100%",stopColor:"rgba(190, 24, 93, 0.02)"})]})]}),!B&&t.jsxs("g",{children:[t.jsx("rect",{x:a.left,y:X-U/2,width:H,height:U,fill:"url(#sensationGradient)",rx:6,style:{filter:"url(#rowShadow)"}}),t.jsx("rect",{x:a.left,y:P-U/2,width:H,height:U,fill:"url(#appearanceGradient)",rx:6,style:{filter:"url(#rowShadow)"}}),t.jsx("rect",{x:a.left,y:D-U/2,width:H,height:U,fill:"url(#observationGradient)",rx:6,style:{filter:"url(#rowShadow)"}})]}),(!h||C!=="portrait")&&t.jsx($.g,{variants:y,children:[{label:"Fecha",row:1,color:h?"#374151":"#6B7280"},{label:"Día",row:2,color:h?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:h?"#374151":"#6B7280"},{label:"Sens.",row:h?5:4.5,color:at},{label:"Apar.",row:h?7:6,color:nt},{label:"Observ.",row:h?9:7.5,color:it}].map(({label:o,row:V,color:j})=>t.jsx("text",{x:a.left-c(1.5),y:v+p*V,textAnchor:"end",fontSize:c(.95),fontWeight:"600",fill:j,style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o},o))}),e.map((o,V)=>{const j=r(V),A=o[n]!=null?x(o[n]):v,L=h?"#374151":"#6B7280",_=o[n]!=null,q=_||o.mucus_sensation||o.mucus_appearance||o.fertility_symbol,J=String(o.id||"").startsWith("placeholder-"),K=!q||J?{}:{pointerEvents:"all",style:{cursor:"pointer"},onMouseEnter:O=>l(o,V,O),onClick:O=>l(o,V,O)},s=dt(o.fertility_symbol);let i="transparent";if(s!=null&&s.color){const O=s.color.replace(/^bg-/,"");O==="red-500"?i="#ef4444":O==="white"?i="#ffffff":O==="green-500"?i="#22c55e":O==="pink-300"&&(i="#f9a8d4")}const f=c(h?1.4:1.6),m=o.isoDate?ft(Z(ot(o.isoDate)),Z(new Date)):!1,u=h?4:9,M=2,[R,S]=et(h?st(o.mucus_sensation,M,m?"":"–"):o.mucus_sensation,u,!1,m?"":"–"),[N,G]=et(h?st(o.mucus_appearance,M,m?"":"–"):o.mucus_appearance,u,!1,m?"":"–"),[Q,z]=et(h?st(o.observations,M,""):o.observations,u,!1,"");return t.jsxs(F,{...w?{}:{variants:y},...K,children:[_&&t.jsxs(F,{...w?{}:{variants:k},children:[t.jsx("circle",{cx:j,cy:A,r:8,fill:"rgba(244, 114, 182, 0.15)",opacity:.6}),t.jsx("circle",{cx:j,cy:A,r:5,fill:o.ignored?"white":"url(#tempPointGradient)",stroke:o.use_corrected?"#F59E0B":"#E91E63",strokeWidth:o.ignored?2:2.5,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.3))",cursor:"pointer"},pointerEvents:"all",onMouseEnter:O=>l(o,V,O),onTouchStart:O=>l(o,V,O),onClick:O=>l(o,V,O)}),!o.ignored&&t.jsx("circle",{cx:j,cy:A,r:2,fill:"rgba(255, 255, 255, 0.8)"})]}),t.jsx("defs",{children:t.jsxs("radialGradient",{id:"tempPointGradient",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"70%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]})}),t.jsx("text",{x:j,y:W,textAnchor:"middle",fontSize:c(.95),fontWeight:"600",fill:L,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Mt(o.date)}),t.jsx("text",{x:j,y:Y,textAnchor:"middle",fontSize:c(.9),fontWeight:"500",fill:L,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.cycleDay}),!J&&(s.value!=="none"?t.jsx("rect",{x:j-f/2,y:I-f*.75,width:f,height:f,fill:s.pattern==="spotting-pattern"?"url(#spotting-pattern-chart)":i,stroke:s.value==="white"?"#E91E63":"rgba(233, 30, 99, 0.3)",strokeWidth:s.value==="white"?1.5:1,rx:f*.25,style:{filter:"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.2))"}}):t.jsx("text",{x:j,y:I,textAnchor:"middle",fontSize:c(.9),fill:L,fontWeight:"400",children:"–"})),!B&&t.jsxs("text",{x:j,y:X,textAnchor:"middle",fontSize:c(.85),fontWeight:"600",fill:at,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[t.jsx("tspan",{x:j,dy:0,children:R}),S&&t.jsx("tspan",{x:j,dy:c(1),children:S})]}),!B&&t.jsxs("text",{x:j,y:P,textAnchor:"middle",fontSize:c(.85),fontWeight:"600",fill:nt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[t.jsx("tspan",{x:j,dy:0,children:N}),G&&t.jsx("tspan",{x:j,dy:c(1),children:G})]}),!B&&t.jsxs("text",{x:j,y:D,textAnchor:"middle",fontSize:c(.85),fontWeight:"600",fill:it,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[t.jsx("tspan",{x:j,dy:0,children:Q}),z&&t.jsx("tspan",{x:j,dy:c(1),children:z})]})]},`pt-${V}-${o.isoDate||o.timestamp}`)})]})},Bt=({point:e,position:r,chartWidth:x,chartHeight:h,onToggleIgnore:C,onEdit:c,onClose:l})=>{if(!e)return null;const d=130,g=120;let a=r.clientX+10,E=r.clientY+10;a+d>x&&(a=r.clientX-d-10),E+g>h&&(E=r.clientY-g-10),a<0&&(a=5),E<0&&(E=5);const b=e.temperature_chart,n=dt(e.fertility_symbol),p=e.timestamp||e.isoDate;return t.jsxs($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},className:"absolute bg-white/80 border border-[#E27DBF] text-[#1F2937] p-2 rounded-lg shadow z-50",style:{top:E,left:a,width:d,minHeight:g},children:[t.jsx(tt,{variant:"ghost",size:"icon",onClick:l,className:"absolute top-1 right-1 text-[#E27DBF] hover:bg-[#FFB1DD]",children:t.jsx(xt,{size:16})}),t.jsxs("p",{className:"font-semibold text-sm text-[#E27DBF] mb-1",children:[p?rt(ot(p),"d/M",{locale:pt}):"Fecha",` (Día ${e.cycleDay||"N/A"})`]}),b!=null&&t.jsxs("p",{className:"text-xs mb-1",children:[t.jsx("span",{className:"font-medium",children:"T:"})," ",parseFloat(b).toFixed(2),"°C",e.use_corrected&&t.jsx("span",{className:"inline-block ml-1 align-middle text-[#FF0000]",children:"·"})]}),t.jsxs("div",{className:"flex items-center mb-1",children:[n&&n.value!=="none"&&t.jsx("span",{className:`w-3 h-3 rounded-full mr-1 ${n.color} ${n.pattern?"pattern-bg":""} ${n.value==="white"?"border border-gray-300":""}`}),t.jsx("p",{className:"text-xs",children:n?n.label:"-"})]}),t.jsxs("p",{className:"text-xs mb-1",children:[t.jsx("span",{className:"font-medium",children:"Sens.:"})," ",e.mucus_sensation||"-"]}),t.jsxs("p",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Apar.:"})," ",e.mucus_appearance||"-"]}),e.id&&!String(e.id).startsWith("placeholder-")&&t.jsxs("div",{className:"flex justify-center space-x-1 mt-1",children:[t.jsx(tt,{onClick:()=>{c&&c(e),l&&l()},variant:"outline",size:"icon",className:"text-[#393C65] hover:text-[#E27DBF] hover:bg-[#E27DBF]/10 ",children:t.jsx(bt,{className:"h-4 w-4"})}),t.jsx(tt,{onClick:()=>C(e.id),variant:e.ignored?"outline":"destructive",size:"icon",className:"hover:bg-[#FFB1DD]/20",children:e.ignored?t.jsx(ut,{className:"h-4 w-4"}):t.jsx(mt,{className:"h-4 w-4"})})]})]})},Wt="#1E40AF",At="#059669",Dt="#BE185D",Nt=({padding:e,chartHeight:r,tempMin:x,tempMax:h,tempRange:C,getY:c,responsiveFontSize:l,textRowHeight:d,isFullScreen:g})=>{const a={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},E=[];if(C>0){const n=C<=2.5?.1:.5;for(let p=x;p<=h+1e-9;p+=n)E.push(parseFloat(p.toFixed(1)))}else for(let n=35;n<=37.5+1e-9;n+=.5)E.push(parseFloat(n.toFixed(1)));const b=r-e.bottom;return t.jsxs("svg",{width:e.left,height:r,className:"font-sans pointer-events-none",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"legendBgGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(255, 255, 255, 0.95)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(252, 231, 243, 0.8)"})]}),t.jsx("filter",{id:"legendShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:t.jsx("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodColor:"rgba(244, 114, 182, 0.15)"})})]}),t.jsx("rect",{x:0,y:b+d*.5,width:e.left,height:d*(g?9.5:8),fill:"url(#legendBgGradient)",rx:8,style:{filter:"url(#legendShadow)"}}),E.map((n,p)=>{const B=c(n),w=n.toFixed(1).endsWith(".0")||n.toFixed(1).endsWith(".5"),y=w?n.toFixed(1):`.${n.toFixed(1).split(".")[1]}`;return t.jsx($.text,{variants:a,x:e.left-l(1),y:B+l(.35),textAnchor:"end",fontSize:l(w?1:.9),fontWeight:w?"600":"500",fill:w?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:y},`temp-tick-fixed-${p}`)}),t.jsxs($.g,{variants:a,children:[t.jsx("rect",{x:e.left-l(.3),y:e.top-l(.3),width:l(3),height:l(2.2),rx:l(.4),fill:"rgba(244, 114, 182, 0.12)",stroke:"rgba(244, 114, 182, 0.25)",strokeWidth:1,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.1))"}}),t.jsx("text",{x:e.left+l(1.2),y:e.top+l(1.2),textAnchor:"middle",fontSize:l(1.4),fontWeight:"700",fill:"#E91E63",style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),t.jsx($.g,{variants:a,children:[{label:"Fecha",row:1,color:g?"#374151":"#6B7280"},{label:"Día",row:2,color:g?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:g?"#374151":"#6B7280"},{label:"Sens.",row:g?5:4.5,color:Wt},{label:"Apar.",row:g?7:6,color:At},{label:"Observ.",row:g?9:7.5,color:Dt}].map(({label:n,row:p,color:B})=>t.jsx("text",{x:e.left-l(1.5),y:b+d*p,textAnchor:"end",fontSize:l(.95),fontWeight:"600",fill:B,style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:n},n))})]})},lt=35.5,ct=37.5,Tt=(e,r,x,h,C,c=5,l=!1)=>{const d=T.useRef(null),g=T.useRef(null),[a,E]=T.useState({width:600,height:400}),[b,n]=T.useState(null),[p,B]=T.useState({x:0,y:0}),w=T.useMemo(()=>e.map(s=>({...s,displayTemperature:s.temperature_chart})),[e]);T.useEffect(()=>{const s=()=>{if(!d.current)return;const f=d.current.parentElement||d.current;let m=f.clientWidth||600,u=f.clientHeight||400,M=d.current.clientWidth>0?d.current.clientWidth:m,R,S;if(r){let N=window.innerWidth,G=window.innerHeight;if(l&&G>N&&([N,G]=[G,N]),M=N,x==="portrait"&&!l){const Q=Math.max(30,N*.05);R=(N-Q)/c*e.length}else R=N/c*e.length;S=G}else R=M/c*e.length,S=u;E({width:R,height:S})};s(),window.addEventListener("resize",s);let i;return r&&d.current&&(i=new ResizeObserver(s),i.observe(document.documentElement)),()=>{window.removeEventListener("resize",s),i&&i.disconnect()}},[r,e.length,c,x,l]);const y=T.useMemo(()=>w.filter(s=>s&&s.isoDate&&!s.ignored&&s.displayTemperature!==null&&s.displayTemperature!==void 0),[w]),k=T.useMemo(()=>w.filter(s=>s&&s.isoDate),[w]),{baselineTemp:v,baselineStartIndex:W}=T.useMemo(()=>{const s=i=>i&&i.displayTemperature!=null&&!i.ignored;for(let i=0;i<w.length;i++){const f=w[i];if(!s(f))continue;const m=[];for(let u=i-1;u>=0&&m.length<6;u--){const M=w[u];s(M)&&m.unshift({index:u,temp:M.displayTemperature})}if(!(m.length<6)&&m.every(u=>u.temp<f.displayTemperature)){const u=Math.max(...m.map(R=>R.temp)),M=m.find(R=>R.temp===u).index;return{baselineTemp:u,baselineStartIndex:M}}}return{baselineTemp:null,baselineStartIndex:null}},[w]),{tempMin:Y,tempMax:I}=T.useMemo(()=>{const s=y.map(m=>m.displayTemperature).filter(m=>m!=null);if(s.length===0)return{tempMin:lt,tempMax:ct};let i=Math.min(...s,lt),f=Math.max(...s,ct);if(i=Math.floor(i*2)/2,f=Math.ceil(f*2)/2,f-i<2){const m=(i+f)/2;i=m-1,f=m+1}return{tempMin:i,tempMax:f}},[y]),X=I-Y,P=a.width,D=a.height,H=9,U=(s=1)=>{if(!r)return H*s;const i=Math.min(P,D);return Math.max(8,Math.min(H*s,i/(k.length>0?40/s:40)))},F=U(1.6),o=l||x==="landscape",j=F*(o?9:5),A={top:r?Math.max(o?6:12,D*(o?.015:.03)):12,right:r?Math.max(o?12:30,P*(o?.02:.05)):50,bottom:(r?Math.max(o?24:40,D*(o?.05:.11)):60)+j,left:r?Math.max(o?12:30,P*(o?.02:.05)):50},L=s=>{if(s==null||X===0)return D-A.bottom;const i=D-A.top-A.bottom;return i<=0?D-A.bottom:D-A.bottom-(s-Y)/X*i},_=s=>{const f=r&&!(l||x==="landscape")?25:0,m=P-A.left-A.right-0-f*(k.length-1);if(m<=0)return A.left+0+f*s;const u=k.length>1?k.length-1:1;return u===0||k.length===0?A.left+0+f*s:A.left+0+s*(m/(k.length===1?1:u))+f*s},q=(s,i,f)=>{if(!s||String(s.id).startsWith("placeholder-")){J();return}const m=d.current.getBoundingClientRect();let u,M;if(f.type.startsWith("touch")){const N=f.changedTouches[0];u=N.clientX,M=N.clientY}else u=f.clientX,M=f.clientY;const R=_(i),S=L(s.displayTemperature);B({svgX:R,svgY:S,clientX:u-m.left+d.current.scrollLeft,clientY:M-m.top+d.current.scrollTop}),n(s)};T.useEffect(()=>{const s=i=>{var f;if(g.current&&!g.current.contains(i.target)){const m=(f=d.current)==null?void 0:f.querySelectorAll("circle, text, rect");let u=!1;if(m){for(let M of m)if(M.contains(i.target)){u=!0;break}}u||n(null)}};return b&&(document.addEventListener("mousedown",s),document.addEventListener("touchstart",s)),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[b]);const J=()=>{n(null)};return{chartRef:d,tooltipRef:g,dimensions:a,activePoint:b,tooltipPosition:p,processedData:w,validDataForLine:y,allDataPoints:k,tempMin:Y,tempMax:I,tempRange:X,padding:A,textRowHeight:F,setActivePoint:n,getY:L,getX:_,handlePointInteraction:q,clearActivePoint:J,handleToggleIgnore:s=>{h&&s&&(h(C,s),n(null))},responsiveFontSize:U,baselineTemp:v,baselineStartIndex:W}},_t=({data:e,isFullScreen:r,orientation:x,onToggleIgnore:h,onEdit:C,cycleId:c,initialScrollIndex:l=0,visibleDays:d=5,showInterpretation:g=!1,reduceMotion:a=!1,forceLandscape:E=!1})=>{const{chartRef:b,tooltipRef:n,dimensions:p,activePoint:B,tooltipPosition:w,allDataPoints:y,validDataForLine:k,tempMin:v,tempMax:W,tempRange:Y,padding:I,textRowHeight:X,getY:P,getX:D,handlePointInteraction:H,handleToggleIgnore:U,responsiveFontSize:F,clearActivePoint:o,setActivePoint:V,baselineTemp:j,baselineStartIndex:A}=Tt(e,r,x,h,c,d,E);if(!y||y.length===0)return t.jsxs("div",{className:"text-center p-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-pink-100 to-rose-100 rounded-full mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("p",{className:"text-slate-400 font-medium",children:"No hay datos para mostrar en el gráfico"})]});const L=p.width,_=p.height,q=j!=null?P(j):null,J=j!=null?D(A):null,K={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},s={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1}},[i,f]=T.useState({w:typeof window<"u"?window.innerWidth:0,h:typeof window<"u"?window.innerHeight:0}),m=i.w<i.h;T.useEffect(()=>{const G=()=>f({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",G),window.addEventListener("orientationchange",G),()=>{window.removeEventListener("resize",G),window.removeEventListener("orientationchange",G)}},[]),T.useEffect(()=>{if(!b.current)return;const G=b.current.clientWidth/d;b.current.scrollLeft=Math.max(0,G*l)},[l,d,p.width,x]);const u=!a,M=E&&m,R=M,S="w-full h-full bg-gradient-to-br from-white via-pink-50/30 to-rose-50/20",N=r?`${S} min-h-full ${R?"flex items-stretch justify-start overflow-y-auto overflow-x-hidden":"flex items-center justify-start overflow-x-auto overflow-y-hidden"}`:`${S} overflow-x-auto overflow-y-hidden border border-pink-100/50`;return t.jsxs($.div,{className:"relative w-full h-full",variants:u?K:void 0,initial:u?"hidden":!1,animate:u?"visible":void 0,children:[(!r||x==="portrait")&&t.jsx("div",{className:"absolute left-0 top-0 h-full bg-transparent pointer-events-none z-10",style:{width:I.left},children:t.jsx(Nt,{padding:I,chartHeight:_,tempMin:v,tempMax:W,tempRange:Y,getY:P,responsiveFontSize:F,textRowHeight:X,isFullScreen:r})}),t.jsxs($.div,{ref:b,className:`relative p-0 ${r?"":"rounded-2xl"} ${N}`,style:{boxShadow:r?"inset 0 1px 3px rgba(244, 114, 182, 0.1)":"0 8px 32px rgba(244, 114, 182, 0.12), 0 2px 8px rgba(244, 114, 182, 0.08)",...M?{position:"absolute",top:0,left:0,width:`${i.h}px`,height:`${i.w}px`,transform:"rotate(90deg) translateY(-100%)",transformOrigin:"top left"}:{}},variants:u?s:void 0,children:[t.jsxs($.svg,{width:L,height:_,className:"font-sans flex-shrink-0",viewBox:`0 0 ${L} ${_}`,preserveAspectRatio:"xMidYMid meet",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("linearGradient",{id:"tempAreaGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244,114,182,0.25)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(236,72,153,0.15)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(233,30,99,0.05)"})]}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"8",height:"8",children:[t.jsx("circle",{cx:"2",cy:"2",r:"1.5",fill:"rgba(239,68,68,0.8)"}),t.jsx("circle",{cx:"6",cy:"6",r:"1.5",fill:"rgba(239,68,68,0.6)"})]}),t.jsxs("filter",{id:"chartShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("filter",{id:"baselineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1.5",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx("rect",{width:"100%",height:"100%",fill:"transparent"}),t.jsx(jt,{padding:I,chartWidth:L,chartHeight:_,tempMin:v,tempMax:W,tempRange:Y,getY:P,getX:D,allDataPoints:y,responsiveFontSize:F,isFullScreen:r,showLeftLabels:r&&x==="landscape",reduceMotion:a}),t.jsx(wt,{data:k,allDataPoints:y,getX:D,getY:P,baselineY:_-I.bottom,temperatureField:"displayTemperature",reduceMotion:a}),g&&j!=null&&(a?t.jsx("line",{x1:J,y1:q,x2:L-I.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"}}):t.jsx($.line,{x1:J,y1:q,x2:L-I.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"},initial:{opacity:0,pathLength:0},animate:{opacity:1,pathLength:1},transition:{duration:1,ease:"easeInOut"}})),t.jsx(Ct,{data:y,getX:D,getY:P,isFullScreen:r,orientation:x,responsiveFontSize:F,onPointInteraction:H,clearActivePoint:o,activePoint:B,padding:I,chartHeight:_,chartWidth:L,temperatureField:"displayTemperature",textRowHeight:X,compact:!1,reduceMotion:a})]}),B&&t.jsx($.div,{ref:n,initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},transition:{duration:.2,ease:"easeOut"},children:t.jsx(Bt,{point:B,position:w,chartWidth:L,chartHeight:_,onToggleIgnore:U,onEdit:C,onClose:o})})]})]})};function $t(e,r){if(!e||!r)return[];const x=typeof e=="string"?ot(e):e;return[...Array(r)].map((h,C)=>{const c=yt(x,C),l=rt(c,"yyyy-MM-dd"),d=rt(c,"dd/MM"),g=gt(Z(c),Z(x))+1;return{date:d,isoDate:l,cycleDay:g,temperature:null,mucusSensation:null,mucusAppearance:null,id:`placeholder-${l}`,ignored:!1}})}export{_t as F,Pt as R,$t as g};
