import{r as p,j as e,d as M,e as S,m as c,A as B,B as n,L as v}from"./index-f990749f.js";import{u as O,p as d,f as g,e as j}from"./useCycleData-758a573b.js";import{E as u}from"./EditCycleDatesDialog-c63b5949.js";import{P as w}from"./plus-3bdff0e2.js";import{E as V}from"./eye-8fe6b589.js";import{T as F}from"./trash-2-faaafb17.js";import"./useBackClose-737776a5.js";import"./dialog-4560ab56.js";import"./input-d884c3cd.js";const I=S("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors",{variants:{variant:{default:"bg-primary text-primary-foreground border-transparent",secondary:"bg-secondary text-secondary-foreground border-transparent",destructive:"bg-destructive text-destructive-foreground border-transparent",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),b=p.forwardRef(({className:i,variant:l,...m},x)=>e.jsx("div",{ref:x,className:M(I({variant:l}),i),...m}));b.displayName="Badge";const H=()=>{const{currentCycle:i,archivedCycles:l,isLoading:m,addArchivedCycle:x,updateCycleDates:N,deleteCycle:D}=O(),[f,r]=p.useState(!1),[a,y]=p.useState(null),C=async({startDate:t,endDate:s})=>{try{await x(t,s),r(!1)}catch{}},k=async({startDate:t,endDate:s})=>{if(a)try{await N(a.id,t,s),y(null)}catch{}},A=t=>{window.confirm("¿Eliminar este ciclo?")&&D(t)},h=i.id?[{...i,isCurrent:!0,needsCompletion:!i.endDate},...l]:l;if(m)return e.jsx("div",{className:"text-center text-slate-300 p-8",children:"Cargando ciclos archivados..."});if(!h||h.length===0)return e.jsxs(c.div,{className:"text-center text-slate-400 py-10 flex flex-col items-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx(B,{className:"w-24 h-24 text-slate-500 mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-200 mb-4",children:"No hay ciclos archivados"}),e.jsx("p",{className:"text-lg",children:"Cuando inicies un nuevo ciclo, el anterior aparecerá aquí."}),e.jsxs("div",{className:"flex gap-4 mt-8",children:[e.jsx(n,{asChild:!0,className:"bg-gradient-to-r from-pink-500 to-fuchsia-600 hover:from-pink-600 hover:to-fuchsia-700 text-white",children:e.jsx(v,{to:"/",children:"Volver al Ciclo Actual"})}),e.jsxs(n,{onClick:()=>r(!0),className:"bg-pink-600 hover:bg-pink-700 text-white",children:[e.jsx(w,{className:"mr-2 h-4 w-4"})," Crear Ciclo"]})]}),e.jsx(u,{isOpen:f,onClose:()=>r(!1),onConfirm:C,title:"Añadir Ciclo Anterior",description:"Ingresa las fechas de un ciclo previo para añadir registros."})]});const E=[...h].sort((t,s)=>d(s.startDate)-d(t.startDate));return e.jsxs("div",{className:"w-full max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8",children:[e.jsx(c.h1,{className:"text-3xl sm:text-4xl font-bold text-slate-500 mb-4 sm:mb-0",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:"Mis Ciclos"}),e.jsxs(n,{onClick:()=>r(!0),className:"bg-pink-600 hover:bg-pink-700 text-white",children:[e.jsx(w,{className:"mr-2 h-4 w-4"})," Añadir Ciclo"]})]}),e.jsx(c.ul,{className:"space-y-6",variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:E.map(t=>{const s=t.endDate?g(d(t.endDate),"dd MMM yyyy",{locale:j}):"Sin fecha fin",o=t.data?t.data.length:0;return t.needsCompletion,e.jsx(c.li,{className:"bg-white/70 backdrop-blur-md ring-1 ring-[#FFB1DD]/50 shadow-xl rounded-xl p-6 hover:shadow-2xl transition-shadow duration-300",variants:{hidden:{opacity:0,y:20},show:{opacity:1,y:0}},children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-pink-400 mb-1",children:["Ciclo: ",g(d(t.startDate),"dd MMM yyyy",{locale:j})," - ",s,t.isCurrent&&e.jsx(b,{className:"ml-2 bg-pink-500 text-white",children:"Ciclo actual"})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[o," registro",o!==1?"s":""]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4 sm:mt-0 w-full sm:w-auto",children:[e.jsx(n,{asChild:!0,variant:"outline",className:"w-full sm:w-auto border-pink-500 text-pink-400 hover:bg-pink-500/20 hover:text-pink-300",children:e.jsxs(v,{to:t.isCurrent?"/":`/cycle/${t.id}`,children:[e.jsx(V,{className:"mr-2 h-4 w-4"})," Ver"]})}),e.jsxs(n,{className:"w-full sm:w-auto",variant:"destructive",onClick:()=>A(t.id),children:[e.jsx(F,{className:"mr-2 h-4 w-4"})," Eliminar"]})]})]})},t.id)})}),e.jsx(u,{isOpen:f,onClose:()=>r(!1),onConfirm:C,title:"Añadir Ciclo Anterior",description:"Ingresa las fechas de un ciclo previo para añadir registros."}),e.jsx(u,{isOpen:!!a,onClose:()=>y(null),onConfirm:k,initialStartDate:a==null?void 0:a.startDate,initialEndDate:a==null?void 0:a.endDate,title:"Editar Fechas del Ciclo",description:"Actualiza las fechas del ciclo."})]})};export{H as default};
