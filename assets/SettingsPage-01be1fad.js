import{u as H,b as M,r as t,j as e,m as G,U as J,B as l}from"./index-752021ba.js";import{I as d}from"./input-235c5ced.js";import{L as m}from"./label-0ecf343f.js";import{D as j,a as p,b as f,c as g,d as w,e as b}from"./dialog-9607b487.js";const X=()=>{const{user:s,updateEmail:z,updatePassword:A,login:q,logout:F}=H(),{toast:r}=M(),[O,i]=t.useState(!1),[I,n]=t.useState(!1),[v,y]=t.useState((s==null?void 0:s.email)||""),[u,C]=t.useState(!1),[N,S]=t.useState(""),[x,D]=t.useState(""),[k,L]=t.useState(""),[h,P]=t.useState(!1),[o,E]=t.useState(!1),[B,c]=t.useState(!1),R=async a=>{a.preventDefault(),C(!0);try{await z(v),r({title:"Correo actualizado"}),i(!1)}finally{C(!1)}},T=async a=>{if(a.preventDefault(),x!==k){r({title:"Error",description:"Las contraseñas no coinciden",variant:"destructive"});return}P(!0);try{await q(s==null?void 0:s.email,N),await A(x),r({title:"Contraseña actualizada"}),n(!1),S(""),D(""),L("")}finally{P(!1)}},U=async()=>{E(!0);try{await F(),r({title:"Sesión cerrada"})}catch(a){console.error("Error al cerrar sesión",a)}finally{E(!1),c(!1)}};return e.jsxs("div",{className:"min-h-[calc(100dvh-var(--bottom-nav-safe))] bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100 relative overflow-hidden flex flex-col",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0",style:{background:"radial-gradient(65% 55% at 50% 32%, rgba(244,114,182,0.18) 0%, rgba(244,114,182,0.12) 35%, rgba(244,114,182,0.06) 60%, rgba(244,114,182,0) 100%)"}}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6 relative z-10 flex flex-col flex-1 min-h-full box-border",children:[e.jsx(G.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("h1",{className:"text-3xl font-bold text-slate-700 flex items-center",children:[e.jsx(J,{className:"mr-2 h-8 w-8 text-pink-500"}),"Mi cuenta"]})}),e.jsxs("div",{className:"mt-6 flex flex-1 flex-col gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white/80 backdrop-blur p-4 rounded-xl shadow flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Correo"}),e.jsx("p",{className:"font-medium text-slate-700 break-all",children:s==null?void 0:s.email})]}),e.jsx(l,{onClick:()=>{y((s==null?void 0:s.email)||""),i(!0)},className:"ml-4",children:"Actualizar email"})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur p-4 rounded-xl shadow flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Contraseña"}),e.jsx("p",{className:"font-medium text-slate-700",children:"********"})]}),e.jsx(l,{onClick:()=>n(!0),className:"ml-4",children:"Actualizar contraseña"})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur p-4 rounded-xl shadow flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Sesión"}),e.jsx("p",{className:"font-medium text-slate-700",children:"Cerrar sesión de tu cuenta actual"})]}),e.jsx(l,{variant:"destructive",onClick:()=>c(!0),className:"ml-4",disabled:o,children:"Cerrar sesión"})]})]})]}),e.jsx(j,{open:O,onOpenChange:i,children:e.jsx(p,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs(f,{children:[e.jsx(g,{children:"Actualizar correo"}),e.jsx(w,{children:"Introduce el nuevo correo electrónico."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",children:"Correo"}),e.jsx(d,{id:"email",type:"email",required:!0,value:v,onChange:a=>y(a.target.value)})]}),e.jsxs(b,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>i(!1),disabled:u,children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:u,children:u?"Actualizando...":"Actualizar"})]})]})})}),e.jsx(j,{open:I,onOpenChange:n,children:e.jsx(p,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs(f,{children:[e.jsx(g,{children:"Actualizar contraseña"}),e.jsx(w,{children:"Cambia tu contraseña."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"current-password",children:"Contraseña actual"}),e.jsx(d,{id:"current-password",type:"password",required:!0,value:N,onChange:a=>S(a.target.value)}),e.jsx(m,{htmlFor:"new-password",children:"Nueva contraseña"}),e.jsx(d,{id:"new-password",type:"password",required:!0,minLength:6,value:x,onChange:a=>D(a.target.value)}),e.jsx(m,{htmlFor:"confirm-password",children:"Repite la contraseña"}),e.jsx(d,{id:"confirm-password",type:"password",required:!0,minLength:6,value:k,onChange:a=>L(a.target.value)})]}),e.jsxs(b,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:h,children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:h,children:h?"Actualizando...":"Actualizar"})]})]})})}),e.jsx(j,{open:B,onOpenChange:c,children:e.jsxs(p,{className:"sm:max-w-md",children:[e.jsxs(f,{children:[e.jsx(g,{children:"¿Cerrar sesión?"}),e.jsx(w,{children:"Confirma que deseas salir de tu cuenta actual."})]}),e.jsxs(b,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>c(!1),disabled:o,children:"Cancelar"}),e.jsx(l,{variant:"destructive",onClick:U,disabled:o,children:o?"Cerrando...":"Cerrar sesión"})]})]})})]})};export{X as default};
