import{b as v,r as c,j as e,B as E}from"./index-71f9831f.js";import{R as N,D as S}from"./DeletionDialog-3cd8d0d3.js";import{P as C,D as R}from"./DataEntryForm-bc4dcd91.js";import{u as b,f as P,p as k}from"./useCycleData-a0f29ea7.js";import{D as B,a as O}from"./dialog-36bf1cb8.js";import{u as F}from"./useBackClose-b856fdfe.js";import"./fertilitySymbols-d4cb4f69.js";import"./select-7a2ab852.js";import"./pen-line-e19a7d86.js";import"./trash-2-b54579c4.js";import"./input-94be8fdf.js";import"./label-9b8fb7c8.js";import"./eye-e05aaaa7.js";import"./eye-off-0d1eb0d4.js";const W=()=>{const{currentCycle:a,addOrUpdateDataPoint:f,deleteRecord:x,isLoading:h}=b(),{toast:m}=v(),[u,s]=c.useState(!1),[i,r]=c.useState(null),[o,d]=c.useState(null),[n,l]=c.useState(!1);F(u||!!i,()=>{s(!1),r(null)});const g=t=>{r(t),s(!0)},D=t=>{const p=a.data.find(j=>j.id===t);d(p)},y=async t=>{l(!0);try{await f(t,i),s(!1),r(null)}catch{m({title:"Error",description:"No se pudo guardar el registro",variant:"destructive"})}finally{l(!1)}},w=async()=>{if(o){l(!0);try{await x(o.id),d(null)}catch{m({title:"Error",description:"No se pudo eliminar el registro",variant:"destructive"})}finally{l(!1)}}};return h?e.jsx("p",{className:"text-center text-gray-500",children:"Cargando..."}):a!=null&&a.id?e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx("div",{className:"my-4",children:e.jsxs(E,{onClick:()=>{r(null),s(!0)},className:"w-full sm:w-auto bg-gradient-to-r from-pink-500 to-fuchsia-600 hover:from-pink-600 hover:to-fuchsia-700 text-white",disabled:n,children:[e.jsx(C,{className:"mr-2 h-4 w-4"})," AÃ±adir registro"]})}),e.jsx(N,{records:a.data,onEdit:g,onDelete:D,isProcessing:n}),e.jsx(B,{open:u,onOpenChange:t=>{s(t),t||r(null)},children:e.jsx(O,{hideClose:!0,className:"bg-white border-pink-100 text-gray-800 w-[90vw] sm:w-auto max-w-md sm:max-w-lg md:max-w-xl max-h-[85vh] overflow-y-auto p-4 sm:p-6 rounded-2xl",children:e.jsx(R,{onSubmit:y,onCancel:()=>{s(!1),r(null)},initialData:i,cycleStartDate:a.startDate,cycleEndDate:a.endDate,isProcessing:n,isEditing:!!i})})}),e.jsx(S,{isOpen:!!o,onClose:()=>d(null),onConfirm:w,recordDate:o?P(k(o.isoDate),"dd/MM/yyyy"):"",isProcessing:n})]}):e.jsx("p",{className:"text-center text-gray-500",children:"No hay ciclo activo."})};export{W as default};
