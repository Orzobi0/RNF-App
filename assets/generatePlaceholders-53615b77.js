import{c as ct,m as I,j as t,r as v}from"./index-f990749f.js";import{g as dt,i as ht}from"./fertilitySymbols-c96635e4.js";import{s as Z,p as at,a as ft,f as ot,d as xt}from"./useCycleData-758a573b.js";import{C as pt}from"./ChartTooltip-c53a692f.js";const Rt=ct("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),yt=({padding:e,chartWidth:i,chartHeight:p,tempMin:x,tempMax:L,tempRange:f,getY:r,getX:n,allDataPoints:b=[],responsiveFontSize:c,isFullScreen:M,showLeftLabels:w=!0,reduceMotion:d=!1})=>{const y={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},E=[];if(f>0){const m=f<=2.5?.1:.5;for(let k=x;k<=L+1e-9;k+=m)E.push(parseFloat(k.toFixed(1)))}else for(let m=35;m<=37.5+1e-9;m+=.5)E.push(parseFloat(m.toFixed(1)));const g=d?"g":I.g;return t.jsxs(t.Fragment,{children:[w&&t.jsxs(g,{...d?{}:{variants:y},children:[t.jsx("rect",{x:e.left-c(.4),y:e.top-c(.4),width:c(3.2),height:c(2.4),rx:c(.6),fill:"rgba(244, 114, 182, 0.15)",stroke:"rgba(244, 114, 182, 0.3)",strokeWidth:1.5,style:{filter:"drop-shadow(0 4px 8px rgba(244, 114, 182, 0.2))",backdropFilter:"blur(10px)"}}),t.jsx("text",{x:e.left+c(1.2),y:e.top+c(1.3),textAnchor:"middle",fontSize:c(1.4),fontWeight:"800",fill:"#E91E63",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"bgGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(254, 242, 242, 0.95)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(255, 241, 242, 0.9)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(255, 245, 255, 0.95)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(254, 242, 242, 0.8)"})]}),t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("filter",{id:"chartGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("filter",{id:"textShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"rgba(255, 255, 255, 0.8)"})}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:[t.jsx("rect",{width:"6",height:"6",fill:"#f3f4f6"}),t.jsx("circle",{cx:"3",cy:"3",r:"1.5",fill:"rgba(239,68,68,0.7)"})]})]}),t.jsx("rect",{x:e.left,y:e.top,width:i-e.left-e.right,height:p-e.top-e.bottom,fill:"url(#bgGradientChart)",opacity:2,rx:12,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.1))"}}),E.map((m,k)=>{const C=r(m),G=m.toFixed(1).endsWith(".0")||m.toFixed(1).endsWith(".5"),$=G?m.toFixed(1):`.${m.toFixed(1).split(".")[1]}`;return t.jsxs(g,{...d?{}:{variants:y},children:[t.jsx("line",{x1:e.left,y1:C,x2:i-e.right,y2:C,stroke:G?"rgba(244, 114, 182, 0.3)":"rgba(244, 114, 182, 0.15)",strokeWidth:G?2:1,strokeDasharray:G?"0":"4,4",style:{filter:G?"drop-shadow(0 1px 3px rgba(244, 114, 182, 0.15))":"none",opacity:G?1:.7}}),w&&t.jsx("text",{x:e.left-c(1),y:C+c(.35),textAnchor:"end",fontSize:c(G?1.1:1),fontWeight:G?"700":"600",fill:G?"#E91E63":"#EC4899",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:$}),t.jsx("text",{x:i-e.right+c(1),y:C+c(.35),textAnchor:"start",fontSize:c(G?1.1:1),fontWeight:G?"700":"600",fill:G?"#E91E63":"#EC4899",style:{filter:"url(#textShadow)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:$})]},`temp-tick-${k}`)}),b.map((m,k)=>{const C=n(k);return t.jsx("line",{x1:C,y1:e.top,x2:C,y2:p-e.bottom,stroke:"rgba(244, 114, 182, 0.08)",strokeWidth:.8,style:{filter:"drop-shadow(0 0 1px rgba(244, 114, 182, 0.05))"}},`day-grid-${k}`)}),t.jsx("rect",{x:e.left,y:e.top,width:i-e.left-e.right,height:p-e.top-e.bottom,fill:"none",stroke:"rgba(244, 114, 182, 0.4)",strokeWidth:2,rx:12,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.15))",strokeDasharray:"0"}})]})},ut=({data:e,allDataPoints:i,getX:p,getY:x,baselineY:L,temperatureField:f="temperature",reduceMotion:r=!1})=>{if(!e||e.length<2)return null;let n="",b=null;return i.forEach((c,M)=>{const w=e.find(d=>d.id===c.id);if(w&&w[f]!==null&&w[f]!==void 0&&!w.ignored){const d=p(M),y=x(w[f]);b!==null&&M===b+1?n+=` L ${d} ${y}`:n+=`${n?" ":""}M ${d} ${y}`,b=M}}),n.includes("L")?t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"30%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"70%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),t.jsxs("linearGradient",{id:"tempLineGradientChartGlow",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244, 114, 182, 0.6)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(236, 72, 153, 0.7)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(233, 30, 99, 0.8)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(194, 24, 91, 0.6)"})]}),t.jsxs("filter",{id:"lineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("filter",{id:"lineShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodColor:"rgba(244, 114, 182, 0.4)"})})]}),r?t.jsx("path",{d:n,fill:"none",stroke:"url(#tempLineGradientChartGlow)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:.4,style:{filter:"url(#lineGlow)"}}):t.jsx(I.path,{d:n,fill:"none",stroke:"url(#tempLineGradientChartGlow)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:.4,style:{filter:"url(#lineGlow)"},initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.4},transition:{duration:.8,ease:"easeInOut",delay:.2}}),r?t.jsx("path",{d:n,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#lineShadow)"}}):t.jsx(I.path,{d:n,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#lineShadow)"},initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:1,ease:"easeInOut",delay:.4}}),r?t.jsx("path",{d:n,fill:"none",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8}):t.jsx(I.path,{d:n,fill:"none",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8,initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.8},transition:{duration:1.2,ease:"easeInOut",delay:.6}})]}):null},st="#1565C0",rt="#2E7D32",it="#6A1B9A",gt="#EFF6FF",mt="#EEF2FF",jt="#ECFDF5",wt="#F0FDFA",bt="#F5F3FF",Ct="#FAF5FF",Et=e=>{if(!e)return"";const[i,p]=e.split("/");return`${parseInt(i,10)}/${parseInt(p,10)}`},tt=(e="",i,p,x="–")=>{if(!e)return[x,""];if(e.length<=i)return[e,""];if(p)return[e.slice(0,i),""];const L=e.indexOf(" ",i);return L===-1?[e.slice(0,i),e.slice(i)]:[e.slice(0,L),e.slice(L+1)]},et=(e="",i,p="–")=>e?e.split(/\s+/).slice(0,i).join(" "):p,kt=({data:e,getX:i,getY:p,isFullScreen:x,orientation:L,responsiveFontSize:f,onPointInteraction:r,clearActivePoint:n,activePoint:b,padding:c,chartHeight:M,chartWidth:w,temperatureField:d="temperature_chart",textRowHeight:y,compact:E=!1,reduceMotion:g=!1})=>{const m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},k={hidden:{opacity:0,scale:.3},visible:{opacity:1,scale:1,transition:{duration:.6,ease:[.34,1.56,.64,1],type:"spring",stiffness:120,damping:12}}},C=M-c.bottom,G=C+y*1,$=C+y*2,R=C+y*3,U=C+y*(x?5:4.5),_=C+y*(x?7:6),W=C+y*(x?9:7.5),X=w-c.left-c.right,Y=y*(x?2:1.5),V=g?"g":I.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsx("filter",{id:"rowShadowChart",x:"-10%",y:"-10%",width:"120%",height:"120%",children:t.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"4",floodColor:"rgba(244, 114, 182, 0.2)"})}),t.jsxs("filter",{id:"pointGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("linearGradient",{id:"sensationGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:gt}),t.jsx("stop",{offset:"100%",stopColor:mt})]}),t.jsxs("linearGradient",{id:"appearanceGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:jt}),t.jsx("stop",{offset:"100%",stopColor:wt})]}),t.jsxs("linearGradient",{id:"observationGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:bt}),t.jsx("stop",{offset:"100%",stopColor:Ct})]}),t.jsxs("radialGradient",{id:"tempPointGradientChart",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#FCE7F3"}),t.jsx("stop",{offset:"40%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"80%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]}),t.jsxs("radialGradient",{id:"tempPointIgnoredGradient",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#FFFFFF"}),t.jsx("stop",{offset:"80%",stopColor:"#F8FAFC"}),t.jsx("stop",{offset:"100%",stopColor:"#E2E8F0"})]})]}),!E&&t.jsxs("g",{children:[t.jsx("rect",{x:c.left,y:U-Y/2,width:X,height:Y,fill:"url(#sensationGradientChart)",rx:8,style:{filter:"url(#rowShadowChart)"}}),t.jsx("rect",{x:c.left,y:_-Y/2,width:X,height:Y,fill:"url(#appearanceGradientChart)",rx:8,style:{filter:"url(#rowShadowChart)"}}),t.jsx("rect",{x:c.left,y:W-Y/2,width:X,height:Y,fill:"url(#observationGradientChart)",rx:8,style:{filter:"url(#rowShadowChart)"}})]}),x&&L!=="portrait"&&t.jsx(I.g,{variants:m,children:[{label:"Fecha",row:1,color:x?"#374151":"#6B7280"},{label:"Día",row:2,color:x?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:x?"#374151":"#6B7280"},{label:"Sens.",row:x?5:4.5,color:st},{label:"Apar.",row:x?7:6,color:rt},{label:"Observ.",row:x?9:7.5,color:it}].map(({label:s,row:F,color:u})=>t.jsx("text",{x:c.left-f(.5),y:C+y*F,textAnchor:"end",fontSize:f(1.05),fontWeight:"700",fill:u,style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:s},s))}),e.map((s,F)=>{const u=i(F),A=s[d]!=null?p(s[d]):C,D=x?"#374151":"#6B7280",P=s[d]!=null,q=P||s.mucus_sensation||s.mucus_appearance||s.fertility_symbol,H=String(s.id||"").startsWith("placeholder-"),K=!q||H?{}:{pointerEvents:"all",style:{cursor:"pointer"},onMouseEnter:N=>r(s,F,N),onClick:N=>r(s,F,N)},o=dt(s.fertility_symbol);let l="transparent";if(o!=null&&o.color){const N=o.color.replace(/^bg-/,"");N==="red-500"?l="#ef4444":N==="white"?l="#ffffff":N==="green-500"?l="#22c55e":N==="pink-300"&&(l="#f9a8d4")}const a=f(x?1.8:2),h=s.isoDate?ht(Z(at(s.isoDate)),Z(new Date)):!1,j=x?4:9,B=2,[O,T]=tt(x?et(s.mucus_sensation,B,h?"":"–"):s.mucus_sensation,j,!1,h?"":"–"),[S,J]=tt(x?et(s.mucus_appearance,B,h?"":"–"):s.mucus_appearance,j,!1,h?"":"–"),[Q,z]=tt(x?et(s.observations,B,""):s.observations,j,!1,"");return t.jsxs(V,{...g?{}:{variants:m},...K,children:[P&&t.jsxs(V,{...g?{}:{variants:k},children:[t.jsx("circle",{cx:u,cy:A,r:1.5,fill:"rgba(244, 114, 182, 0.2)",opacity:.8,style:{filter:"url(#pointGlow)"}}),t.jsx("circle",{cx:u,cy:A,r:3.5,fill:"none",stroke:s.ignored?"rgba(148, 163, 184, 0.4)":"rgba(244, 114, 182, 0.3)",strokeWidth:1.5,opacity:.6}),t.jsx("circle",{cx:u,cy:A,r:4,fill:s.ignored?"url(#tempPointIgnoredGradient)":"url(#tempPointGradientChart)",stroke:s.use_corrected?"#F59E0B":s.ignored?"#94A3B8":"#E91E63",strokeWidth:s.ignored?2:3,style:{filter:"drop-shadow(0 3px 6px rgba(244, 114, 182, 0.4))",cursor:"pointer"},pointerEvents:"all",onMouseEnter:N=>r(s,F,N),onTouchStart:N=>r(s,F,N),onClick:N=>r(s,F,N)}),!s.ignored&&t.jsx("circle",{cx:u,cy:A,r:1.5,fill:"rgba(255, 255, 255, 0.9)",style:{filter:"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.3))"}}),s.use_corrected&&t.jsx("circle",{cx:u+8,cy:A-8,r:3,fill:"#F59E0B",style:{filter:"drop-shadow(0 2px 4px rgba(245, 158, 11, 0.4))"}})]}),t.jsx("text",{x:u,y:G,textAnchor:"middle",fontSize:f(1.05),fontWeight:"700",fill:D,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:Et(s.date)}),t.jsx("text",{x:u,y:$,textAnchor:"middle",fontSize:f(1),fontWeight:"700",fill:D,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:s.cycleDay}),!H&&(o.value!=="none"?t.jsxs("g",{children:[t.jsx("rect",{x:u-a/2+1,y:R-a*.75+1,width:a,height:a,fill:"rgba(0, 0, 0, 0.1)",rx:a*.3,opacity:.5}),t.jsx("rect",{x:u-a/2-4,y:R-a*.75,width:a*1.4,height:a,fill:o.pattern==="spotting-pattern"?"url(#spotting-pattern-chart)":l,stroke:o.value==="white"?"#CBD5E1":"rgba(233, 30, 99, 0.4)",strokeWidth:o.value==="white"?2:1,rx:a*.2,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.25))"}})]}):t.jsx("text",{x:u,y:R,textAnchor:"middle",fontSize:f(1),fill:D,fontWeight:"500",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))"},children:"–"})),!E&&t.jsxs("text",{x:u,y:U,textAnchor:"middle",fontSize:f(.9),fontWeight:"700",fill:st,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:u,dy:0,children:O}),T&&t.jsx("tspan",{x:u,dy:f(1.1),children:T})]}),!E&&t.jsxs("text",{x:u,y:_,textAnchor:"middle",fontSize:f(.9),fontWeight:"700",fill:rt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:u,dy:0,children:S}),J&&t.jsx("tspan",{x:u,dy:f(1.1),children:J})]}),!E&&t.jsxs("text",{x:u,y:W,textAnchor:"middle",fontSize:f(.9),fontWeight:"700",fill:it,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.9))"},children:[t.jsx("tspan",{x:u,dy:0,children:Q}),z&&t.jsx("tspan",{x:u,dy:f(1.1),children:z})]})]},`pt-${F}-${s.isoDate||s.timestamp}`)})]})},Bt="#1565C0",Gt="#2E7D32",At="#6A1B9A",Lt=({padding:e,chartHeight:i,tempMin:p,tempMax:x,tempRange:L,getY:f,responsiveFontSize:r,textRowHeight:n,isFullScreen:b})=>{const c={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},M=[];if(L>0){const d=L<=2.5?.1:.5;for(let y=p;y<=x+1e-9;y+=d)M.push(parseFloat(y.toFixed(1)))}else for(let d=35;d<=37.5+1e-9;d+=.5)M.push(parseFloat(d.toFixed(1)));const w=i-e.bottom;return t.jsxs("svg",{width:e.left,height:i,className:"font-sans pointer-events-none",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"legendBgGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(254, 242, 242, 0.98)"}),t.jsx("stop",{offset:"30%",stopColor:"rgba(255, 241, 242, 0.95)"}),t.jsx("stop",{offset:"70%",stopColor:"rgba(255, 255, 255, 0.98)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(254, 242, 242, 0.9)"})]}),t.jsxs("linearGradient",{id:"legendAccentGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsx("filter",{id:"legendShadowChart",x:"-20%",y:"-20%",width:"140%",height:"140%",children:t.jsx("feDropShadow",{dx:"0",dy:"3",stdDeviation:"4",floodColor:"rgba(244, 114, 182, 0.2)"})}),t.jsx("filter",{id:"textShadowLegend",x:"-50%",y:"-50%",width:"200%",height:"200%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"rgba(255, 255, 255, 0.9)"})})]}),t.jsx("rect",{x:0,y:w+n*.5,width:e.left,height:n*(b?9.5:8),fill:"url(#legendBgGradientChart)",rx:12,style:{filter:"url(#legendShadowChart)"}}),t.jsx("rect",{x:e.left-4,y:w+n*.5,width:1,height:n*(b?9.5:8),fill:"url(#legendAccentGradient)",rx:1.5,opacity:2}),M.map((d,y)=>{const E=f(d),g=d.toFixed(1).endsWith(".0")||d.toFixed(1).endsWith(".5"),m=g?d.toFixed(1):`.${d.toFixed(1).split(".")[1]}`;return t.jsxs(I.g,{variants:c,children:[g&&t.jsx("circle",{cx:e.left-r(2.5),cy:E,r:2,fill:"#E91E63",opacity:.7,style:{filter:"drop-shadow(0 1px 2px rgba(233, 30, 99, 0.4))"}}),t.jsx("text",{x:e.left-r(1.2),y:E+r(.35),textAnchor:"end",fontSize:r(g?1.15:1),fontWeight:g?"800":"700",fill:g?"#E91E63":"#EC4899",style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:m})]},`temp-tick-fixed-${y}`)}),t.jsxs(I.g,{variants:c,children:[t.jsx("rect",{x:e.left-r(.4),y:e.top-r(.4),width:r(3.4),height:r(2.6),rx:r(.8),fill:"rgba(244, 114, 182, 0.18)",stroke:"rgba(244, 114, 182, 0.35)",strokeWidth:1.5,style:{filter:"drop-shadow(0 4px 12px rgba(244, 114, 182, 0.2))",backdropFilter:"blur(12px)"}}),t.jsx("rect",{x:e.left-r(.2),y:e.top-r(.2),width:r(3),height:r(.3),rx:r(.15),fill:"url(#legendAccentGradient)",opacity:.8}),t.jsx("text",{x:e.left+r(1.3),y:e.top+r(1.4),textAnchor:"middle",fontSize:r(1.5),fontWeight:"900",fill:"#E91E63",style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),t.jsx(I.g,{variants:c,children:[{label:"Fecha",row:1,color:b?"#374151":"#6B7280",icon:null},{label:"Día",row:2,color:b?"#374151":"#6B7280",icon:null},{label:"Símbolo",row:3,color:b?"#374151":"#6B7280",icon:null},{label:"Sens.",row:b?5:4.5,color:Bt,icon:"◊"},{label:"Apar.",row:b?7:6,color:Gt,icon:"○"},{label:"Observ.",row:b?9:7.5,color:At,icon:"✦"}].map(({label:d,row:y,color:E,icon:g})=>t.jsxs("g",{children:[g&&t.jsx("text",{x:e.left-r(2.8),y:w+n*y,textAnchor:"middle",fontSize:r(.8),fontWeight:"600",fill:E,opacity:.7,style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:g}),t.jsx("text",{x:e.left-r(.8),y:w+n*y,textAnchor:"end",fontSize:r(1.05),fontWeight:"800",fill:E,style:{filter:"url(#textShadowLegend)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:d})]},d))})]})},lt=35.5,nt=37.5,Mt=(e,i,p,x,L,f=5,r=!1)=>{const n=v.useRef(null),b=v.useRef(null),[c,M]=v.useState({width:0,height:0}),[w,d]=v.useState(null),[y,E]=v.useState({x:0,y:0}),g=v.useMemo(()=>e.map(o=>({...o,displayTemperature:o.temperature_chart})),[e]);v.useLayoutEffect(()=>{const o=()=>{if(!n.current)return;const a=n.current.parentElement||n.current;let h=a.clientWidth||600,j=a.clientHeight||400,B=n.current.clientWidth>0?n.current.clientWidth:h,O,T;if(i){let S=window.innerWidth,J=window.innerHeight;if(r&&J>S&&([S,J]=[J,S]),B=S,p==="portrait"&&!r){const Q=Math.max(30,S*.05);O=(S-Q)/f*e.length}else O=S/f*e.length;T=J}else O=B/f*e.length,T=j;M({width:O,height:T})};o(),window.addEventListener("resize",o);let l;if(n.current){const a=n.current.parentElement||n.current;l=new ResizeObserver(o),l.observe(a)}return()=>{window.removeEventListener("resize",o),l&&l.disconnect()}},[i,e.length,f,p,r]);const m=v.useMemo(()=>g.filter(o=>o&&o.isoDate&&!o.ignored&&o.displayTemperature!==null&&o.displayTemperature!==void 0),[g]),k=v.useMemo(()=>g.filter(o=>o&&o.isoDate),[g]),{baselineTemp:C,baselineStartIndex:G}=v.useMemo(()=>{const o=l=>l&&l.displayTemperature!=null&&!l.ignored;for(let l=0;l<g.length;l++){const a=g[l];if(!o(a))continue;const h=[];for(let j=l-1;j>=0&&h.length<6;j--){const B=g[j];o(B)&&h.unshift({index:j,temp:B.displayTemperature})}if(!(h.length<6)&&h.every(j=>j.temp<a.displayTemperature)){const j=Math.max(...h.map(O=>O.temp)),B=h.find(O=>O.temp===j).index;return{baselineTemp:j,baselineStartIndex:B}}}return{baselineTemp:null,baselineStartIndex:null}},[g]),{tempMin:$,tempMax:R}=v.useMemo(()=>{const o=m.map(h=>h.displayTemperature).filter(h=>h!=null);if(o.length===0)return{tempMin:lt,tempMax:nt};let l=Math.min(...o,lt),a=Math.max(...o,nt);if(l=Math.floor(l*2)/2,a=Math.ceil(a*2)/2,a-l<2){const h=(l+a)/2;l=h-1,a=h+1}return{tempMin:l,tempMax:a}},[m]),U=R-$,_=c.width,W=c.height,X=9,Y=(o=1)=>{if(!i)return X*o;const l=Math.min(_,W);return Math.max(8,Math.min(X*o,l/(k.length>0?40/o:40)))},V=Y(i?1.6:2.5),s=r||p==="landscape",u=V*(s?9:5),A={top:i?Math.max(s?6:12,W*(s?.015:.03)):12,right:i?Math.max(s?35:30,_*(s?.02:.05)):50,bottom:(i?Math.max(s?0:40,W*(s?0:.11)):60)+u+25,left:i?Math.max(s?45:20,_*(s?.02:.05)):50},D=o=>{if(o==null||U===0)return W-A.bottom;const l=W-A.top-A.bottom;return l<=0?W-A.bottom:W-A.bottom-(o-$)/U*l},P=o=>{const l=i&&!(r||p==="landscape")?5:10,a=i&&!(r||p==="landscape")?25:0,h=_-A.left-A.right-l-a*(k.length-1);if(h<=0)return A.left+l+a*o;const j=k.length>1?k.length-1:1;return j===0||k.length===0?A.left+l+a*o:A.left+l+o*(h/(k.length===1?1:j))+a*o},q=(o,l,a)=>{if(!o||String(o.id).startsWith("placeholder-")){H();return}const h=n.current.getBoundingClientRect();let j,B;if(a.type.startsWith("touch")){const S=a.changedTouches[0];j=S.clientX,B=S.clientY}else j=a.clientX,B=a.clientY;const O=P(l),T=D(o.displayTemperature);E({svgX:O,svgY:T,clientX:j-h.left+n.current.scrollLeft,clientY:B-h.top+n.current.scrollTop}),d(o)};v.useEffect(()=>{const o=l=>{var a;if(b.current&&!b.current.contains(l.target)){const h=(a=n.current)==null?void 0:a.querySelectorAll("circle, text, rect");let j=!1;if(h){for(let B of h)if(B.contains(l.target)){j=!0;break}}j||d(null)}};return w&&(document.addEventListener("mousedown",o),document.addEventListener("touchstart",o)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("touchstart",o)}},[w]);const H=()=>{d(null)};return{chartRef:n,tooltipRef:b,dimensions:c,activePoint:w,tooltipPosition:y,processedData:g,validDataForLine:m,allDataPoints:k,tempMin:$,tempMax:R,tempRange:U,padding:A,textRowHeight:V,setActivePoint:d,getY:D,getX:P,handlePointInteraction:q,clearActivePoint:H,handleToggleIgnore:o=>{x&&o&&(x(L,o),d(null))},responsiveFontSize:Y,baselineTemp:C,baselineStartIndex:G}},Ot=({data:e,isFullScreen:i,orientation:p,onToggleIgnore:x,onEdit:L,cycleId:f,initialScrollIndex:r=0,visibleDays:n=5,showInterpretation:b=!1,reduceMotion:c=!1,forceLandscape:M=!1})=>{const{chartRef:w,tooltipRef:d,dimensions:y,activePoint:E,tooltipPosition:g,allDataPoints:m,validDataForLine:k,tempMin:C,tempMax:G,tempRange:$,padding:R,textRowHeight:U,getY:_,getX:W,handlePointInteraction:X,handleToggleIgnore:Y,responsiveFontSize:V,clearActivePoint:s,setActivePoint:F,baselineTemp:u,baselineStartIndex:A}=Mt(e,i,p,x,f,n,M);if(!m||m.length===0)return t.jsxs("div",{className:"text-center p-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-pink-100 to-rose-100 rounded-full mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("p",{className:"text-slate-400 font-medium",children:"No hay datos para mostrar en el gráfico"})]});const D=y.width,P=y.height,q=u!=null?_(u):null,H=u!=null?W(A):null,K=D===0,[o,l]=v.useState({w:typeof window<"u"?window.innerWidth:0,h:typeof window<"u"?window.innerHeight:0}),a=o.w<o.h;v.useEffect(()=>{const T=()=>l({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",T),window.addEventListener("orientationchange",T),()=>{window.removeEventListener("resize",T),window.removeEventListener("orientationchange",T)}},[]),v.useEffect(()=>{if(!w.current)return;const T=w.current.clientWidth/n;w.current.scrollLeft=Math.max(0,T*r)},[r,n,y.width,p]);const h=M&&a,j=h,B="w-full h-full bg-gradient-to-br from-rose-100 via-pink-100 to-rose-100",O=i?`${B} min-h-full ${j?"flex items-stretch justify-start overflow-y-auto overflow-x-hidden":"flex items-center justify-start overflow-x-auto overflow-y-hidden"}`:`${B} overflow-x-auto overflow-y-hidden border border-pink-100/50`;return t.jsxs(I.div,{className:"relative w-full h-full",initial:!1,children:[(!i||p==="portrait")&&t.jsx("div",{className:"absolute left-0 top-0 h-full bg-transparent pointer-events-none z-10",style:{width:R.left},children:t.jsx(Lt,{padding:R,chartHeight:P,tempMin:C,tempMax:G,tempRange:$,getY:_,responsiveFontSize:V,textRowHeight:U,isFullScreen:i})}),t.jsxs(I.div,{ref:w,className:`relative p-0 ${i?"":"rounded-2xl"} ${O}`,style:{boxShadow:i?"inset 0 1px 3px rgba(244, 114, 182, 0.1)":"0 8px 32px rgba(244, 114, 182, 0.12), 0 2px 8px rgba(244, 114, 182, 0.08)",...h?{position:"absolute",top:0,left:0,width:`${o.h}px`,height:`${o.w}px`,transform:"rotate(90deg) translateY(-100%)",transformOrigin:"top left"}:{}},initial:!1,children:[K&&t.jsx("div",{className:"flex items-center justify-center w-full h-full text-slate-400",children:"Cargando..."}),t.jsxs(I.svg,{width:D,height:P,className:"font-sans flex-shrink-0",viewBox:`0 0 ${D} ${P}`,preserveAspectRatio:"xMidYMid meet",initial:!1,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("linearGradient",{id:"tempAreaGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244,114,182,0.25)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(236,72,153,0.15)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(233,30,99,0.05)"})]}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:[t.jsx("rect",{width:"6",height:"6",fill:"#f3f4f6"}),t.jsx("circle",{cx:"3",cy:"3",r:"1.5",fill:"rgba(239,68,68,0.7)"})]}),t.jsxs("filter",{id:"chartShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("filter",{id:"baselineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1.5",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx("rect",{width:"100%",height:"100%",fill:"transparent"}),t.jsx(yt,{padding:R,chartWidth:D,chartHeight:P,tempMin:C,tempMax:G,tempRange:$,getY:_,getX:W,allDataPoints:m,responsiveFontSize:V,isFullScreen:i,showLeftLabels:i&&p==="landscape",reduceMotion:c}),t.jsx(ut,{data:k,allDataPoints:m,getX:W,getY:_,baselineY:P-R.bottom,temperatureField:"displayTemperature",reduceMotion:c}),b&&u!=null&&(c?t.jsx("line",{x1:H,y1:q,x2:D-R.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"}}):t.jsx(I.line,{x1:H,y1:q,x2:D-R.right,y2:q,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"},initial:{opacity:0,pathLength:0},animate:{opacity:1,pathLength:1},transition:{duration:1,ease:"easeInOut"}})),t.jsx(kt,{data:m,getX:W,getY:_,isFullScreen:i,orientation:p,responsiveFontSize:V,onPointInteraction:X,clearActivePoint:s,activePoint:E,padding:R,chartHeight:P,chartWidth:D,temperatureField:"displayTemperature",textRowHeight:U,compact:!1,reduceMotion:c})]}),E&&t.jsx(I.div,{ref:d,initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},transition:{duration:.2,ease:"easeOut"},children:t.jsx(pt,{point:E,position:g,chartWidth:D,chartHeight:P,onToggleIgnore:Y,onEdit:L,onClose:s})})]})]})};function Nt(e,i){if(!e||!i)return[];const p=typeof e=="string"?at(e):e;return[...Array(i)].map((x,L)=>{const f=ft(p,L),r=ot(f,"yyyy-MM-dd"),n=ot(f,"dd/MM"),b=xt(Z(f),Z(p))+1;return{date:n,isoDate:r,cycleDay:b,temperature:null,mucusSensation:null,mucusAppearance:null,id:`placeholder-${r}`,ignored:!1}})}export{Ot as F,Rt as R,Nt as g};
