import{c as ht,m as $,j as t,r as T}from"./index-58bd411e.js";import{g as dt,i as ft,X as xt,E as mt}from"./fertilitySymbols-b3b31d09.js";import{s as Z,p as ot,f as rt,e as pt,E as ut,a as yt,d as gt}from"./useCycleData-13cb54d0.js";import{B as tt}from"./button-aa6d80be.js";import{P as jt}from"./pen-line-b553f554.js";const Pt=ht("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),bt=({padding:e,chartWidth:r,chartHeight:m,tempMin:f,tempMax:C,tempRange:d,getY:i,getX:c,allDataPoints:g=[],responsiveFontSize:a,isFullScreen:E,showLeftLabels:j=!0,reduceMotion:n=!1})=>{const p={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},B=[];if(d>0){const u=d<=2.5?.1:.5;for(let M=f;M<=C+1e-9;M+=u)B.push(parseFloat(M.toFixed(1)))}else for(let u=35;u<=37.5+1e-9;u+=.5)B.push(parseFloat(u.toFixed(1)));const w=n?"g":$.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"bgGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(252, 231, 243, 0.3)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(255, 255, 255, 0.8)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(252, 231, 243, 0.2)"})]}),t.jsxs("filter",{id:"softGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx("rect",{x:e.left,y:e.top,width:r-e.left-e.right,height:m-e.top-e.bottom,fill:"url(#bgGradient)",opacity:.4}),B.map((u,M)=>{const k=i(u),W=u.toFixed(1).endsWith(".0")||u.toFixed(1).endsWith(".5"),Y=W?u.toFixed(1):`.${u.toFixed(1).split(".")[1]}`;return t.jsxs(w,{...n?{}:{variants:p},children:[t.jsx("line",{x1:e.left,y1:k,x2:r-e.right,y2:k,stroke:W?"rgba(244, 114, 182, 0.25)":"rgba(244, 114, 182, 0.15)",strokeWidth:W?1.5:1,strokeDasharray:W?"0":"3,3",style:{filter:W?"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.1))":"none"}}),j&&t.jsx("text",{x:e.left-a(1),y:k+a(.35),textAnchor:"end",fontSize:a(W?1:.9),fontWeight:W?"600":"500",fill:W?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Y}),t.jsx("text",{x:r-e.right+a(1),y:k+a(.35),textAnchor:"start",fontSize:a(W?1:.9),fontWeight:W?"600":"500",fill:W?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:Y})]},`temp-tick-${M}`)}),g.map((u,M)=>{const k=c(M);return t.jsx("line",{x1:k,y1:e.top,x2:k,y2:m-e.bottom,stroke:"rgba(244, 114, 182, 0.12)",strokeWidth:.8,style:{filter:"drop-shadow(0 0 1px rgba(244, 114, 182, 0.1))"}},`day-grid-${M}`)}),j&&t.jsxs(w,{...n?{}:{variants:p},children:[t.jsx("rect",{x:e.left-a(.2),y:e.top-a(.2),width:a(2.8),height:a(2),rx:a(.3),fill:"rgba(244, 114, 182, 0.1)",stroke:"rgba(244, 114, 182, 0.2)",strokeWidth:.5}),t.jsx("text",{x:e.left+a(1.2),y:e.top+a(1.1),textAnchor:"middle",fontSize:a(1.3),fontWeight:"700",fill:"#E91E63",style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),t.jsx("rect",{x:e.left,y:e.top,width:r-e.left-e.right,height:m-e.top-e.bottom,fill:"none",stroke:"rgba(244, 114, 182, 0.2)",strokeWidth:1.5,rx:8,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.1))"}})]})},wt=({data:e,allDataPoints:r,getX:m,getY:f,baselineY:C,temperatureField:d="temperature",reduceMotion:i=!1})=>{if(!e||e.length<2)return null;let c="",g=null;return r.forEach((a,E)=>{const j=e.find(n=>n.id===a.id);if(j&&j[d]!==null&&j[d]!==void 0&&!j.ignored){const n=m(E),p=f(j[d]);g!==null&&E===g+1?c+=` L ${n} ${p}`:c+=`${c?" ":""}M ${n} ${p}`,g=E}}),c.includes("L")?t.jsx(t.Fragment,{children:i?t.jsx("path",{d:c,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}):t.jsx($.path,{d:c,fill:"none",stroke:"url(#tempLineGradientChart)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:.2,ease:"easeInOut"}})}):null},at="#1E40AF",nt="#059669",it="#BE185D",Et="rgba(30, 64, 175, 0.08)",kt="rgba(5, 150, 105, 0.08)",Mt="rgba(190, 24, 93, 0.08)",vt=e=>{if(!e)return"";const[r,m]=e.split("/");return`${parseInt(r,10)}/${parseInt(m,10)}`},et=(e="",r,m,f="–")=>{if(!e)return[f,""];if(e.length<=r)return[e,""];if(m)return[e.slice(0,r),""];const C=e.indexOf(" ",r);return C===-1?[e.slice(0,r),e.slice(r)]:[e.slice(0,C),e.slice(C+1)]},st=(e="",r,m="–")=>e?e.split(/\s+/).slice(0,r).join(" "):m,Ct=({data:e,getX:r,getY:m,isFullScreen:f,orientation:C,responsiveFontSize:d,onPointInteraction:i,clearActivePoint:c,activePoint:g,padding:a,chartHeight:E,chartWidth:j,temperatureField:n="temperature_chart",textRowHeight:p,compact:B=!1,reduceMotion:w=!1})=>{const u={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},M={hidden:{opacity:0,scale:.5},visible:{opacity:1,scale:1,transition:{duration:.5,ease:"easeOut",type:"spring",stiffness:100}}},k=E-a.bottom,W=k+p*1,Y=k+p*2,O=k+p*3,V=k+p*(f?5:4.5),I=k+p*(f?7:6),D=k+p*(f?9:7.5),F=j-a.left-a.right,U=p*(f?2:1.5),X=w?"g":$.g;return t.jsxs(t.Fragment,{children:[t.jsxs("defs",{children:[t.jsx("filter",{id:"rowShadow",x:"-10%",y:"-10%",width:"120%",height:"120%",children:t.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodColor:"rgba(244, 114, 182, 0.15)"})}),t.jsxs("linearGradient",{id:"sensationGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:Et}),t.jsx("stop",{offset:"100%",stopColor:"rgba(30, 64, 175, 0.02)"})]}),t.jsxs("linearGradient",{id:"appearanceGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:kt}),t.jsx("stop",{offset:"100%",stopColor:"rgba(5, 150, 105, 0.02)"})]}),t.jsxs("linearGradient",{id:"observationGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:Mt}),t.jsx("stop",{offset:"100%",stopColor:"rgba(190, 24, 93, 0.02)"})]})]}),!B&&t.jsxs("g",{children:[t.jsx("rect",{x:a.left,y:V-U/2,width:F,height:U,fill:"url(#sensationGradient)",rx:6,style:{filter:"url(#rowShadow)"}}),t.jsx("rect",{x:a.left,y:I-U/2,width:F,height:U,fill:"url(#appearanceGradient)",rx:6,style:{filter:"url(#rowShadow)"}}),t.jsx("rect",{x:a.left,y:D-U/2,width:F,height:U,fill:"url(#observationGradient)",rx:6,style:{filter:"url(#rowShadow)"}})]}),(!f||C!=="portrait")&&t.jsx($.g,{variants:u,children:[{label:"Fecha",row:1,color:f?"#374151":"#6B7280"},{label:"Día",row:2,color:f?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:f?"#374151":"#6B7280"},{label:"Sens.",row:f?5:4.5,color:at},{label:"Apar.",row:f?7:6,color:nt},{label:"Observ.",row:f?9:7.5,color:it}].map(({label:o,row:S,color:b})=>t.jsx("text",{x:a.left-d(1.5),y:k+p*S,textAnchor:"end",fontSize:d(.95),fontWeight:"600",fill:b,style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o},o))}),e.map((o,S)=>{const b=r(S),A=o[n]!=null?m(o[n]):k,N=f?"#374151":"#6B7280",P=o[n]!=null,H=P||o.mucus_sensation||o.mucus_appearance||o.fertility_symbol,q=String(o.id||"").startsWith("placeholder-"),K=!H||q?{}:{pointerEvents:"all",style:{cursor:"pointer"},onMouseEnter:G=>i(o,S,G),onClick:G=>i(o,S,G)},s=dt(o.fertility_symbol);let l="transparent";if(s!=null&&s.color){const G=s.color.replace(/^bg-/,"");G==="red-500"?l="#ef4444":G==="white"?l="#ffffff":G==="green-500"?l="#22c55e":G==="pink-300"&&(l="#f9a8d4")}const h=d(f?1.4:1.6),x=o.isoDate?ft(Z(ot(o.isoDate)),Z(new Date)):!1,y=f?4:9,v=2,[R,L]=et(f?st(o.mucus_sensation,v,x?"":"–"):o.mucus_sensation,y,!1,x?"":"–"),[_,J]=et(f?st(o.mucus_appearance,v,x?"":"–"):o.mucus_appearance,y,!1,x?"":"–"),[Q,z]=et(f?st(o.observations,v,""):o.observations,y,!1,"");return t.jsxs(X,{...w?{}:{variants:u},...K,children:[P&&t.jsxs(X,{...w?{}:{variants:M},children:[t.jsx("circle",{cx:b,cy:A,r:8,fill:"rgba(244, 114, 182, 0.15)",opacity:.6}),t.jsx("circle",{cx:b,cy:A,r:5,fill:o.ignored?"white":"url(#tempPointGradient)",stroke:o.use_corrected?"#F59E0B":"#E91E63",strokeWidth:o.ignored?2:2.5,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.3))",cursor:"pointer"},pointerEvents:"all",onMouseEnter:G=>i(o,S,G),onTouchStart:G=>i(o,S,G),onClick:G=>i(o,S,G)}),!o.ignored&&t.jsx("circle",{cx:b,cy:A,r:2,fill:"rgba(255, 255, 255, 0.8)"})]}),t.jsx("defs",{children:t.jsxs("radialGradient",{id:"tempPointGradient",cx:"30%",cy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"70%",stopColor:"#E91E63"}),t.jsx("stop",{offset:"100%",stopColor:"#C2185B"})]})}),t.jsx("text",{x:b,y:W,textAnchor:"middle",fontSize:d(.95),fontWeight:"600",fill:N,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:vt(o.date)}),t.jsx("text",{x:b,y:Y,textAnchor:"middle",fontSize:d(.9),fontWeight:"500",fill:N,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.cycleDay}),!q&&(s.value!=="none"?t.jsx("rect",{x:b-h/2,y:O-h*.75,width:h,height:h,fill:s.pattern==="spotting-pattern"?"url(#spotting-pattern-chart)":l,stroke:s.value==="white"?"#E91E63":"rgba(233, 30, 99, 0.3)",strokeWidth:s.value==="white"?1.5:1,rx:h*.25,style:{filter:"drop-shadow(0 1px 2px rgba(244, 114, 182, 0.2))"}}):t.jsx("text",{x:b,y:O,textAnchor:"middle",fontSize:d(.9),fill:N,fontWeight:"400",children:"–"})),!B&&t.jsxs("text",{x:b,y:V,textAnchor:"middle",fontSize:d(.85),fontWeight:"600",fill:at,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[t.jsx("tspan",{x:b,dy:0,children:R}),L&&t.jsx("tspan",{x:b,dy:d(1),children:L})]}),!B&&t.jsxs("text",{x:b,y:I,textAnchor:"middle",fontSize:d(.85),fontWeight:"600",fill:nt,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[t.jsx("tspan",{x:b,dy:0,children:_}),J&&t.jsx("tspan",{x:b,dy:d(1),children:J})]}),!B&&t.jsxs("text",{x:b,y:D,textAnchor:"middle",fontSize:d(.85),fontWeight:"600",fill:it,style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[t.jsx("tspan",{x:b,dy:0,children:Q}),z&&t.jsx("tspan",{x:b,dy:d(1),children:z})]})]},`pt-${S}-${o.isoDate||o.timestamp}`)})]})},Bt=({point:e,position:r,chartWidth:m,chartHeight:f,onToggleIgnore:C,onEdit:d,onClose:i})=>{if(!e)return null;const c=130,g=120;let a=r.clientX+10,E=r.clientY+10;a+c>m&&(a=r.clientX-c-10),E+g>f&&(E=r.clientY-g-10),a<0&&(a=5),E<0&&(E=5);const j=e.temperature_chart,n=dt(e.fertility_symbol),p=e.timestamp||e.isoDate;return t.jsxs($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},className:"absolute bg-white/80 border border-[#E27DBF] text-[#1F2937] p-2 rounded-lg shadow z-50",style:{top:E,left:a,width:c,minHeight:g},children:[t.jsx(tt,{variant:"ghost",size:"icon",onClick:i,className:"absolute top-1 right-1 text-[#E27DBF] hover:bg-[#FFB1DD]",children:t.jsx(xt,{size:16})}),t.jsxs("p",{className:"font-semibold text-sm text-[#E27DBF] mb-1",children:[p?rt(ot(p),"d/M",{locale:pt}):"Fecha",` (Día ${e.cycleDay||"N/A"})`]}),j!=null&&t.jsxs("p",{className:"text-xs mb-1",children:[t.jsx("span",{className:"font-medium",children:"T:"})," ",parseFloat(j).toFixed(2),"°C",e.use_corrected&&t.jsx("span",{className:"inline-block ml-1 align-middle text-[#FF0000]",children:"·"})]}),t.jsxs("div",{className:"flex items-center mb-1",children:[n&&n.value!=="none"&&t.jsx("span",{className:`w-3 h-3 rounded-full mr-1 ${n.color} ${n.pattern?"pattern-bg":""} ${n.value==="white"?"border border-gray-300":""}`}),t.jsx("p",{className:"text-xs",children:n?n.label:"-"})]}),t.jsxs("p",{className:"text-xs mb-1",children:[t.jsx("span",{className:"font-medium",children:"Sens.:"})," ",e.mucus_sensation||"-"]}),t.jsxs("p",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Apar.:"})," ",e.mucus_appearance||"-"]}),e.id&&!String(e.id).startsWith("placeholder-")&&t.jsxs("div",{className:"flex justify-center space-x-1 mt-1",children:[t.jsx(tt,{onClick:()=>{d&&d(e),i&&i()},variant:"outline",size:"icon",className:"text-[#393C65] hover:text-[#E27DBF] hover:bg-[#E27DBF]/10 ",children:t.jsx(jt,{className:"h-4 w-4"})}),t.jsx(tt,{onClick:()=>C(e.id),variant:e.ignored?"outline":"destructive",size:"icon",className:"hover:bg-[#FFB1DD]/20",children:e.ignored?t.jsx(ut,{className:"h-4 w-4"}):t.jsx(mt,{className:"h-4 w-4"})})]})]})},Wt="#1E40AF",At="#059669",Dt="#BE185D",Nt=({padding:e,chartHeight:r,tempMin:m,tempMax:f,tempRange:C,getY:d,responsiveFontSize:i,textRowHeight:c,isFullScreen:g})=>{const a={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},E=[];if(C>0){const n=C<=2.5?.1:.5;for(let p=m;p<=f+1e-9;p+=n)E.push(parseFloat(p.toFixed(1)))}else for(let n=35;n<=37.5+1e-9;n+=.5)E.push(parseFloat(n.toFixed(1)));const j=r-e.bottom;return t.jsxs("svg",{width:e.left,height:r,className:"font-sans pointer-events-none",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"legendBgGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(255, 255, 255, 0.95)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(252, 231, 243, 0.8)"})]}),t.jsx("filter",{id:"legendShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:t.jsx("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodColor:"rgba(244, 114, 182, 0.15)"})})]}),t.jsx("rect",{x:0,y:j+c*.5,width:e.left,height:c*(g?9.5:8),fill:"url(#legendBgGradient)",rx:8,style:{filter:"url(#legendShadow)"}}),E.map((n,p)=>{const B=d(n),w=n.toFixed(1).endsWith(".0")||n.toFixed(1).endsWith(".5"),u=w?n.toFixed(1):`.${n.toFixed(1).split(".")[1]}`;return t.jsx($.text,{variants:a,x:e.left-i(1),y:B+i(.35),textAnchor:"end",fontSize:i(w?1:.9),fontWeight:w?"600":"500",fill:w?"#E91E63":"#EC4899",style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:u},`temp-tick-fixed-${p}`)}),t.jsxs($.g,{variants:a,children:[t.jsx("rect",{x:e.left-i(.3),y:e.top-i(.3),width:i(3),height:i(2.2),rx:i(.4),fill:"rgba(244, 114, 182, 0.12)",stroke:"rgba(244, 114, 182, 0.25)",strokeWidth:1,style:{filter:"drop-shadow(0 2px 4px rgba(244, 114, 182, 0.1))"}}),t.jsx("text",{x:e.left+i(1.2),y:e.top+i(1.2),textAnchor:"middle",fontSize:i(1.4),fontWeight:"700",fill:"#E91E63",style:{filter:"drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"°C"})]}),t.jsx($.g,{variants:a,children:[{label:"Fecha",row:1,color:g?"#374151":"#6B7280"},{label:"Día",row:2,color:g?"#374151":"#6B7280"},{label:"Símbolo",row:3,color:g?"#374151":"#6B7280"},{label:"Sens.",row:g?5:4.5,color:Wt},{label:"Apar.",row:g?7:6,color:At},{label:"Observ.",row:g?9:7.5,color:Dt}].map(({label:n,row:p,color:B})=>t.jsx("text",{x:e.left-i(1.5),y:j+c*p,textAnchor:"end",fontSize:i(.95),fontWeight:"600",fill:B,style:{filter:"drop-shadow(0 1px 1px rgba(255, 255, 255, 0.8))",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:n},n))})]})},lt=35.5,ct=37.5,Lt=(e,r,m,f,C,d=5,i=!1)=>{const c=T.useRef(null),g=T.useRef(null),[a,E]=T.useState({width:0,height:0}),[j,n]=T.useState(null),[p,B]=T.useState({x:0,y:0}),w=T.useMemo(()=>e.map(s=>({...s,displayTemperature:s.temperature_chart})),[e]);T.useLayoutEffect(()=>{const s=()=>{if(!c.current)return;const h=c.current.parentElement||c.current;let x=h.clientWidth||600,y=h.clientHeight||400,v=c.current.clientWidth>0?c.current.clientWidth:x,R,L;if(r){let _=window.innerWidth,J=window.innerHeight;if(i&&J>_&&([_,J]=[J,_]),v=_,m==="portrait"&&!i){const Q=Math.max(30,_*.05);R=(_-Q)/d*e.length}else R=_/d*e.length;L=J}else R=v/d*e.length,L=y;E({width:R,height:L})};s(),window.addEventListener("resize",s);let l;if(c.current){const h=c.current.parentElement||c.current;l=new ResizeObserver(s),l.observe(h)}return()=>{window.removeEventListener("resize",s),l&&l.disconnect()}},[r,e.length,d,m,i]);const u=T.useMemo(()=>w.filter(s=>s&&s.isoDate&&!s.ignored&&s.displayTemperature!==null&&s.displayTemperature!==void 0),[w]),M=T.useMemo(()=>w.filter(s=>s&&s.isoDate),[w]),{baselineTemp:k,baselineStartIndex:W}=T.useMemo(()=>{const s=l=>l&&l.displayTemperature!=null&&!l.ignored;for(let l=0;l<w.length;l++){const h=w[l];if(!s(h))continue;const x=[];for(let y=l-1;y>=0&&x.length<6;y--){const v=w[y];s(v)&&x.unshift({index:y,temp:v.displayTemperature})}if(!(x.length<6)&&x.every(y=>y.temp<h.displayTemperature)){const y=Math.max(...x.map(R=>R.temp)),v=x.find(R=>R.temp===y).index;return{baselineTemp:y,baselineStartIndex:v}}}return{baselineTemp:null,baselineStartIndex:null}},[w]),{tempMin:Y,tempMax:O}=T.useMemo(()=>{const s=u.map(x=>x.displayTemperature).filter(x=>x!=null);if(s.length===0)return{tempMin:lt,tempMax:ct};let l=Math.min(...s,lt),h=Math.max(...s,ct);if(l=Math.floor(l*2)/2,h=Math.ceil(h*2)/2,h-l<2){const x=(l+h)/2;l=x-1,h=x+1}return{tempMin:l,tempMax:h}},[u]),V=O-Y,I=a.width,D=a.height,F=9,U=(s=1)=>{if(!r)return F*s;const l=Math.min(I,D);return Math.max(8,Math.min(F*s,l/(M.length>0?40/s:40)))},X=U(1.6),o=i||m==="landscape",b=X*(o?9:5),A={top:r?Math.max(o?6:12,D*(o?.015:.03)):12,right:r?Math.max(o?12:30,I*(o?.02:.05)):50,bottom:(r?Math.max(o?24:40,D*(o?.05:.11)):60)+b,left:r?Math.max(o?12:30,I*(o?.02:.05)):50},N=s=>{if(s==null||V===0)return D-A.bottom;const l=D-A.top-A.bottom;return l<=0?D-A.bottom:D-A.bottom-(s-Y)/V*l},P=s=>{const h=r&&!(i||m==="landscape")?25:0,x=I-A.left-A.right-0-h*(M.length-1);if(x<=0)return A.left+0+h*s;const y=M.length>1?M.length-1:1;return y===0||M.length===0?A.left+0+h*s:A.left+0+s*(x/(M.length===1?1:y))+h*s},H=(s,l,h)=>{if(!s||String(s.id).startsWith("placeholder-")){q();return}const x=c.current.getBoundingClientRect();let y,v;if(h.type.startsWith("touch")){const _=h.changedTouches[0];y=_.clientX,v=_.clientY}else y=h.clientX,v=h.clientY;const R=P(l),L=N(s.displayTemperature);B({svgX:R,svgY:L,clientX:y-x.left+c.current.scrollLeft,clientY:v-x.top+c.current.scrollTop}),n(s)};T.useEffect(()=>{const s=l=>{var h;if(g.current&&!g.current.contains(l.target)){const x=(h=c.current)==null?void 0:h.querySelectorAll("circle, text, rect");let y=!1;if(x){for(let v of x)if(v.contains(l.target)){y=!0;break}}y||n(null)}};return j&&(document.addEventListener("mousedown",s),document.addEventListener("touchstart",s)),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[j]);const q=()=>{n(null)};return{chartRef:c,tooltipRef:g,dimensions:a,activePoint:j,tooltipPosition:p,processedData:w,validDataForLine:u,allDataPoints:M,tempMin:Y,tempMax:O,tempRange:V,padding:A,textRowHeight:X,setActivePoint:n,getY:N,getX:P,handlePointInteraction:H,clearActivePoint:q,handleToggleIgnore:s=>{f&&s&&(f(C,s),n(null))},responsiveFontSize:U,baselineTemp:k,baselineStartIndex:W}},_t=({data:e,isFullScreen:r,orientation:m,onToggleIgnore:f,onEdit:C,cycleId:d,initialScrollIndex:i=0,visibleDays:c=5,showInterpretation:g=!1,reduceMotion:a=!1,forceLandscape:E=!1})=>{const{chartRef:j,tooltipRef:n,dimensions:p,activePoint:B,tooltipPosition:w,allDataPoints:u,validDataForLine:M,tempMin:k,tempMax:W,tempRange:Y,padding:O,textRowHeight:V,getY:I,getX:D,handlePointInteraction:F,handleToggleIgnore:U,responsiveFontSize:X,clearActivePoint:o,setActivePoint:S,baselineTemp:b,baselineStartIndex:A}=Lt(e,r,m,f,d,c,E);if(!u||u.length===0)return t.jsxs("div",{className:"text-center p-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-pink-100 to-rose-100 rounded-full mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("p",{className:"text-slate-400 font-medium",children:"No hay datos para mostrar en el gráfico"})]});const N=p.width,P=p.height,H=b!=null?I(b):null,q=b!=null?D(A):null,K=N===0,[s,l]=T.useState({w:typeof window<"u"?window.innerWidth:0,h:typeof window<"u"?window.innerHeight:0}),h=s.w<s.h;T.useEffect(()=>{const L=()=>l({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",L),window.addEventListener("orientationchange",L),()=>{window.removeEventListener("resize",L),window.removeEventListener("orientationchange",L)}},[]),T.useEffect(()=>{if(!j.current)return;const L=j.current.clientWidth/c;j.current.scrollLeft=Math.max(0,L*i)},[i,c,p.width,m]);const x=E&&h,y=x,v="w-full h-full bg-gradient-to-br from-white via-pink-50/30 to-rose-50/20",R=r?`${v} min-h-full ${y?"flex items-stretch justify-start overflow-y-auto overflow-x-hidden":"flex items-center justify-start overflow-x-auto overflow-y-hidden"}`:`${v} overflow-x-auto overflow-y-hidden border border-pink-100/50`;return t.jsxs($.div,{className:"relative w-full h-full",initial:!1,children:[(!r||m==="portrait")&&t.jsx("div",{className:"absolute left-0 top-0 h-full bg-transparent pointer-events-none z-10",style:{width:O.left},children:t.jsx(Nt,{padding:O,chartHeight:P,tempMin:k,tempMax:W,tempRange:Y,getY:I,responsiveFontSize:X,textRowHeight:V,isFullScreen:r})}),t.jsxs($.div,{ref:j,className:`relative p-0 ${r?"":"rounded-2xl"} ${R}`,style:{boxShadow:r?"inset 0 1px 3px rgba(244, 114, 182, 0.1)":"0 8px 32px rgba(244, 114, 182, 0.12), 0 2px 8px rgba(244, 114, 182, 0.08)",...x?{position:"absolute",top:0,left:0,width:`${s.h}px`,height:`${s.w}px`,transform:"rotate(90deg) translateY(-100%)",transformOrigin:"top left"}:{}},initial:!1,children:[K&&t.jsx("div",{className:"flex items-center justify-center w-full h-full text-slate-400",children:"Cargando..."}),t.jsxs($.svg,{width:N,height:P,className:"font-sans flex-shrink-0",viewBox:`0 0 ${N} ${P}`,preserveAspectRatio:"xMidYMid meet",initial:!1,children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"tempLineGradientChart",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#F472B6"}),t.jsx("stop",{offset:"50%",stopColor:"#EC4899"}),t.jsx("stop",{offset:"100%",stopColor:"#E91E63"})]}),t.jsxs("linearGradient",{id:"tempAreaGradientChart",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"rgba(244,114,182,0.25)"}),t.jsx("stop",{offset:"50%",stopColor:"rgba(236,72,153,0.15)"}),t.jsx("stop",{offset:"100%",stopColor:"rgba(233,30,99,0.05)"})]}),t.jsxs("pattern",{id:"spotting-pattern-chart",patternUnits:"userSpaceOnUse",width:"8",height:"8",children:[t.jsx("circle",{cx:"2",cy:"2",r:"1.5",fill:"rgba(239,68,68,0.8)"}),t.jsx("circle",{cx:"6",cy:"6",r:"1.5",fill:"rgba(239,68,68,0.6)"})]}),t.jsxs("filter",{id:"chartShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsxs("filter",{id:"baselineGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"1.5",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx("rect",{width:"100%",height:"100%",fill:"transparent"}),t.jsx(bt,{padding:O,chartWidth:N,chartHeight:P,tempMin:k,tempMax:W,tempRange:Y,getY:I,getX:D,allDataPoints:u,responsiveFontSize:X,isFullScreen:r,showLeftLabels:r&&m==="landscape",reduceMotion:a}),t.jsx(wt,{data:M,allDataPoints:u,getX:D,getY:I,baselineY:P-O.bottom,temperatureField:"displayTemperature",reduceMotion:a}),g&&b!=null&&(a?t.jsx("line",{x1:q,y1:H,x2:N-O.right,y2:H,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"}}):t.jsx($.line,{x1:q,y1:H,x2:N-O.right,y2:H,stroke:"#F59E0B",strokeWidth:3,strokeDasharray:"6 4",style:{filter:"url(#baselineGlow)"},initial:{opacity:0,pathLength:0},animate:{opacity:1,pathLength:1},transition:{duration:1,ease:"easeInOut"}})),t.jsx(Ct,{data:u,getX:D,getY:I,isFullScreen:r,orientation:m,responsiveFontSize:X,onPointInteraction:F,clearActivePoint:o,activePoint:B,padding:O,chartHeight:P,chartWidth:N,temperatureField:"displayTemperature",textRowHeight:V,compact:!1,reduceMotion:a})]}),B&&t.jsx($.div,{ref:n,initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},transition:{duration:.2,ease:"easeOut"},children:t.jsx(Bt,{point:B,position:w,chartWidth:N,chartHeight:P,onToggleIgnore:U,onEdit:C,onClose:o})})]})]})};function $t(e,r){if(!e||!r)return[];const m=typeof e=="string"?ot(e):e;return[...Array(r)].map((f,C)=>{const d=yt(m,C),i=rt(d,"yyyy-MM-dd"),c=rt(d,"dd/MM"),g=gt(Z(d),Z(m))+1;return{date:c,isoDate:i,cycleDay:g,temperature:null,mucusSensation:null,mucusAppearance:null,id:`placeholder-${i}`,ignored:!1}})}export{_t as F,Pt as R,$t as g};
